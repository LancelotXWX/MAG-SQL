{"idx": 0, "db_id": "california_schools", "query": "What is the highest eligible free rate for K-12 students in the schools in Alameda County?", "evidence": "Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`", "difficulty": "simple", "ground_truth": "SELECT `Free Meal Count (K-12)` / `Enrollment (K-12)` FROM frpm WHERE `County Name` = 'Alameda' ORDER BY (CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)`) DESC LIMIT 1", "send_to": "Soft_Schema_Linker", "response": "\n\n", "input_prompt": "As an experienced and professional database administrator, your task is to analyze a user question and a database schema to provide relevant information. The database schema consists of table descriptions, each containing multiple column descriptions. Your goal is to extract the entities from question and identify the relevant tables and columns based on these entities and the evidence provided.\n\n[Instruction]:\n1. Extract the mentioned entities from the user question. Make sure all of the entities are extracted. \n2. For each entity, keep at least 3 related columns.\n4. Your output should include entity extraction, analysis and related database schema.\n5. The related database schema should be in JSON format.\n6. Each column's information in provided 【Schema】 is in this format: (column, description. Value examples<optional>)\n\n[Requirements]:\n1. Sort the related columns in each list corresponding to each entity in descending order of relevance.\n2. The chosen columns should be in this format: <table.column>.\n3. Make sure each chosen list is not empty. The value [] will be punished. \n4.【Matched values】 may contain redundant or useless information in addition to the correct matching values, so you need to select the useful information in conjunction with the specific column names and descriptions.\n5. An entity may not have a corresponding evidence, which requires you to find the relevant columns yourself through your understanding of the database schema.\n\nHere is a typical example:\n\n==========\n【DB_ID】 banking_system\n【Schema】\n# Table: account\n[\n  (account_id <INTEGER>, the id of the account. Value examples: [11382, 11362, 2, 1, 2367].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (frequency <TEXT>, frequency of the acount. Value examples: ['POPLATEK MESICNE', 'POPLATEK TYDNE', 'POPLATEK PO OBRATU'].),\n  (date <DATE>, the creation date of the account. Value examples: ['1997-12-29', '1997-12-28'].)\n]\n# Table: client\n[\n  (client_id <INTEGER>, the unique number. Value examples: [13998, 13971, 2, 1, 2839].),\n  (gender <TEXT>, gender. Value examples: ['M', 'F']. And F：female . M：male ),\n  (birth_date <DATE>, birth date. Value examples: ['1987-09-27', '1986-08-13'].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (first_name <TEXT>, first_name.),\n  (last_name <TEXT>, last_name.)\n]\n# Table: loan\n[\n  (loan_id <INTEGER>, the id number identifying the loan data. Value examples: [4959, 4960, 4961].),\n  (account_id <INTEGER>, the id number identifying the account. Value examples: [10, 80, 55, 43].),\n  (date <DATE>, the date when the loan is approved. Value examples: ['1998-07-12', '1998-04-19'].),\n  (amount <INTEGER>, the id number identifying the loan data. Value examples: [1567, 7877, 9988].),\n  (duration <INTEGER>, the id number identifying the loan data. Value examples: [60, 48, 24, 12, 36].),\n  (payments <INTEGER>, the id number identifying the loan data. Value examples: [3456, 8972, 9845].),\n  (status <TEXT>, the id number identifying the loan data. Value examples: ['C', 'A', 'D', 'B'].)\n]\n# Table: district\n[\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76].),\n  (A2 <REAL>, area in square kilometers. Value examples: [50.5, 48.9].),\n  (A4 <INTEGER>, number of inhabitants. Value examples: [95907, 95616].),\n  (A5 <INTEGER>, number of households. Value examples: [35678, 34892].),\n  (A6 <REAL>, literacy rate. Value examples: [95.6, 92.3, 89.7].),\n  (A7 <INTEGER>, number of entrepreneurs. Value examples: [1234, 1456].),\n  (A8 <INTEGERt>, number of cities. Value examples: [5, 4].),\n  (A9 <INTEGER>, number of schools. Value examples: [15, 12, 10].),\n  (A10 <INTEGER>, number of hospitals. Value examples: [8, 6, 4].),\n  (A11 <REAL>, average salary. Value examples: [12541.5, 11277].),\n  (A12 <REAL>, poverty rate. Value examples: [12.4, 9.8].),\n  (A13 <REAL>, unemployment rate. Value examples: [8.2, 7.9].),\n  (A15 <INTEGER>, number of crimes. Value examples: [256, 189].)\n]\n【Primary keys】\naccount.`account_id` | client.`client_id` | loan.`loan_id` | district.`district_id`\n【Foreign keys】\nclient.`district_id` = district.`district_id`\n【Question】\nWhat is the gender of the youngest client who opened account in the lowest average salary branch and when did this client open the account? Please list their full name.\n【Evidence】\nLater birthdate refers to younger age; A11 refers to average salary; Full name refers to first_name, last_name\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\nThe entities extracted from the 【Question】 are: \n1. gender; \n2. youngest client; \n3. account; \n4. lowest average salary branch; \n5. when did this client open the account; \n6. full name\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. gender --no related evidence **the columns about gender are related**\n2. youngest client  --Later birthdate refers to younger age; **the columns about birth date of client and the id of client are related**\n3. account --no related evidence **the columns about account or account ids are related**\n4. lowest average salary branch  --A11 refers to average salary **the columns about average salary and branch are related**\n5. when did this client open the account --no related evidence **the columns about time or date of the account are related**\n6. full name  --Full name refers to first_name, last_name **the columns about first_name, last_name of the client are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"gender\": [\"client.gender\",\"client.client_id\",\"loan.status\"],\n  \"youngest client\": [\"client.birth_date\",\"client.client_id\",\"account.date\",\"loan.date\"],\n  \"account\": [\"account.account_id\",\"loan.account_id\",\"account.date\"],\n  \"lowest average salary branch\": [\"district.A11\",\"district.district_id\",\"district.A13\"],\n  \"when did this client open the account\": [\"account.date\",\"loan.date\",\"client.birth_date\"],\n  \"full name\": [\"client.first_name\",\"client.last_name\",\"client.client_id\"]\n}\n```\nQuestion Solved.\n\n==========\n\nHere is a new example, please start answering:\n\n【DB_ID】 california_schools\n【Schema】\n# Table: frpm\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (Academic Year <TEXT>,  Academic Year. Value examples: ['2014-2015'].),\n  (County Code <TEXT>,  County Code. Value examples: ['19', '37', '30', '36', '33', '43'].),\n  (District Code <INTEGER>,  District Code.),\n  (School Code <TEXT>,  School Code. Value examples: ['0000000', '9010745', '6121081', '6121073', '6121016', '6120968'].),\n  (County Name <TEXT>,  County Name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].),\n  (District Name <TEXT>,  District Name.),\n  (School Name <TEXT>,  School Name.),\n  (District Type <TEXT>,  District Type. Value examples: ['Unified School District', 'Elementary School District', 'High School District', 'County Office of Education (COE)', 'State Board of Education', 'Statewide Benefit Charter'].),\n  (School Type <TEXT>,  School Type. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].),\n  (Educational Option Type <TEXT>,  Educational Option Type. Value examples: [None, 'Traditional', 'Continuation School', 'Alternative School of Choice', 'Community Day School', 'Special Education School', 'County Community School'].),\n  (NSLP Provision Status <TEXT>,  NSLP Provision Status. Value examples: [None, 'Provision 2', 'Breakfast Provision 2', 'CEP', 'Multiple Provision Types', 'Provision 1', 'Lunch Provision 2'].),\n  (Charter School (Y/N) <INTEGER>,  Charter School (Y/N). Value examples: [None, 0, 1].),\n  (Charter School Number <TEXT>,  Charter School Number. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1700', '1696'].),\n  (Charter Funding Type <TEXT>,  Charter Funding Type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (IRC <INTEGER>,  IRC. Value examples: [None, 0, 1].),\n  (Low Grade <TEXT>,  Low Grade. Value examples: ['K', '9', '6', '7', 'P', '5'].),\n  (High Grade <TEXT>,  High Grade. Value examples: ['12', '5', '8', '6', '3', '4'].),\n  (Enrollment (K-12) <REAL>,  Enrollment (K-12).),\n  (Free Meal Count (K-12) <REAL>,  Free Meal Count (K-12).),\n  (Percent (%) Eligible Free (K-12) <REAL>,  Percent (%) Eligible Free (K-12).),\n  (FRPM Count (K-12) <REAL>,  Free or Reduced Price Meal Count (K-12).),\n  (Percent (%) Eligible FRPM (K-12) <REAL>,  Percent (%) Eligible FRPM (K-12).),\n  (Enrollment (Ages 5-17) <REAL>,  Enrollment (Ages 5-17).),\n  (Free Meal Count (Ages 5-17) <REAL>,  Free Meal Count (Ages 5-17).),\n  (Percent (%) Eligible Free (Ages 5-17) <REAL>,  Percent (%) Eligible Free (Ages 5-17).),\n  (FRPM Count (Ages 5-17) <REAL>,  FRPM Count (Ages 5-17).),\n  (Percent (%) Eligible FRPM (Ages 5-17) <REAL>,  Percent (%) Eligible FRPM (Ages 5-17).),\n  (2013-14 CALPADS Fall 1 Certification Status <INTEGER>,  2013-14 CALPADS Fall 1 Certification Status. Value examples: [1].)\n]\n# Table: satscores\n[\n  (cds <TEXT>,  California Department Schools.),\n  (rtype <TEXT>,  rtype. Value examples: ['S', 'D'].),\n  (sname <TEXT>,  school name. Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].),\n  (dname <TEXT>,  district segment. Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].),\n  (cname <TEXT>,  county name. Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].),\n  (enroll12 <INTEGER>,  enrollment (1st-12nd grade).),\n  (NumTstTakr <INTEGER>,  Number of Test Takers in this school.),\n  (AvgScrRead <INTEGER>,  average scores in Reading.),\n  (AvgScrMath <INTEGER>,  average scores in Math.),\n  (AvgScrWrite <INTEGER>,  average scores in writing.),\n  (NumGE1500 <INTEGER>,  Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500.)\n]\n# Table: schools\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (NCESDist <TEXT>,  This field represents the 7-digit National Center for Educational Statistics (NCES) school district identification number. The first 2 digits identify the state and the last 5 digits identify the school district. Combined, they make a unique 7-digit ID for each school district.. Value examples: [None, '0622710', '0634320', '0628050', '0634410', '0614550', '0633840'].),\n  (NCESSchool <TEXT>,  This field represents the 5-digit NCES school identification number. The NCESSchool combined with the NCESDist form a unique 12-digit ID for each school.. Value examples: [None, '12271', '13785', '13747', '12909', '12311', '12003'].),\n  (StatusType <TEXT>,  This field identifies the status of the district.. Value examples: ['Active', 'Closed', 'Merged', 'Pending'].),\n  (County <TEXT>,  County name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].),\n  (District <TEXT>,  District.),\n  (School <TEXT>,  School.),\n  (Street <TEXT>,  Street.),\n  (StreetAbr <TEXT>,  The abbreviated street address of the school, district, or administrative authority’s physical location..),\n  (City <TEXT>,  City. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].),\n  (Zip <TEXT>,  Zip. Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].),\n  (State <TEXT>,  State. Value examples: [None, 'CA'].),\n  (MailStreet <TEXT>,  MailStreet.),\n  (MailStrAbr <TEXT>,  mailing street address.),\n  (MailCity <TEXT>,  mailing city. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].),\n  (MailZip <TEXT>,  mailing zip. Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].),\n  (MailState <TEXT>,  mailing state. Value examples: [None, 'CA'].),\n  (Phone <TEXT>,  Phone. Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].),\n  (Ext <TEXT>,  The phone number extension of the school, district, or administrative authority.. Value examples: [None, '200', '201', '111', '352', '221', '203'].),\n  (Website <TEXT>,  The website address of the school, district, or administrative authority..),\n  (OpenDate <DATE>,  The date the school opened.. Value examples: [None, '1980-07-01'].),\n  (ClosedDate <DATE>,  The date the school closed.. Value examples: [None, '1989-06-30'].),\n  (Charter <INTEGER>,  This field identifies a charter school.. Value examples: [None, 0, 1].),\n  (CharterNum <TEXT>,  The charter school number,. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1826', '1710'].),\n  (FundingType <TEXT>,  Indicates the charter school funding type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (DOC <TEXT>,  District Ownership Code. Value examples: ['54', '52', '00', '56', '98', '02'].),\n  (DOCType <TEXT>,  The District Ownership Code Type is the text description of the DOC category.. Value examples: ['Unified School District', 'Elementary School District', 'County Office of Education (COE)', 'High School District', 'Regional Occupation Center/Program (ROC/P)', 'State Board of Education'].),\n  (SOC <TEXT>,  The School Ownership Code is a numeric code used to identify the type of school.. Value examples: [None, '60', '66', '62', '68', '09', '69'].),\n  (SOCType <TEXT>,  The School Ownership Code Type is the text description of the type of school.. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Special Education Schools (Public)', 'District Community Day Schools'].),\n  (EdOpsCode <TEXT>,  The Education Option Code is a short text description of the type of education offered.. Value examples: [None, 'TRAD', 'CON', 'COMMDAY', 'ALTSOC', 'SPEC', 'COMM'].),\n  (EdOpsName <TEXT>,  Educational Option Name. Value examples: [None, 'Traditional', 'Continuation School', 'Community Day School', 'Alternative School of Choice', 'Special Education School', 'County Community School'].),\n  (EILCode <TEXT>,  The Educational Instruction Level Code is a short text description of the institution's type relative to the grade range served.. Value examples: [None, 'ELEM', 'HS', 'UG', 'INTMIDJR', 'ELEMHIGH', 'A'].),\n  (EILName <TEXT>,  The Educational Instruction Level Name is the long text description of the institution’s type relative to the grade range served.. Value examples: [None, 'Elementary', 'High School', 'Ungraded', 'Intermediate/Middle/Junior High', 'Elementary-High Combination', 'Adult'].),\n  (GSoffered <TEXT>,  The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.. Value examples: [None, 'K-5', '9-12', 'K-6', 'K-8', '6-8', 'K-12'].),\n  (GSserved <TEXT>,  It is the lowest grade and the highest grade of student enrollment as reported in the most recent certified CALPADS Fall 1 data collection. Only K–12 enrollment is reported through CALPADS. This field may differ from the grade span offered.. Value examples: [None, 'K-5', 'K-6', '9-12', 'K-8', '6-8', '7-8'].),\n  (Virtual <TEXT>,  This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.. Value examples: [None, 'N', 'P', 'F'].),\n  (Magnet <INTEGER>,  This field identifies whether a school is a magnet school and/or provides a magnet program.. Value examples: [None, 0, 1].),\n  (Latitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the equator measured north to south..),\n  (Longitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the prime meridian (Greenwich, England) measured from west to east..),\n  (AdmFName1 <TEXT>,  administrator's first name 1. Value examples: [None, 'David', 'Michael', 'John', 'Jennifer', 'Lisa', 'Robert'].),\n  (AdmLName1 <TEXT>,  administrator's last name 1.),\n  (AdmEmail1 <TEXT>,  administrator's email address 1.),\n  (AdmFName2 <TEXT>,  administrator's first name 2. Value examples: [None, 'Steve', 'Delphine', 'Tim', 'Michael', 'Lisa', 'Jeff'].),\n  (AdmLName2 <TEXT>,  administrator's last name 2. Value examples: [None, 'Sherman', 'Jones', 'Wilson', 'Petersen', 'Landry', 'Hambright'].),\n  (AdmEmail2 <TEXT>,  administrator's email address 2.),\n  (AdmFName3 <TEXT>,  administrator's first name 3. Value examples: [None, 'Mark', 'Eric', 'Vickie', 'Tracie', 'Shawn', 'Sarah'].),\n  (AdmLName3 <TEXT>,  administrator's last name 3. Value examples: [None, 'Zerpoli', 'Yount', 'Woodruff', 'Wood', 'Wolk', 'Spotts'].),\n  (AdmEmail3 <TEXT>,  administrator's email address 3.),\n  (LastUpdate <DATE>,  Last Update. Value examples: ['2015-06-18'].)\n]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Question】\nWhat is the highest eligible free rate for K-12 students in the schools in Alameda County?\n【Evidence】\nEligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\n", "prompt_token": 5142, "response_token": 0, "cur_total_prompt_tokens": 5142, "cur_total_response_tokens": 0}
{"idx": 0, "db_id": "california_schools", "query": "What is the highest eligible free rate for K-12 students in the schools in Alameda County?", "evidence": "Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`", "difficulty": "simple", "ground_truth": "SELECT `Free Meal Count (K-12)` / `Enrollment (K-12)` FROM frpm WHERE `County Name` = 'Alameda' ORDER BY (CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)`) DESC LIMIT 1", "send_to": "Decomposer", "response": "\nTargets: List the highest eligible free rate for K-12 students in the schools\nConditions: \n1. in the schools in Alameda County --Condition_1\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the highest eligible free rate for K-12 students in the schools in Alameda County\n", "input_prompt": "[Instruction]\nGiven a 【query】, you need to understanding the intent of Query, and then deceompose it into Targets and Conditions. Then you need to combine Targets and Conditions into Subquerys step by step. \nFor the case where Conditions is NULL, consider Targets as the final Subquery directly. \nFor the case where Conditions are not NULL, combine Targets and the first Condition to get the first Subquery, then combine this Subquery and the next Condition into a new Subquery until all Conditions are used (which means the content of the last Subquery and the original Query is the same).\n\n[Requirements]\n-Try not to overlap Targets and Conditions.\n-Make sure the decomposed Target and Condition can cover all of the information in Query.\n-Don't change any information (specific value) in Query!\n-Mark each Subquery with ## in front of it.\n\nHere are some examples:\n==========\n\n【Query】\nShow the stadium name and the number of concerts in each stadium. Please also list the year the stadium was built. \n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the stadium name, the year the stadium built and the number of concerts in each stadium\nConditions: NULL\n\nSubqueries:\n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the stadium name, the year the stadium built and the number of concerts in each stadium\n==========\n\n【Query】\nWhat is the qualification rate for the H-11 products produced in 2023/11/2?\n【Evidence】\nqualification rate = `Numqualified(H-11)` / `production(H-11)`\n\n【Decomposition】\nTargets: List the qualification rate for the H-11 Products\nConditions:\n1. produced in 2023/11/2 --Condition_1\n\nSubqueries:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the qualification rate for the H-11 Products produced in 2023/11/2\n\n==========\n\n【Query】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n\n【Decomposition】\nTargets: List the race of institutions\nConditions: \n1. in Alabama --Condition_1\n2. number of students greater than the 90% of average number of students of all institutions --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the race of institution in Alabama\n2. Conbine the first Subquery and Conditon_2 to get the seconed Subquery.\n##Subquery: List the race of institutions in Alabama with number of number of students greater than the 90% of average number of students of all institutions\n\n==========\n\n【Query】\nWhich president got a higher approval rating, Joseph Biden or Donald Trump?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\nConditions: \nNULL\n\nSubqueries: \n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\n\n==========\n\n【Query】\nFor movie id 1269, how many users, who was a paying subscriber and was eligible for trial when he rated the movie, gave the movie a rating score of less than or equal to 2?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the number of users\nConditions:\n1. was a paying subscriber --Condition_1\n2. was eligible for trial --Condition_2\n3. for movie id 1269, gave the movie a rating score of less than or equal to 2 --Condition3\n\nSubquerys:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the number of users who was a paying subscriber\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial\n3. Combine the second Subquery and Condition_3 to get the third Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial and gave the movie whose id is 1269 a rating score of less than or equal to 2\n\n==========\n\nHere is a new query need to be decomposed:\n\n【Query】\nWhat is the highest eligible free rate for K-12 students in the schools in Alameda County?\n【Evidence】\nEligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n\n【Decomposition】\n", "prompt_token": 1061, "response_token": 74, "cur_total_prompt_tokens": 6203, "cur_total_response_tokens": 74}
{"idx": 0, "db_id": "california_schools", "query": "What is the highest eligible free rate for K-12 students in the schools in Alameda County?", "evidence": "Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`", "difficulty": "simple", "ground_truth": "SELECT `Free Meal Count (K-12)` / `Enrollment (K-12)` FROM frpm WHERE `County Name` = 'Alameda' ORDER BY (CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)`) DESC LIMIT 1", "send_to": "Generator", "response": "\nTo answer the question \"What is the highest eligible free rate for K-12 students in the schools in Alameda County?\", we need to follow these steps:\n\n1. **Identify the target columns**: We need to calculate the eligible free rate for K-12 students, which is given by the formula:\n   \\[\n   \\text{Eligible free rate for K-12} = \\frac{\\text{Free Meal Count (K-12)}}{\\text{Enrollment (K-12)}}\n   \\]\n   We will also need to filter the results to only include schools in Alameda County.\n\n2. **Select the relevant tables**: The relevant tables are `frpm` (which contains the free meal count and enrollment data) and `schools` (which contains the county information). We will join these tables based on the `CDSCode`.\n\n3. **Construct the SQL query**:\n   - We will join the `frpm` and `schools` tables on `CDSCode`.\n   - We will filter for schools in Alameda County.\n   - We will calculate the eligible free rate and use the `MAX` function to find the highest rate.\n\n4. **Final SQL**:\n```sql\nSELECT MAX(F.`Free Meal Count (K-12)` / F.`Enrollment (K-12)`) AS highest_eligible_free_rate\nFROM frpm AS F\nJOIN schools AS S ON F.`CDSCode` = S.`CDSCode`\nWHERE S.`County` = 'Alameda'\nAND F.`Enrollment (K-12)` > 0  -- To avoid division by zero\n```\n\n### Explanation of the SQL:\n- `SELECT MAX(F.`Free Meal Count (K-12)` / F.`Enrollment (K-12)`) AS highest_eligible_free_rate`: This selects the maximum eligible free rate calculated from the free meal count and enrollment.\n- `FROM frpm AS F JOIN schools AS S ON F.`CDSCode` = S.`CDSCode``: This joins the `frpm` and `schools` tables on the `CDSCode`.\n- `WHERE S.`County` = 'Alameda'`: This filters the results to only include schools in Alameda County.\n- `AND F.`Enrollment (K-12)` > 0`: This ensures that we do not divide by zero when calculating the eligible free rate.\n\nThis SQL query will return the highest eligible free rate for K-12 students in schools located in Alameda County.\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】and a 【Question】, you need to use valid SQLite and understand the database and knowledge so that you can generate a good SQL for the 【Question】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# stadium: [Stadium_ID (INTEGER), Location (TEXT), Name (TEXT)]\n# concert: [concert_ID (INTEGER), concert_Name (TEXT), Stadium_ID (INTEGER)]\n【Primary keys】\nstadium.`Stadium_ID` | concert.`concert_ID`\n【Foreign keys】\nconcert.`Stadium_ID` = stadium.`Stadium_ID`\n【Detailed descriptions of tables and columns】\nstadium.`Stadium_ID`: The column 'Stadium_ID' in Table <stadium> has column descriptions of \"stadium id\". Value examples: [1, 2, 3, 4, 5, 6].\nstadium.`Name`:  The column 'Name' in Table <stadium> has column descriptions of \"name of stadium\". Value examples: [\"Stark's Park\", 'Somerset Park', 'Recreation Park', 'Hampden Park', 'Glebe Park', 'Gayfield Park'].\nstadium.`Location`: The column 'Location' in Table <stadium> has column descriptions of \"location of stadium\". Value examples: ['Stirling Albion', 'Raith Rovers', \"Queen's Park\", 'Peterhead', 'East Fife', 'Brechin City'].\nconcert.`concert_ID`: The column 'concert_ID' in Table <concert> has column descriptions of \"concert id\". Value examples: [1, 2, 3, 4, 5, 6].\nconcert.`concert_Name`: The column 'concert_Name' in Table <concert> has column descriptions of \"concert name\". Value examples: ['Week 1', 'Week 2', 'Super bootcamp', 'Home Visits', 'Auditions'].\nconcert.`Stadium_ID`: The column 'Stadium_ID' in Table <concert> has column descriptions of \"stadium id\". Value examples: [2, 9, 7, 10, 1].\n【Evidence】\nNULL\n【Question】\nShow the stadium name and the number of concerts in each stadium.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: Show the stadium name and the number of concerts in each stadium.\nTargets for `SELECT`: the stadium name and the number of concerts\nhints from 【Evidence】:NULL\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the stadium name refers to stadium.`Name`, the number of concerts refers to COUNT(concert.`concert_ID`), each stadium refers to stadium.`Stadium_ID`\nConnection of tables: include tables <stadium> and <concert>, get connected keys from 【Foreign keys】: concert.`Stadium_ID` = stadium.`Stadium_ID`\nFinal SQL:\n```sql\nSELECT T1.`Name`, COUNT(T2.concert_ID) AS num_concerts\n  FROM stadium AS T1\n  JOIN concert AS T2\n  ON T1.`Stadium_ID` = T2.`Stadium_ID`\n  GROUP BY T1.`Stadium_ID`\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); name of the car refers to car_name\n【Question】\nWhat is the fastest car made by Japan?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ncountry.`country` = 'Japan'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: What is the fastest car made by Japan?\nTargets for `SELECT`: the name of the fastest car\nhints from 【Evidence】: the fastest refers to max(horsepower); name of the car refers to car_name\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: car refers to data.`car_name`, the fastest refers to MAX(data.`horsepower`), Japan refers to country.`country`\nConnection of tables: includes tables <data> and <country>, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`car_name` \n  FROM data AS T1 \n  INNER JOIN production AS T2 \n  ON T1.`ID` = T2.`ID` \n  INNER JOIN country AS T3 \n  ON T3.`origin` = T2.`country` \n  WHERE T3.`country` = 'Japan' \n  ORDER BY T1.`horsepower` DESC LIMIT 1\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`chronname`: The column 'chronname' in Table <institution_details> has column descriptions of \"Institution name\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \n【Evidence】\nnumber of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the chronname of institutions with number of students greater than the 90% of average number of students of all institutions?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: List the chroname of institutions with number of students greater than the 90% of average number of students of all institutions?\nTargets for `SELECT`: the chroname of institutions\nhints from 【Evidence】: number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the chronname of institutions refers to institution_details.`chronname`, number of students refers to institution_details.`student_count`\nConnection of tables: include only one table <institution_details>, no connection\nFinal SQL:\n```sql\nSELECT DISTINCT `chroname`\n  FROM institution_details\n  WHERE `student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details\n  ) \n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\n\n【Evidence】\nEligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n【Question】\nWhat is the highest eligible free rate for K-12 students in the schools in Alameda County?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n", "prompt_token": 3273, "response_token": 519, "cur_total_prompt_tokens": 9476, "cur_total_response_tokens": 593}
{"idx": 1, "db_id": "california_schools", "query": "Please list the lowest three eligible free rates for students aged 5-17 in continuation schools.", "evidence": "Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`", "difficulty": "moderate", "ground_truth": "SELECT `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` FROM frpm WHERE `Educational Option Type` = 'Continuation School' AND `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` IS NOT NULL ORDER BY `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` ASC LIMIT 3", "send_to": "Soft_Schema_Linker", "response": "\nThe entities extracted from the 【Question】 are: \n1. lowest three eligible free rates\n2. students aged 5-17\n3. continuation schools\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. lowest three eligible free rates --Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` **the columns about Free Meal Count and Enrollment are related**\n2. students aged 5-17 --This is directly related to the columns about ages 5-17 **the columns about Free Meal Count and Enrollment are related**\n3. continuation schools --This refers to the type of school **the columns about School Type are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"lowest three eligible free rates\": [\"frpm.Free Meal Count (Ages 5-17)\",\"frpm.Enrollment (Ages 5-17)\",\"frpm.School Type\"],\n  \"students aged 5-17\": [\"frpm.Free Meal Count (Ages 5-17)\",\"frpm.Enrollment (Ages 5-17)\",\"frpm.Low Grade\"],\n  \"continuation schools\": [\"frpm.School Type\",\"frpm.CDSCode\",\"frpm.District Name\"]\n}\n```\nQuestion Solved.\n", "input_prompt": "As an experienced and professional database administrator, your task is to analyze a user question and a database schema to provide relevant information. The database schema consists of table descriptions, each containing multiple column descriptions. Your goal is to extract the entities from question and identify the relevant tables and columns based on these entities and the evidence provided.\n\n[Instruction]:\n1. Extract the mentioned entities from the user question. Make sure all of the entities are extracted. \n2. For each entity, keep at least 3 related columns.\n4. Your output should include entity extraction, analysis and related database schema.\n5. The related database schema should be in JSON format.\n6. Each column's information in provided 【Schema】 is in this format: (column, description. Value examples<optional>)\n\n[Requirements]:\n1. Sort the related columns in each list corresponding to each entity in descending order of relevance.\n2. The chosen columns should be in this format: <table.column>.\n3. Make sure each chosen list is not empty. The value [] will be punished. \n4.【Matched values】 may contain redundant or useless information in addition to the correct matching values, so you need to select the useful information in conjunction with the specific column names and descriptions.\n5. An entity may not have a corresponding evidence, which requires you to find the relevant columns yourself through your understanding of the database schema.\n\nHere is a typical example:\n\n==========\n【DB_ID】 banking_system\n【Schema】\n# Table: account\n[\n  (account_id <INTEGER>, the id of the account. Value examples: [11382, 11362, 2, 1, 2367].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (frequency <TEXT>, frequency of the acount. Value examples: ['POPLATEK MESICNE', 'POPLATEK TYDNE', 'POPLATEK PO OBRATU'].),\n  (date <DATE>, the creation date of the account. Value examples: ['1997-12-29', '1997-12-28'].)\n]\n# Table: client\n[\n  (client_id <INTEGER>, the unique number. Value examples: [13998, 13971, 2, 1, 2839].),\n  (gender <TEXT>, gender. Value examples: ['M', 'F']. And F：female . M：male ),\n  (birth_date <DATE>, birth date. Value examples: ['1987-09-27', '1986-08-13'].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (first_name <TEXT>, first_name.),\n  (last_name <TEXT>, last_name.)\n]\n# Table: loan\n[\n  (loan_id <INTEGER>, the id number identifying the loan data. Value examples: [4959, 4960, 4961].),\n  (account_id <INTEGER>, the id number identifying the account. Value examples: [10, 80, 55, 43].),\n  (date <DATE>, the date when the loan is approved. Value examples: ['1998-07-12', '1998-04-19'].),\n  (amount <INTEGER>, the id number identifying the loan data. Value examples: [1567, 7877, 9988].),\n  (duration <INTEGER>, the id number identifying the loan data. Value examples: [60, 48, 24, 12, 36].),\n  (payments <INTEGER>, the id number identifying the loan data. Value examples: [3456, 8972, 9845].),\n  (status <TEXT>, the id number identifying the loan data. Value examples: ['C', 'A', 'D', 'B'].)\n]\n# Table: district\n[\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76].),\n  (A2 <REAL>, area in square kilometers. Value examples: [50.5, 48.9].),\n  (A4 <INTEGER>, number of inhabitants. Value examples: [95907, 95616].),\n  (A5 <INTEGER>, number of households. Value examples: [35678, 34892].),\n  (A6 <REAL>, literacy rate. Value examples: [95.6, 92.3, 89.7].),\n  (A7 <INTEGER>, number of entrepreneurs. Value examples: [1234, 1456].),\n  (A8 <INTEGERt>, number of cities. Value examples: [5, 4].),\n  (A9 <INTEGER>, number of schools. Value examples: [15, 12, 10].),\n  (A10 <INTEGER>, number of hospitals. Value examples: [8, 6, 4].),\n  (A11 <REAL>, average salary. Value examples: [12541.5, 11277].),\n  (A12 <REAL>, poverty rate. Value examples: [12.4, 9.8].),\n  (A13 <REAL>, unemployment rate. Value examples: [8.2, 7.9].),\n  (A15 <INTEGER>, number of crimes. Value examples: [256, 189].)\n]\n【Primary keys】\naccount.`account_id` | client.`client_id` | loan.`loan_id` | district.`district_id`\n【Foreign keys】\nclient.`district_id` = district.`district_id`\n【Question】\nWhat is the gender of the youngest client who opened account in the lowest average salary branch and when did this client open the account? Please list their full name.\n【Evidence】\nLater birthdate refers to younger age; A11 refers to average salary; Full name refers to first_name, last_name\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\nThe entities extracted from the 【Question】 are: \n1. gender; \n2. youngest client; \n3. account; \n4. lowest average salary branch; \n5. when did this client open the account; \n6. full name\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. gender --no related evidence **the columns about gender are related**\n2. youngest client  --Later birthdate refers to younger age; **the columns about birth date of client and the id of client are related**\n3. account --no related evidence **the columns about account or account ids are related**\n4. lowest average salary branch  --A11 refers to average salary **the columns about average salary and branch are related**\n5. when did this client open the account --no related evidence **the columns about time or date of the account are related**\n6. full name  --Full name refers to first_name, last_name **the columns about first_name, last_name of the client are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"gender\": [\"client.gender\",\"client.client_id\",\"loan.status\"],\n  \"youngest client\": [\"client.birth_date\",\"client.client_id\",\"account.date\",\"loan.date\"],\n  \"account\": [\"account.account_id\",\"loan.account_id\",\"account.date\"],\n  \"lowest average salary branch\": [\"district.A11\",\"district.district_id\",\"district.A13\"],\n  \"when did this client open the account\": [\"account.date\",\"loan.date\",\"client.birth_date\"],\n  \"full name\": [\"client.first_name\",\"client.last_name\",\"client.client_id\"]\n}\n```\nQuestion Solved.\n\n==========\n\nHere is a new example, please start answering:\n\n【DB_ID】 california_schools\n【Schema】\n# Table: frpm\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (Academic Year <TEXT>,  Academic Year. Value examples: ['2014-2015'].),\n  (County Code <TEXT>,  County Code. Value examples: ['19', '37', '30', '36', '33', '43'].),\n  (District Code <INTEGER>,  District Code.),\n  (School Code <TEXT>,  School Code. Value examples: ['0000000', '9010745', '6121081', '6121073', '6121016', '6120968'].),\n  (County Name <TEXT>,  County Name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].),\n  (District Name <TEXT>,  District Name.),\n  (School Name <TEXT>,  School Name.),\n  (District Type <TEXT>,  District Type. Value examples: ['Unified School District', 'Elementary School District', 'High School District', 'County Office of Education (COE)', 'State Board of Education', 'Statewide Benefit Charter'].),\n  (School Type <TEXT>,  School Type. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].),\n  (Educational Option Type <TEXT>,  Educational Option Type. Value examples: [None, 'Traditional', 'Continuation School', 'Alternative School of Choice', 'Community Day School', 'Special Education School', 'County Community School'].),\n  (NSLP Provision Status <TEXT>,  NSLP Provision Status. Value examples: [None, 'Provision 2', 'Breakfast Provision 2', 'CEP', 'Multiple Provision Types', 'Provision 1', 'Lunch Provision 2'].),\n  (Charter School (Y/N) <INTEGER>,  Charter School (Y/N). Value examples: [None, 0, 1].),\n  (Charter School Number <TEXT>,  Charter School Number. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1700', '1696'].),\n  (Charter Funding Type <TEXT>,  Charter Funding Type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (IRC <INTEGER>,  IRC. Value examples: [None, 0, 1].),\n  (Low Grade <TEXT>,  Low Grade. Value examples: ['K', '9', '6', '7', 'P', '5'].),\n  (High Grade <TEXT>,  High Grade. Value examples: ['12', '5', '8', '6', '3', '4'].),\n  (Enrollment (K-12) <REAL>,  Enrollment (K-12).),\n  (Free Meal Count (K-12) <REAL>,  Free Meal Count (K-12).),\n  (Percent (%) Eligible Free (K-12) <REAL>,  Percent (%) Eligible Free (K-12).),\n  (FRPM Count (K-12) <REAL>,  Free or Reduced Price Meal Count (K-12).),\n  (Percent (%) Eligible FRPM (K-12) <REAL>,  Percent (%) Eligible FRPM (K-12).),\n  (Enrollment (Ages 5-17) <REAL>,  Enrollment (Ages 5-17).),\n  (Free Meal Count (Ages 5-17) <REAL>,  Free Meal Count (Ages 5-17).),\n  (Percent (%) Eligible Free (Ages 5-17) <REAL>,  Percent (%) Eligible Free (Ages 5-17).),\n  (FRPM Count (Ages 5-17) <REAL>,  FRPM Count (Ages 5-17).),\n  (Percent (%) Eligible FRPM (Ages 5-17) <REAL>,  Percent (%) Eligible FRPM (Ages 5-17).),\n  (2013-14 CALPADS Fall 1 Certification Status <INTEGER>,  2013-14 CALPADS Fall 1 Certification Status. Value examples: [1].)\n]\n# Table: satscores\n[\n  (cds <TEXT>,  California Department Schools.),\n  (rtype <TEXT>,  rtype. Value examples: ['S', 'D'].),\n  (sname <TEXT>,  school name. Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].),\n  (dname <TEXT>,  district segment. Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].),\n  (cname <TEXT>,  county name. Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].),\n  (enroll12 <INTEGER>,  enrollment (1st-12nd grade).),\n  (NumTstTakr <INTEGER>,  Number of Test Takers in this school.),\n  (AvgScrRead <INTEGER>,  average scores in Reading.),\n  (AvgScrMath <INTEGER>,  average scores in Math.),\n  (AvgScrWrite <INTEGER>,  average scores in writing.),\n  (NumGE1500 <INTEGER>,  Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500.)\n]\n# Table: schools\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (NCESDist <TEXT>,  This field represents the 7-digit National Center for Educational Statistics (NCES) school district identification number. The first 2 digits identify the state and the last 5 digits identify the school district. Combined, they make a unique 7-digit ID for each school district.. Value examples: [None, '0622710', '0634320', '0628050', '0634410', '0614550', '0633840'].),\n  (NCESSchool <TEXT>,  This field represents the 5-digit NCES school identification number. The NCESSchool combined with the NCESDist form a unique 12-digit ID for each school.. Value examples: [None, '12271', '13785', '13747', '12909', '12311', '12003'].),\n  (StatusType <TEXT>,  This field identifies the status of the district.. Value examples: ['Active', 'Closed', 'Merged', 'Pending'].),\n  (County <TEXT>,  County name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].),\n  (District <TEXT>,  District.),\n  (School <TEXT>,  School.),\n  (Street <TEXT>,  Street.),\n  (StreetAbr <TEXT>,  The abbreviated street address of the school, district, or administrative authority’s physical location..),\n  (City <TEXT>,  City. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].),\n  (Zip <TEXT>,  Zip. Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].),\n  (State <TEXT>,  State. Value examples: [None, 'CA'].),\n  (MailStreet <TEXT>,  MailStreet.),\n  (MailStrAbr <TEXT>,  mailing street address.),\n  (MailCity <TEXT>,  mailing city. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].),\n  (MailZip <TEXT>,  mailing zip. Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].),\n  (MailState <TEXT>,  mailing state. Value examples: [None, 'CA'].),\n  (Phone <TEXT>,  Phone. Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].),\n  (Ext <TEXT>,  The phone number extension of the school, district, or administrative authority.. Value examples: [None, '200', '201', '111', '352', '221', '203'].),\n  (Website <TEXT>,  The website address of the school, district, or administrative authority..),\n  (OpenDate <DATE>,  The date the school opened.. Value examples: [None, '1980-07-01'].),\n  (ClosedDate <DATE>,  The date the school closed.. Value examples: [None, '1989-06-30'].),\n  (Charter <INTEGER>,  This field identifies a charter school.. Value examples: [None, 0, 1].),\n  (CharterNum <TEXT>,  The charter school number,. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1826', '1710'].),\n  (FundingType <TEXT>,  Indicates the charter school funding type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (DOC <TEXT>,  District Ownership Code. Value examples: ['54', '52', '00', '56', '98', '02'].),\n  (DOCType <TEXT>,  The District Ownership Code Type is the text description of the DOC category.. Value examples: ['Unified School District', 'Elementary School District', 'County Office of Education (COE)', 'High School District', 'Regional Occupation Center/Program (ROC/P)', 'State Board of Education'].),\n  (SOC <TEXT>,  The School Ownership Code is a numeric code used to identify the type of school.. Value examples: [None, '60', '66', '62', '68', '09', '69'].),\n  (SOCType <TEXT>,  The School Ownership Code Type is the text description of the type of school.. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Special Education Schools (Public)', 'District Community Day Schools'].),\n  (EdOpsCode <TEXT>,  The Education Option Code is a short text description of the type of education offered.. Value examples: [None, 'TRAD', 'CON', 'COMMDAY', 'ALTSOC', 'SPEC', 'COMM'].),\n  (EdOpsName <TEXT>,  Educational Option Name. Value examples: [None, 'Traditional', 'Continuation School', 'Community Day School', 'Alternative School of Choice', 'Special Education School', 'County Community School'].),\n  (EILCode <TEXT>,  The Educational Instruction Level Code is a short text description of the institution's type relative to the grade range served.. Value examples: [None, 'ELEM', 'HS', 'UG', 'INTMIDJR', 'ELEMHIGH', 'A'].),\n  (EILName <TEXT>,  The Educational Instruction Level Name is the long text description of the institution’s type relative to the grade range served.. Value examples: [None, 'Elementary', 'High School', 'Ungraded', 'Intermediate/Middle/Junior High', 'Elementary-High Combination', 'Adult'].),\n  (GSoffered <TEXT>,  The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.. Value examples: [None, 'K-5', '9-12', 'K-6', 'K-8', '6-8', 'K-12'].),\n  (GSserved <TEXT>,  It is the lowest grade and the highest grade of student enrollment as reported in the most recent certified CALPADS Fall 1 data collection. Only K–12 enrollment is reported through CALPADS. This field may differ from the grade span offered.. Value examples: [None, 'K-5', 'K-6', '9-12', 'K-8', '6-8', '7-8'].),\n  (Virtual <TEXT>,  This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.. Value examples: [None, 'N', 'P', 'F'].),\n  (Magnet <INTEGER>,  This field identifies whether a school is a magnet school and/or provides a magnet program.. Value examples: [None, 0, 1].),\n  (Latitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the equator measured north to south..),\n  (Longitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the prime meridian (Greenwich, England) measured from west to east..),\n  (AdmFName1 <TEXT>,  administrator's first name 1. Value examples: [None, 'David', 'Michael', 'John', 'Jennifer', 'Lisa', 'Robert'].),\n  (AdmLName1 <TEXT>,  administrator's last name 1.),\n  (AdmEmail1 <TEXT>,  administrator's email address 1.),\n  (AdmFName2 <TEXT>,  administrator's first name 2. Value examples: [None, 'Steve', 'Delphine', 'Tim', 'Michael', 'Lisa', 'Jeff'].),\n  (AdmLName2 <TEXT>,  administrator's last name 2. Value examples: [None, 'Sherman', 'Jones', 'Wilson', 'Petersen', 'Landry', 'Hambright'].),\n  (AdmEmail2 <TEXT>,  administrator's email address 2.),\n  (AdmFName3 <TEXT>,  administrator's first name 3. Value examples: [None, 'Mark', 'Eric', 'Vickie', 'Tracie', 'Shawn', 'Sarah'].),\n  (AdmLName3 <TEXT>,  administrator's last name 3. Value examples: [None, 'Zerpoli', 'Yount', 'Woodruff', 'Wood', 'Wolk', 'Spotts'].),\n  (AdmEmail3 <TEXT>,  administrator's email address 3.),\n  (LastUpdate <DATE>,  Last Update. Value examples: ['2015-06-18'].)\n]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Question】\nPlease list the lowest three eligible free rates for students aged 5-17 in continuation schools.\n【Evidence】\nEligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\n", "prompt_token": 5150, "response_token": 298, "cur_total_prompt_tokens": 14626, "cur_total_response_tokens": 891}
{"idx": 1, "db_id": "california_schools", "query": "Please list the lowest three eligible free rates for students aged 5-17 in continuation schools.", "evidence": "Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`", "difficulty": "moderate", "ground_truth": "SELECT `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` FROM frpm WHERE `Educational Option Type` = 'Continuation School' AND `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` IS NOT NULL ORDER BY `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` ASC LIMIT 3", "send_to": "Decomposer", "response": "\nTargets: List the lowest three eligible free rates for students aged 5-17 in continuation schools\nConditions: \n1. for students aged 5-17 --Condition_1\n2. in continuation schools --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the lowest three eligible free rates for students aged 5-17\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the lowest three eligible free rates for students aged 5-17 in continuation schools\n", "input_prompt": "[Instruction]\nGiven a 【query】, you need to understanding the intent of Query, and then deceompose it into Targets and Conditions. Then you need to combine Targets and Conditions into Subquerys step by step. \nFor the case where Conditions is NULL, consider Targets as the final Subquery directly. \nFor the case where Conditions are not NULL, combine Targets and the first Condition to get the first Subquery, then combine this Subquery and the next Condition into a new Subquery until all Conditions are used (which means the content of the last Subquery and the original Query is the same).\n\n[Requirements]\n-Try not to overlap Targets and Conditions.\n-Make sure the decomposed Target and Condition can cover all of the information in Query.\n-Don't change any information (specific value) in Query!\n-Mark each Subquery with ## in front of it.\n\nHere are some examples:\n==========\n\n【Query】\nShow the stadium name and the number of concerts in each stadium. Please also list the year the stadium was built. \n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the stadium name, the year the stadium built and the number of concerts in each stadium\nConditions: NULL\n\nSubqueries:\n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the stadium name, the year the stadium built and the number of concerts in each stadium\n==========\n\n【Query】\nWhat is the qualification rate for the H-11 products produced in 2023/11/2?\n【Evidence】\nqualification rate = `Numqualified(H-11)` / `production(H-11)`\n\n【Decomposition】\nTargets: List the qualification rate for the H-11 Products\nConditions:\n1. produced in 2023/11/2 --Condition_1\n\nSubqueries:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the qualification rate for the H-11 Products produced in 2023/11/2\n\n==========\n\n【Query】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n\n【Decomposition】\nTargets: List the race of institutions\nConditions: \n1. in Alabama --Condition_1\n2. number of students greater than the 90% of average number of students of all institutions --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the race of institution in Alabama\n2. Conbine the first Subquery and Conditon_2 to get the seconed Subquery.\n##Subquery: List the race of institutions in Alabama with number of number of students greater than the 90% of average number of students of all institutions\n\n==========\n\n【Query】\nWhich president got a higher approval rating, Joseph Biden or Donald Trump?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\nConditions: \nNULL\n\nSubqueries: \n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\n\n==========\n\n【Query】\nFor movie id 1269, how many users, who was a paying subscriber and was eligible for trial when he rated the movie, gave the movie a rating score of less than or equal to 2?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the number of users\nConditions:\n1. was a paying subscriber --Condition_1\n2. was eligible for trial --Condition_2\n3. for movie id 1269, gave the movie a rating score of less than or equal to 2 --Condition3\n\nSubquerys:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the number of users who was a paying subscriber\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial\n3. Combine the second Subquery and Condition_3 to get the third Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial and gave the movie whose id is 1269 a rating score of less than or equal to 2\n\n==========\n\nHere is a new query need to be decomposed:\n\n【Query】\nPlease list the lowest three eligible free rates for students aged 5-17 in continuation schools.\n【Evidence】\nEligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`\n\n【Decomposition】\n", "prompt_token": 1069, "response_token": 123, "cur_total_prompt_tokens": 15695, "cur_total_response_tokens": 1014}
{"idx": 1, "db_id": "california_schools", "query": "Please list the lowest three eligible free rates for students aged 5-17 in continuation schools.", "evidence": "Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`", "difficulty": "moderate", "ground_truth": "SELECT `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` FROM frpm WHERE `Educational Option Type` = 'Continuation School' AND `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` IS NOT NULL ORDER BY `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` ASC LIMIT 3", "send_to": "Generator", "response": "\nTo answer the question \"List the lowest three eligible free rates for students aged 5-17\", we need to follow these steps:\n\n1. **Identify the target columns**: We need to calculate the eligible free rates for students aged 5-17, which is given by the formula:\n   \\[\n   \\text{Eligible Free Rate} = \\frac{\\text{Free Meal Count (Ages 5-17)}}{\\text{Enrollment (Ages 5-17)}}\n   \\]\n   We will also need to select the `CDSCode` or `School Name` to identify the schools associated with these rates.\n\n2. **Select the relevant columns**: From the `frpm` table, we need:\n   - `Free Meal Count (Ages 5-17)`\n   - `Enrollment (Ages 5-17)`\n   - `CDSCode` or `School Name` for identification.\n\n3. **Calculate the eligible free rates**: We will use the formula to calculate the eligible free rates in the `SELECT` statement.\n\n4. **Filter out schools with zero enrollment**: To avoid division by zero, we should ensure that `Enrollment (Ages 5-17)` is not zero.\n\n5. **Order the results**: We need to order the results by the calculated eligible free rate in ascending order to get the lowest rates.\n\n6. **Limit the results**: Finally, we will limit the results to the lowest three rates.\n\nNow, let's construct the SQL query step by step:\n\n### Final SQL Query\n```sql\nSELECT \n    `CDSCode`, \n    `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` AS eligible_free_rate\nFROM \n    frpm\nWHERE \n    `Enrollment (Ages 5-17)` > 0\nORDER BY \n    eligible_free_rate ASC\nLIMIT 3\n```\n\n### Explanation of the SQL Query:\n- **SELECT**: We select the `CDSCode` and calculate the eligible free rate.\n- **FROM**: We are querying from the `frpm` table.\n- **WHERE**: We ensure that the enrollment is greater than zero to avoid division by zero.\n- **ORDER BY**: We order the results by the calculated eligible free rate in ascending order.\n- **LIMIT**: We limit the results to the lowest three eligible free rates.\n\nThis SQL query will provide the desired output of the lowest three eligible free rates for students aged 5-17.\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】and a 【Question】, you need to use valid SQLite and understand the database and knowledge so that you can generate a good SQL for the 【Question】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# stadium: [Stadium_ID (INTEGER), Location (TEXT), Name (TEXT)]\n# concert: [concert_ID (INTEGER), concert_Name (TEXT), Stadium_ID (INTEGER)]\n【Primary keys】\nstadium.`Stadium_ID` | concert.`concert_ID`\n【Foreign keys】\nconcert.`Stadium_ID` = stadium.`Stadium_ID`\n【Detailed descriptions of tables and columns】\nstadium.`Stadium_ID`: The column 'Stadium_ID' in Table <stadium> has column descriptions of \"stadium id\". Value examples: [1, 2, 3, 4, 5, 6].\nstadium.`Name`:  The column 'Name' in Table <stadium> has column descriptions of \"name of stadium\". Value examples: [\"Stark's Park\", 'Somerset Park', 'Recreation Park', 'Hampden Park', 'Glebe Park', 'Gayfield Park'].\nstadium.`Location`: The column 'Location' in Table <stadium> has column descriptions of \"location of stadium\". Value examples: ['Stirling Albion', 'Raith Rovers', \"Queen's Park\", 'Peterhead', 'East Fife', 'Brechin City'].\nconcert.`concert_ID`: The column 'concert_ID' in Table <concert> has column descriptions of \"concert id\". Value examples: [1, 2, 3, 4, 5, 6].\nconcert.`concert_Name`: The column 'concert_Name' in Table <concert> has column descriptions of \"concert name\". Value examples: ['Week 1', 'Week 2', 'Super bootcamp', 'Home Visits', 'Auditions'].\nconcert.`Stadium_ID`: The column 'Stadium_ID' in Table <concert> has column descriptions of \"stadium id\". Value examples: [2, 9, 7, 10, 1].\n【Evidence】\nNULL\n【Question】\nShow the stadium name and the number of concerts in each stadium.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: Show the stadium name and the number of concerts in each stadium.\nTargets for `SELECT`: the stadium name and the number of concerts\nhints from 【Evidence】:NULL\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the stadium name refers to stadium.`Name`, the number of concerts refers to COUNT(concert.`concert_ID`), each stadium refers to stadium.`Stadium_ID`\nConnection of tables: include tables <stadium> and <concert>, get connected keys from 【Foreign keys】: concert.`Stadium_ID` = stadium.`Stadium_ID`\nFinal SQL:\n```sql\nSELECT T1.`Name`, COUNT(T2.concert_ID) AS num_concerts\n  FROM stadium AS T1\n  JOIN concert AS T2\n  ON T1.`Stadium_ID` = T2.`Stadium_ID`\n  GROUP BY T1.`Stadium_ID`\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); name of the car refers to car_name\n【Question】\nWhat is the fastest car made by Japan?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ncountry.`country` = 'Japan'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: What is the fastest car made by Japan?\nTargets for `SELECT`: the name of the fastest car\nhints from 【Evidence】: the fastest refers to max(horsepower); name of the car refers to car_name\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: car refers to data.`car_name`, the fastest refers to MAX(data.`horsepower`), Japan refers to country.`country`\nConnection of tables: includes tables <data> and <country>, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`car_name` \n  FROM data AS T1 \n  INNER JOIN production AS T2 \n  ON T1.`ID` = T2.`ID` \n  INNER JOIN country AS T3 \n  ON T3.`origin` = T2.`country` \n  WHERE T3.`country` = 'Japan' \n  ORDER BY T1.`horsepower` DESC LIMIT 1\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`chronname`: The column 'chronname' in Table <institution_details> has column descriptions of \"Institution name\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \n【Evidence】\nnumber of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the chronname of institutions with number of students greater than the 90% of average number of students of all institutions?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: List the chroname of institutions with number of students greater than the 90% of average number of students of all institutions?\nTargets for `SELECT`: the chroname of institutions\nhints from 【Evidence】: number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the chronname of institutions refers to institution_details.`chronname`, number of students refers to institution_details.`student_count`\nConnection of tables: include only one table <institution_details>, no connection\nFinal SQL:\n```sql\nSELECT DISTINCT `chroname`\n  FROM institution_details\n  WHERE `student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details\n  ) \n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\nfrpm.`CDSCode`: The column 'CDSCode' in Table <frpm> has column descriptions of \"CDSCode\". \nfrpm.`District Name`: The column 'District Name' in Table <frpm> has column descriptions of \"District Name\". \nfrpm.`School Type`: The column 'School Type' in Table <frpm> has column descriptions of \"School Type\".  Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].\nfrpm.`Low Grade`: The column 'Low Grade' in Table <frpm> has column descriptions of \"Low Grade\".  Value examples: ['K', '9', '6', '7', 'P', '5'].\nfrpm.`Enrollment (Ages 5-17)`: The column 'Enrollment (Ages 5-17)' in Table <frpm> has column descriptions of \"Enrollment (Ages 5-17)\". \nfrpm.`Free Meal Count (Ages 5-17)`: The column 'Free Meal Count (Ages 5-17)' in Table <frpm> has column descriptions of \"Free Meal Count (Ages 5-17)\". \n\n【Evidence】\nEligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`\n【Question】\nList the lowest three eligible free rates for students aged 5-17\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n", "prompt_token": 3561, "response_token": 520, "cur_total_prompt_tokens": 19256, "cur_total_response_tokens": 1534}
{"idx": 1, "db_id": "california_schools", "query": "Please list the lowest three eligible free rates for students aged 5-17 in continuation schools.", "evidence": "Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`", "difficulty": "moderate", "ground_truth": "SELECT `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` FROM frpm WHERE `Educational Option Type` = 'Continuation School' AND `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` IS NOT NULL ORDER BY `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` ASC LIMIT 3", "send_to": "Refiner", "response": "\nAnalysis:\nThe provided SQL query attempts to calculate the eligible free rate for students aged 5-17 by dividing the `Free Meal Count (Ages 5-17)` by `Enrollment (Ages 5-17)`. However, it encounters an error due to the presence of `NULL` values in the `Enrollment (Ages 5-17)` column. To resolve this, we need to ensure that both `Free Meal Count (Ages 5-17)` and `Enrollment (Ages 5-17)` are not `NULL` before performing the division. We can achieve this by adding conditions to filter out rows where either of these columns is `NULL`.\n\nCorrect SQL:\n```sql\nSELECT `CDSCode`, `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` AS eligible_free_rate \nFROM frpm \nWHERE `Enrollment (Ages 5-17)` > 0 AND `Free Meal Count (Ages 5-17)` IS NOT NULL AND `Enrollment (Ages 5-17)` IS NOT NULL \nORDER BY eligible_free_rate ASC \nLIMIT 3\n```\n\n【Evidence】\nThe SQL now includes checks for `NULL` values in both `Free Meal Count (Ages 5-17)` and `Enrollment (Ages 5-17)`, ensuring that the division operation is only performed on valid data. This should prevent any errors related to `NULL` values during execution.\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nEligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`\n【Query】\n-- List the lowest three eligible free rates for students aged 5-17\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\nfrpm.`CDSCode`: The column 'CDSCode' in Table <frpm> has column descriptions of \"CDSCode\". \nfrpm.`District Name`: The column 'District Name' in Table <frpm> has column descriptions of \"District Name\". \nfrpm.`School Type`: The column 'School Type' in Table <frpm> has column descriptions of \"School Type\".  Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].\nfrpm.`Low Grade`: The column 'Low Grade' in Table <frpm> has column descriptions of \"Low Grade\".  Value examples: ['K', '9', '6', '7', 'P', '5'].\nfrpm.`Enrollment (Ages 5-17)`: The column 'Enrollment (Ages 5-17)' in Table <frpm> has column descriptions of \"Enrollment (Ages 5-17)\". \nfrpm.`Free Meal Count (Ages 5-17)`: The column 'Free Meal Count (Ages 5-17)' in Table <frpm> has column descriptions of \"Free Meal Count (Ages 5-17)\". \n\n【old SQL】\n```sql\nSELECT `CDSCode`, `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` AS eligible_free_rate FROM frpm WHERE `Enrollment (Ages 5-17)` > 0 ORDER BY eligible_free_rate ASC LIMIT 3 \n```\n【SQLite error】 \nexist None value, you can add `IS NOT NULL` in SQL\n【Exception class】\n\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 1426, "response_token": 314, "cur_total_prompt_tokens": 20682, "cur_total_response_tokens": 1848}
{"idx": 1, "db_id": "california_schools", "query": "Please list the lowest three eligible free rates for students aged 5-17 in continuation schools.", "evidence": "Eligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`", "difficulty": "moderate", "ground_truth": "SELECT `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` FROM frpm WHERE `Educational Option Type` = 'Continuation School' AND `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` IS NOT NULL ORDER BY `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` ASC LIMIT 3", "send_to": "Generator", "response": "\nTo generate the final SQL query for the question, we need to incorporate the conditions from the question into the provided Sub-SQL. The question asks for the lowest three eligible free rates for students aged 5-17 specifically in continuation schools. \n\n### Step-by-Step Breakdown:\n\n1. **Understanding the Sub-SQL**: \n   The provided Sub-SQL calculates the eligible free rate for students aged 5-17 by dividing the `Free Meal Count (Ages 5-17)` by the `Enrollment (Ages 5-17)`. It also filters out records where enrollment is zero or where the counts are NULL.\n\n2. **Adding Conditions from the Question**:\n   We need to filter the results to only include continuation schools. This can be done by adding a condition to the `WHERE` clause to check for `School Type = 'Continuation High Schools'`.\n\n3. **Final SQL Construction**:\n   We will modify the Sub-SQL to include the additional condition for the school type.\n\n### Final SQL Query:\n```sql\nSELECT `CDSCode`, \n       `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` AS eligible_free_rate \nFROM frpm \nWHERE `Enrollment (Ages 5-17)` > 0 \n  AND `Free Meal Count (Ages 5-17)` IS NOT NULL \n  AND `Enrollment (Ages 5-17)` IS NOT NULL \n  AND `School Type` = 'Continuation High Schools' \nORDER BY eligible_free_rate ASC NULLS LAST \nLIMIT 3\n```\n\n### Explanation of the Final SQL:\n- **SELECT Clause**: We select the `CDSCode` and calculate the eligible free rate.\n- **FROM Clause**: We are querying from the `frpm` table.\n- **WHERE Clause**: We ensure that:\n  - Enrollment is greater than zero.\n  - Free meal count and enrollment are not NULL.\n  - The school type is specifically 'Continuation High Schools'.\n- **ORDER BY Clause**: We order the results by the eligible free rate in ascending order, ensuring that NULL values are last.\n- **LIMIT Clause**: We limit the results to the lowest three eligible free rates.\n\nThis SQL query will provide the desired results as specified in the question.\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】, a 【Question】, a 【Subquesion】 extracted from 【Question】 and a 【Sub-SQL】 for the 【Subquestion】, you need to use valid SQLite and understand the database and knowledge, and then generate a complete SQL for the 【Question】 based on 【Sub-SQL】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); made by Japan refers to country = 'Japan'\n【Question】\nWhat is the price of the fastest car made by Japan?\n【Subquestion】\nWhat is the price of the fastest car?\n【Sub-SQL】\n```\nSELECT T1.`price` FROM price AS T1 INNER JOIN data AS T2 ON T2.`ID` = T1.`ID` ORDER BY T2.`horsepower` DESC LIMIT 1\n```\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\n【Subquestion】 is decomposed from 【Question】, now we provide Sub-SQL corresponding to Subquestion, you just need to complete the remaining conditions based on Sub-SQL to generate SQL for 【Question】. Consider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, and then generate SQL after thinking step by step:\nhints from 【Evidence】: the fastest refers to max(horsepower); made by Japan refers to country = 'Japan';\nFind necessary columns from 【Database schema】 in addition to Sub-SQL: Japan refers to country.`country`\nConnection of tables: the connection of <data> and <country> is needed, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`price` \n  FROM price AS T1 \n  INNER JOIN data AS T2\n  on T2.`ID` = T1.`ID`\n  INNER JOIN production AS T3 \n  ON T3.`ID` = T2.`ID` \n  INNER JOIN country AS T4 \n  ON T4.`origin` = T3.`country` \n  WHERE T4.`country` = 'Japan' \n  ORDER BY T2.`horsepower` DESC LIMIT 1\n```\n\nQuestion solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`state`: The column 'state' in Table <institution_details> has column descriptions of \"Institution state\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \ninstitution_grads.`race`: The column 'race' in Table <institution_grads> has column descriptions of \"race/ethnicity of students\". Value examples: ['X', 'Ai', 'A', 'B', 'H'].\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Subquestion】\nList the race of institutions in 'Alabama'. \n【Sub-SQL】\n```\nSELECT DISTINCT T1.`race` FROM institution_grads AS T1 INNER JOIN institution_details AS T2 ON T1.`unitid` = T2.`unitid` WHERE T2.`state` = 'Alabama'\n```\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ninstitution_details.`city` = 'Alabama'; institution_details.`state` = 'Alabama'\n\n【Subquestion】 is decomposed from 【Question】, now we provide Sub-SQL corresponding to Subquestion, you just need to complete the remaining conditions based on Sub-SQL to generate SQL for 【Question】. Consider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, and then generate SQL after thinking step by step:\nhints from 【Evidence】: Alabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFind necessary columns from 【Database schema】 in addition to Sub-SQL: number of students refers to institution_details.`student_count`\nConnection of tables: the table <institution_details> is already in Sub-SQL, no more connection is needed\nFinal SQL:\n```sql\nSELECT DISTINCT T1.`race` \n  FROM institution_grads AS T1 \n  INNER JOIN institution_details AS T2 \n  ON T1.`unitid` = T2.`unitid` \n  WHERE T2.`student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details \n  ) \n  AND T2.`state` = 'Alabama'\n```\n\nQuestion solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\nfrpm.`CDSCode`: The column 'CDSCode' in Table <frpm> has column descriptions of \"CDSCode\". \nfrpm.`District Name`: The column 'District Name' in Table <frpm> has column descriptions of \"District Name\". \nfrpm.`School Type`: The column 'School Type' in Table <frpm> has column descriptions of \"School Type\".  Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].\nfrpm.`Low Grade`: The column 'Low Grade' in Table <frpm> has column descriptions of \"Low Grade\".  Value examples: ['K', '9', '6', '7', 'P', '5'].\nfrpm.`Enrollment (Ages 5-17)`: The column 'Enrollment (Ages 5-17)' in Table <frpm> has column descriptions of \"Enrollment (Ages 5-17)\". \nfrpm.`Free Meal Count (Ages 5-17)`: The column 'Free Meal Count (Ages 5-17)' in Table <frpm> has column descriptions of \"Free Meal Count (Ages 5-17)\". \n\n【Evidence】\nEligible free rates for students aged 5-17 = `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`\n【Question】\nPlease list the lowest three eligible free rates for students aged 5-17 in continuation schools.\n【Subquestion】\nList the lowest three eligible free rates for students aged 5-17\n【Sub-SQL】\nSELECT `CDSCode`, `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` AS eligible_free_rate FROM frpm WHERE `Enrollment (Ages 5-17)` > 0 AND `Free Meal Count (Ages 5-17)` IS NOT NULL AND `Enrollment (Ages 5-17)` IS NOT NULL ORDER BY eligible_free_rate ASC NULLS LAST LIMIT 3 \n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\n【Subquestion】 is decomposed from 【Question】, now we provide Sub-SQL corresponding to Subquestion, you just need to complete the remaining conditions based on Sub-SQL to generate SQL for 【Question】. Consider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, and then generate SQL after thinking step by step:\n", "prompt_token": 3257, "response_token": 478, "cur_total_prompt_tokens": 23939, "cur_total_response_tokens": 2326}
{"idx": 2, "db_id": "california_schools", "query": "Please list the zip code of all the charter schools in Fresno County Office of Education.", "evidence": "Charter schools refers to `Charter School (Y/N)` = 1 in the table fprm", "difficulty": "simple", "ground_truth": "SELECT T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`District Name` = 'Fresno County Office of Education' AND T1.`Charter School (Y/N)` = 1", "send_to": "Soft_Schema_Linker", "response": "\nThe entities extracted from the 【Question】 are: \n1. zip code\n2. charter schools\n3. Fresno County Office of Education\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. zip code --no related evidence **the columns about zip codes are related**\n2. charter schools --Charter schools refers to `Charter School (Y/N)` = 1 in the table frpm **the columns about charter schools are related**\n3. Fresno County Office of Education --no related evidence **the columns about county names are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"zip code\": [\"schools.Zip\",\"schools.CDSCode\",\"schools.County\"],\n  \"charter schools\": [\"frpm.Charter School (Y/N)\",\"frpm.CDSCode\",\"frpm.County Name\"],\n  \"Fresno County Office of Education\": [\"frpm.County Code\",\"frpm.District Name\",\"frpm.County Name\"]\n}\n```\n", "input_prompt": "As an experienced and professional database administrator, your task is to analyze a user question and a database schema to provide relevant information. The database schema consists of table descriptions, each containing multiple column descriptions. Your goal is to extract the entities from question and identify the relevant tables and columns based on these entities and the evidence provided.\n\n[Instruction]:\n1. Extract the mentioned entities from the user question. Make sure all of the entities are extracted. \n2. For each entity, keep at least 3 related columns.\n4. Your output should include entity extraction, analysis and related database schema.\n5. The related database schema should be in JSON format.\n6. Each column's information in provided 【Schema】 is in this format: (column, description. Value examples<optional>)\n\n[Requirements]:\n1. Sort the related columns in each list corresponding to each entity in descending order of relevance.\n2. The chosen columns should be in this format: <table.column>.\n3. Make sure each chosen list is not empty. The value [] will be punished. \n4.【Matched values】 may contain redundant or useless information in addition to the correct matching values, so you need to select the useful information in conjunction with the specific column names and descriptions.\n5. An entity may not have a corresponding evidence, which requires you to find the relevant columns yourself through your understanding of the database schema.\n\nHere is a typical example:\n\n==========\n【DB_ID】 banking_system\n【Schema】\n# Table: account\n[\n  (account_id <INTEGER>, the id of the account. Value examples: [11382, 11362, 2, 1, 2367].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (frequency <TEXT>, frequency of the acount. Value examples: ['POPLATEK MESICNE', 'POPLATEK TYDNE', 'POPLATEK PO OBRATU'].),\n  (date <DATE>, the creation date of the account. Value examples: ['1997-12-29', '1997-12-28'].)\n]\n# Table: client\n[\n  (client_id <INTEGER>, the unique number. Value examples: [13998, 13971, 2, 1, 2839].),\n  (gender <TEXT>, gender. Value examples: ['M', 'F']. And F：female . M：male ),\n  (birth_date <DATE>, birth date. Value examples: ['1987-09-27', '1986-08-13'].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (first_name <TEXT>, first_name.),\n  (last_name <TEXT>, last_name.)\n]\n# Table: loan\n[\n  (loan_id <INTEGER>, the id number identifying the loan data. Value examples: [4959, 4960, 4961].),\n  (account_id <INTEGER>, the id number identifying the account. Value examples: [10, 80, 55, 43].),\n  (date <DATE>, the date when the loan is approved. Value examples: ['1998-07-12', '1998-04-19'].),\n  (amount <INTEGER>, the id number identifying the loan data. Value examples: [1567, 7877, 9988].),\n  (duration <INTEGER>, the id number identifying the loan data. Value examples: [60, 48, 24, 12, 36].),\n  (payments <INTEGER>, the id number identifying the loan data. Value examples: [3456, 8972, 9845].),\n  (status <TEXT>, the id number identifying the loan data. Value examples: ['C', 'A', 'D', 'B'].)\n]\n# Table: district\n[\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76].),\n  (A2 <REAL>, area in square kilometers. Value examples: [50.5, 48.9].),\n  (A4 <INTEGER>, number of inhabitants. Value examples: [95907, 95616].),\n  (A5 <INTEGER>, number of households. Value examples: [35678, 34892].),\n  (A6 <REAL>, literacy rate. Value examples: [95.6, 92.3, 89.7].),\n  (A7 <INTEGER>, number of entrepreneurs. Value examples: [1234, 1456].),\n  (A8 <INTEGERt>, number of cities. Value examples: [5, 4].),\n  (A9 <INTEGER>, number of schools. Value examples: [15, 12, 10].),\n  (A10 <INTEGER>, number of hospitals. Value examples: [8, 6, 4].),\n  (A11 <REAL>, average salary. Value examples: [12541.5, 11277].),\n  (A12 <REAL>, poverty rate. Value examples: [12.4, 9.8].),\n  (A13 <REAL>, unemployment rate. Value examples: [8.2, 7.9].),\n  (A15 <INTEGER>, number of crimes. Value examples: [256, 189].)\n]\n【Primary keys】\naccount.`account_id` | client.`client_id` | loan.`loan_id` | district.`district_id`\n【Foreign keys】\nclient.`district_id` = district.`district_id`\n【Question】\nWhat is the gender of the youngest client who opened account in the lowest average salary branch and when did this client open the account? Please list their full name.\n【Evidence】\nLater birthdate refers to younger age; A11 refers to average salary; Full name refers to first_name, last_name\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\nThe entities extracted from the 【Question】 are: \n1. gender; \n2. youngest client; \n3. account; \n4. lowest average salary branch; \n5. when did this client open the account; \n6. full name\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. gender --no related evidence **the columns about gender are related**\n2. youngest client  --Later birthdate refers to younger age; **the columns about birth date of client and the id of client are related**\n3. account --no related evidence **the columns about account or account ids are related**\n4. lowest average salary branch  --A11 refers to average salary **the columns about average salary and branch are related**\n5. when did this client open the account --no related evidence **the columns about time or date of the account are related**\n6. full name  --Full name refers to first_name, last_name **the columns about first_name, last_name of the client are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"gender\": [\"client.gender\",\"client.client_id\",\"loan.status\"],\n  \"youngest client\": [\"client.birth_date\",\"client.client_id\",\"account.date\",\"loan.date\"],\n  \"account\": [\"account.account_id\",\"loan.account_id\",\"account.date\"],\n  \"lowest average salary branch\": [\"district.A11\",\"district.district_id\",\"district.A13\"],\n  \"when did this client open the account\": [\"account.date\",\"loan.date\",\"client.birth_date\"],\n  \"full name\": [\"client.first_name\",\"client.last_name\",\"client.client_id\"]\n}\n```\nQuestion Solved.\n\n==========\n\nHere is a new example, please start answering:\n\n【DB_ID】 california_schools\n【Schema】\n# Table: frpm\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (Academic Year <TEXT>,  Academic Year. Value examples: ['2014-2015'].),\n  (County Code <TEXT>,  County Code. Value examples: ['19', '37', '30', '36', '33', '43'].),\n  (District Code <INTEGER>,  District Code.),\n  (School Code <TEXT>,  School Code. Value examples: ['0000000', '9010745', '6121081', '6121073', '6121016', '6120968'].),\n  (County Name <TEXT>,  County Name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].),\n  (District Name <TEXT>,  District Name.),\n  (School Name <TEXT>,  School Name.),\n  (District Type <TEXT>,  District Type. Value examples: ['Unified School District', 'Elementary School District', 'High School District', 'County Office of Education (COE)', 'State Board of Education', 'Statewide Benefit Charter'].),\n  (School Type <TEXT>,  School Type. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].),\n  (Educational Option Type <TEXT>,  Educational Option Type. Value examples: [None, 'Traditional', 'Continuation School', 'Alternative School of Choice', 'Community Day School', 'Special Education School', 'County Community School'].),\n  (NSLP Provision Status <TEXT>,  NSLP Provision Status. Value examples: [None, 'Provision 2', 'Breakfast Provision 2', 'CEP', 'Multiple Provision Types', 'Provision 1', 'Lunch Provision 2'].),\n  (Charter School (Y/N) <INTEGER>,  Charter School (Y/N). Value examples: [None, 0, 1].),\n  (Charter School Number <TEXT>,  Charter School Number. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1700', '1696'].),\n  (Charter Funding Type <TEXT>,  Charter Funding Type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (IRC <INTEGER>,  IRC. Value examples: [None, 0, 1].),\n  (Low Grade <TEXT>,  Low Grade. Value examples: ['K', '9', '6', '7', 'P', '5'].),\n  (High Grade <TEXT>,  High Grade. Value examples: ['12', '5', '8', '6', '3', '4'].),\n  (Enrollment (K-12) <REAL>,  Enrollment (K-12).),\n  (Free Meal Count (K-12) <REAL>,  Free Meal Count (K-12).),\n  (Percent (%) Eligible Free (K-12) <REAL>,  Percent (%) Eligible Free (K-12).),\n  (FRPM Count (K-12) <REAL>,  Free or Reduced Price Meal Count (K-12).),\n  (Percent (%) Eligible FRPM (K-12) <REAL>,  Percent (%) Eligible FRPM (K-12).),\n  (Enrollment (Ages 5-17) <REAL>,  Enrollment (Ages 5-17).),\n  (Free Meal Count (Ages 5-17) <REAL>,  Free Meal Count (Ages 5-17).),\n  (Percent (%) Eligible Free (Ages 5-17) <REAL>,  Percent (%) Eligible Free (Ages 5-17).),\n  (FRPM Count (Ages 5-17) <REAL>,  FRPM Count (Ages 5-17).),\n  (Percent (%) Eligible FRPM (Ages 5-17) <REAL>,  Percent (%) Eligible FRPM (Ages 5-17).),\n  (2013-14 CALPADS Fall 1 Certification Status <INTEGER>,  2013-14 CALPADS Fall 1 Certification Status. Value examples: [1].)\n]\n# Table: satscores\n[\n  (cds <TEXT>,  California Department Schools.),\n  (rtype <TEXT>,  rtype. Value examples: ['S', 'D'].),\n  (sname <TEXT>,  school name. Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].),\n  (dname <TEXT>,  district segment. Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].),\n  (cname <TEXT>,  county name. Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].),\n  (enroll12 <INTEGER>,  enrollment (1st-12nd grade).),\n  (NumTstTakr <INTEGER>,  Number of Test Takers in this school.),\n  (AvgScrRead <INTEGER>,  average scores in Reading.),\n  (AvgScrMath <INTEGER>,  average scores in Math.),\n  (AvgScrWrite <INTEGER>,  average scores in writing.),\n  (NumGE1500 <INTEGER>,  Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500.)\n]\n# Table: schools\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (NCESDist <TEXT>,  This field represents the 7-digit National Center for Educational Statistics (NCES) school district identification number. The first 2 digits identify the state and the last 5 digits identify the school district. Combined, they make a unique 7-digit ID for each school district.. Value examples: [None, '0622710', '0634320', '0628050', '0634410', '0614550', '0633840'].),\n  (NCESSchool <TEXT>,  This field represents the 5-digit NCES school identification number. The NCESSchool combined with the NCESDist form a unique 12-digit ID for each school.. Value examples: [None, '12271', '13785', '13747', '12909', '12311', '12003'].),\n  (StatusType <TEXT>,  This field identifies the status of the district.. Value examples: ['Active', 'Closed', 'Merged', 'Pending'].),\n  (County <TEXT>,  County name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].),\n  (District <TEXT>,  District.),\n  (School <TEXT>,  School.),\n  (Street <TEXT>,  Street.),\n  (StreetAbr <TEXT>,  The abbreviated street address of the school, district, or administrative authority’s physical location..),\n  (City <TEXT>,  City. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].),\n  (Zip <TEXT>,  Zip. Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].),\n  (State <TEXT>,  State. Value examples: [None, 'CA'].),\n  (MailStreet <TEXT>,  MailStreet.),\n  (MailStrAbr <TEXT>,  mailing street address.),\n  (MailCity <TEXT>,  mailing city. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].),\n  (MailZip <TEXT>,  mailing zip. Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].),\n  (MailState <TEXT>,  mailing state. Value examples: [None, 'CA'].),\n  (Phone <TEXT>,  Phone. Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].),\n  (Ext <TEXT>,  The phone number extension of the school, district, or administrative authority.. Value examples: [None, '200', '201', '111', '352', '221', '203'].),\n  (Website <TEXT>,  The website address of the school, district, or administrative authority..),\n  (OpenDate <DATE>,  The date the school opened.. Value examples: [None, '1980-07-01'].),\n  (ClosedDate <DATE>,  The date the school closed.. Value examples: [None, '1989-06-30'].),\n  (Charter <INTEGER>,  This field identifies a charter school.. Value examples: [None, 0, 1].),\n  (CharterNum <TEXT>,  The charter school number,. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1826', '1710'].),\n  (FundingType <TEXT>,  Indicates the charter school funding type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (DOC <TEXT>,  District Ownership Code. Value examples: ['54', '52', '00', '56', '98', '02'].),\n  (DOCType <TEXT>,  The District Ownership Code Type is the text description of the DOC category.. Value examples: ['Unified School District', 'Elementary School District', 'County Office of Education (COE)', 'High School District', 'Regional Occupation Center/Program (ROC/P)', 'State Board of Education'].),\n  (SOC <TEXT>,  The School Ownership Code is a numeric code used to identify the type of school.. Value examples: [None, '60', '66', '62', '68', '09', '69'].),\n  (SOCType <TEXT>,  The School Ownership Code Type is the text description of the type of school.. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Special Education Schools (Public)', 'District Community Day Schools'].),\n  (EdOpsCode <TEXT>,  The Education Option Code is a short text description of the type of education offered.. Value examples: [None, 'TRAD', 'CON', 'COMMDAY', 'ALTSOC', 'SPEC', 'COMM'].),\n  (EdOpsName <TEXT>,  Educational Option Name. Value examples: [None, 'Traditional', 'Continuation School', 'Community Day School', 'Alternative School of Choice', 'Special Education School', 'County Community School'].),\n  (EILCode <TEXT>,  The Educational Instruction Level Code is a short text description of the institution's type relative to the grade range served.. Value examples: [None, 'ELEM', 'HS', 'UG', 'INTMIDJR', 'ELEMHIGH', 'A'].),\n  (EILName <TEXT>,  The Educational Instruction Level Name is the long text description of the institution’s type relative to the grade range served.. Value examples: [None, 'Elementary', 'High School', 'Ungraded', 'Intermediate/Middle/Junior High', 'Elementary-High Combination', 'Adult'].),\n  (GSoffered <TEXT>,  The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.. Value examples: [None, 'K-5', '9-12', 'K-6', 'K-8', '6-8', 'K-12'].),\n  (GSserved <TEXT>,  It is the lowest grade and the highest grade of student enrollment as reported in the most recent certified CALPADS Fall 1 data collection. Only K–12 enrollment is reported through CALPADS. This field may differ from the grade span offered.. Value examples: [None, 'K-5', 'K-6', '9-12', 'K-8', '6-8', '7-8'].),\n  (Virtual <TEXT>,  This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.. Value examples: [None, 'N', 'P', 'F'].),\n  (Magnet <INTEGER>,  This field identifies whether a school is a magnet school and/or provides a magnet program.. Value examples: [None, 0, 1].),\n  (Latitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the equator measured north to south..),\n  (Longitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the prime meridian (Greenwich, England) measured from west to east..),\n  (AdmFName1 <TEXT>,  administrator's first name 1. Value examples: [None, 'David', 'Michael', 'John', 'Jennifer', 'Lisa', 'Robert'].),\n  (AdmLName1 <TEXT>,  administrator's last name 1.),\n  (AdmEmail1 <TEXT>,  administrator's email address 1.),\n  (AdmFName2 <TEXT>,  administrator's first name 2. Value examples: [None, 'Steve', 'Delphine', 'Tim', 'Michael', 'Lisa', 'Jeff'].),\n  (AdmLName2 <TEXT>,  administrator's last name 2. Value examples: [None, 'Sherman', 'Jones', 'Wilson', 'Petersen', 'Landry', 'Hambright'].),\n  (AdmEmail2 <TEXT>,  administrator's email address 2.),\n  (AdmFName3 <TEXT>,  administrator's first name 3. Value examples: [None, 'Mark', 'Eric', 'Vickie', 'Tracie', 'Shawn', 'Sarah'].),\n  (AdmLName3 <TEXT>,  administrator's last name 3. Value examples: [None, 'Zerpoli', 'Yount', 'Woodruff', 'Wood', 'Wolk', 'Spotts'].),\n  (AdmEmail3 <TEXT>,  administrator's email address 3.),\n  (LastUpdate <DATE>,  Last Update. Value examples: ['2015-06-18'].)\n]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Question】\nPlease list the zip code of all the charter schools in Fresno County Office of Education.\n【Evidence】\nCharter schools refers to `Charter School (Y/N)` = 1 in the table fprm\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\n", "prompt_token": 5133, "response_token": 219, "cur_total_prompt_tokens": 29072, "cur_total_response_tokens": 2545}
{"idx": 2, "db_id": "california_schools", "query": "Please list the zip code of all the charter schools in Fresno County Office of Education.", "evidence": "Charter schools refers to `Charter School (Y/N)` = 1 in the table fprm", "difficulty": "simple", "ground_truth": "SELECT T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`District Name` = 'Fresno County Office of Education' AND T1.`Charter School (Y/N)` = 1", "send_to": "Decomposer", "response": "\nTargets: List the zip code of all the charter schools\nConditions:\n1. in Fresno County Office of Education --Condition_1\n2. Charter schools refers to `Charter School (Y/N)` = 1 --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the zip code of all the charter schools in Fresno County Office of Education\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the zip code of all the charter schools in Fresno County Office of Education where Charter School (Y/N) = 1\n", "input_prompt": "[Instruction]\nGiven a 【query】, you need to understanding the intent of Query, and then deceompose it into Targets and Conditions. Then you need to combine Targets and Conditions into Subquerys step by step. \nFor the case where Conditions is NULL, consider Targets as the final Subquery directly. \nFor the case where Conditions are not NULL, combine Targets and the first Condition to get the first Subquery, then combine this Subquery and the next Condition into a new Subquery until all Conditions are used (which means the content of the last Subquery and the original Query is the same).\n\n[Requirements]\n-Try not to overlap Targets and Conditions.\n-Make sure the decomposed Target and Condition can cover all of the information in Query.\n-Don't change any information (specific value) in Query!\n-Mark each Subquery with ## in front of it.\n\nHere are some examples:\n==========\n\n【Query】\nShow the stadium name and the number of concerts in each stadium. Please also list the year the stadium was built. \n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the stadium name, the year the stadium built and the number of concerts in each stadium\nConditions: NULL\n\nSubqueries:\n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the stadium name, the year the stadium built and the number of concerts in each stadium\n==========\n\n【Query】\nWhat is the qualification rate for the H-11 products produced in 2023/11/2?\n【Evidence】\nqualification rate = `Numqualified(H-11)` / `production(H-11)`\n\n【Decomposition】\nTargets: List the qualification rate for the H-11 Products\nConditions:\n1. produced in 2023/11/2 --Condition_1\n\nSubqueries:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the qualification rate for the H-11 Products produced in 2023/11/2\n\n==========\n\n【Query】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n\n【Decomposition】\nTargets: List the race of institutions\nConditions: \n1. in Alabama --Condition_1\n2. number of students greater than the 90% of average number of students of all institutions --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the race of institution in Alabama\n2. Conbine the first Subquery and Conditon_2 to get the seconed Subquery.\n##Subquery: List the race of institutions in Alabama with number of number of students greater than the 90% of average number of students of all institutions\n\n==========\n\n【Query】\nWhich president got a higher approval rating, Joseph Biden or Donald Trump?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\nConditions: \nNULL\n\nSubqueries: \n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\n\n==========\n\n【Query】\nFor movie id 1269, how many users, who was a paying subscriber and was eligible for trial when he rated the movie, gave the movie a rating score of less than or equal to 2?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the number of users\nConditions:\n1. was a paying subscriber --Condition_1\n2. was eligible for trial --Condition_2\n3. for movie id 1269, gave the movie a rating score of less than or equal to 2 --Condition3\n\nSubquerys:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the number of users who was a paying subscriber\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial\n3. Combine the second Subquery and Condition_3 to get the third Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial and gave the movie whose id is 1269 a rating score of less than or equal to 2\n\n==========\n\nHere is a new query need to be decomposed:\n\n【Query】\nPlease list the zip code of all the charter schools in Fresno County Office of Education.\n【Evidence】\nCharter schools refers to `Charter School (Y/N)` = 1 in the table fprm\n\n【Decomposition】\n", "prompt_token": 1051, "response_token": 134, "cur_total_prompt_tokens": 30123, "cur_total_response_tokens": 2679}
{"idx": 2, "db_id": "california_schools", "query": "Please list the zip code of all the charter schools in Fresno County Office of Education.", "evidence": "Charter schools refers to `Charter School (Y/N)` = 1 in the table fprm", "difficulty": "simple", "ground_truth": "SELECT T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`District Name` = 'Fresno County Office of Education' AND T1.`Charter School (Y/N)` = 1", "send_to": "Generator", "response": "\nTo answer the question \"List the zip code of all the charter schools in Fresno County Office of Education,\" we need to follow these steps:\n\n1. **Identify the relevant columns**: \n   - We need the zip code, which is in the `schools` table (`Zip`).\n   - We also need to identify charter schools, which is indicated by the column `Charter School (Y/N)` in the `frpm` table.\n\n2. **Determine the connection between tables**: \n   - The `frpm` table and the `schools` table are connected through the `CDSCode` column, which is a foreign key.\n\n3. **Filter for charter schools and the specific county**: \n   - We need to filter for charter schools where `Charter School (Y/N)` = 1.\n   - We also need to filter for schools in Fresno County, which we will assume is represented by the `County Name` in the `frpm` table.\n\n4. **Construct the SQL query**: \n   - We will join the `frpm` and `schools` tables on `CDSCode`.\n   - We will apply the necessary filters in the `WHERE` clause.\n\nHere is the SQL query that meets these requirements:\n\n```sql\nSELECT DISTINCT S.`Zip`\n  FROM frpm AS F\n  JOIN schools AS S\n  ON F.`CDSCode` = S.`CDSCode`\n  WHERE F.`Charter School (Y/N)` = 1 \n    AND F.`County Name` = 'Fresno County Office of Education'\n```\n\n### Explanation of the SQL:\n- `SELECT DISTINCT S.`Zip``: This selects the unique zip codes from the `schools` table.\n- `FROM frpm AS F JOIN schools AS S ON F.`CDSCode` = S.`CDSCode``: This joins the `frpm` table with the `schools` table based on the `CDSCode`.\n- `WHERE F.`Charter School (Y/N)` = 1`: This filters the results to include only charter schools.\n- `AND F.`County Name` = 'Fresno County Office of Education'`: This further filters the results to include only those schools in the specified county.\n\nThis query will return the zip codes of all charter schools in the Fresno County Office of Education.\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】and a 【Question】, you need to use valid SQLite and understand the database and knowledge so that you can generate a good SQL for the 【Question】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# stadium: [Stadium_ID (INTEGER), Location (TEXT), Name (TEXT)]\n# concert: [concert_ID (INTEGER), concert_Name (TEXT), Stadium_ID (INTEGER)]\n【Primary keys】\nstadium.`Stadium_ID` | concert.`concert_ID`\n【Foreign keys】\nconcert.`Stadium_ID` = stadium.`Stadium_ID`\n【Detailed descriptions of tables and columns】\nstadium.`Stadium_ID`: The column 'Stadium_ID' in Table <stadium> has column descriptions of \"stadium id\". Value examples: [1, 2, 3, 4, 5, 6].\nstadium.`Name`:  The column 'Name' in Table <stadium> has column descriptions of \"name of stadium\". Value examples: [\"Stark's Park\", 'Somerset Park', 'Recreation Park', 'Hampden Park', 'Glebe Park', 'Gayfield Park'].\nstadium.`Location`: The column 'Location' in Table <stadium> has column descriptions of \"location of stadium\". Value examples: ['Stirling Albion', 'Raith Rovers', \"Queen's Park\", 'Peterhead', 'East Fife', 'Brechin City'].\nconcert.`concert_ID`: The column 'concert_ID' in Table <concert> has column descriptions of \"concert id\". Value examples: [1, 2, 3, 4, 5, 6].\nconcert.`concert_Name`: The column 'concert_Name' in Table <concert> has column descriptions of \"concert name\". Value examples: ['Week 1', 'Week 2', 'Super bootcamp', 'Home Visits', 'Auditions'].\nconcert.`Stadium_ID`: The column 'Stadium_ID' in Table <concert> has column descriptions of \"stadium id\". Value examples: [2, 9, 7, 10, 1].\n【Evidence】\nNULL\n【Question】\nShow the stadium name and the number of concerts in each stadium.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: Show the stadium name and the number of concerts in each stadium.\nTargets for `SELECT`: the stadium name and the number of concerts\nhints from 【Evidence】:NULL\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the stadium name refers to stadium.`Name`, the number of concerts refers to COUNT(concert.`concert_ID`), each stadium refers to stadium.`Stadium_ID`\nConnection of tables: include tables <stadium> and <concert>, get connected keys from 【Foreign keys】: concert.`Stadium_ID` = stadium.`Stadium_ID`\nFinal SQL:\n```sql\nSELECT T1.`Name`, COUNT(T2.concert_ID) AS num_concerts\n  FROM stadium AS T1\n  JOIN concert AS T2\n  ON T1.`Stadium_ID` = T2.`Stadium_ID`\n  GROUP BY T1.`Stadium_ID`\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); name of the car refers to car_name\n【Question】\nWhat is the fastest car made by Japan?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ncountry.`country` = 'Japan'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: What is the fastest car made by Japan?\nTargets for `SELECT`: the name of the fastest car\nhints from 【Evidence】: the fastest refers to max(horsepower); name of the car refers to car_name\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: car refers to data.`car_name`, the fastest refers to MAX(data.`horsepower`), Japan refers to country.`country`\nConnection of tables: includes tables <data> and <country>, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`car_name` \n  FROM data AS T1 \n  INNER JOIN production AS T2 \n  ON T1.`ID` = T2.`ID` \n  INNER JOIN country AS T3 \n  ON T3.`origin` = T2.`country` \n  WHERE T3.`country` = 'Japan' \n  ORDER BY T1.`horsepower` DESC LIMIT 1\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`chronname`: The column 'chronname' in Table <institution_details> has column descriptions of \"Institution name\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \n【Evidence】\nnumber of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the chronname of institutions with number of students greater than the 90% of average number of students of all institutions?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: List the chroname of institutions with number of students greater than the 90% of average number of students of all institutions?\nTargets for `SELECT`: the chroname of institutions\nhints from 【Evidence】: number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the chronname of institutions refers to institution_details.`chronname`, number of students refers to institution_details.`student_count`\nConnection of tables: include only one table <institution_details>, no connection\nFinal SQL:\n```sql\nSELECT DISTINCT `chroname`\n  FROM institution_details\n  WHERE `student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details\n  ) \n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\nfrpm.`CDSCode`: The column 'CDSCode' in Table <frpm> has column descriptions of \"CDSCode\". \nfrpm.`County Code`: The column 'County Code' in Table <frpm> has column descriptions of \"County Code\".  Value examples: ['19', '37', '30', '36', '33', '43'].\nfrpm.`County Name`: The column 'County Name' in Table <frpm> has column descriptions of \"County Name\".  Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].\nfrpm.`District Name`: The column 'District Name' in Table <frpm> has column descriptions of \"District Name\". \nfrpm.`Charter School (Y/N)`: The column 'Charter School (Y/N)' in Table <frpm> has column descriptions of \"Charter School (Y/N)\".  Value examples: [None, 0, 1].\nschools.`CDSCode`: The column 'CDSCode' in Table <schools> has column descriptions of \"CDSCode\". \nschools.`County`: The column 'County' in Table <schools> has column descriptions of \"County name\".  Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].\nschools.`Zip`: The column 'Zip' in Table <schools> has column descriptions of \"Zip\".  Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].\n\n【Evidence】\nCharter schools refers to `Charter School (Y/N)` = 1 in the table fprm\n【Question】\nList the zip code of all the charter schools in Fresno County Office of Education\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n", "prompt_token": 3608, "response_token": 481, "cur_total_prompt_tokens": 33731, "cur_total_response_tokens": 3160}
{"idx": 2, "db_id": "california_schools", "query": "Please list the zip code of all the charter schools in Fresno County Office of Education.", "evidence": "Charter schools refers to `Charter School (Y/N)` = 1 in the table fprm", "difficulty": "simple", "ground_truth": "SELECT T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`District Name` = 'Fresno County Office of Education' AND T1.`Charter School (Y/N)` = 1", "send_to": "Refiner", "response": "\nAnalysis:\nThe original SQL query attempts to join the `frpm` and `schools` tables to retrieve the zip codes of charter schools in the \"Fresno County Office of Education\". However, the `County Name` in the `frpm` table does not match the expected value. The correct value for Fresno County should be 'Fresno', not 'Fresno County Office of Education'. Additionally, the `County Code` should be checked to ensure it corresponds to Fresno County, which is typically '19'. \n\nCorrect SQL:\n```sql\nSELECT DISTINCT S.`Zip` \nFROM frpm AS F \nJOIN schools AS S ON F.`CDSCode` = S.`CDSCode` \nWHERE F.`Charter School (Y/N)` = 1 AND F.`County Code` = '19'\n```\n\n【Evidence】\nThe query now correctly filters for charter schools in Fresno County by using the appropriate `County Code`. The `Charter School (Y/N)` column is also correctly checked for value 1, indicating that the school is a charter school.\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nCharter schools refers to `Charter School (Y/N)` = 1 in the table fprm\n【Query】\n-- List the zip code of all the charter schools in Fresno County Office of Education\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\nfrpm.`CDSCode`: The column 'CDSCode' in Table <frpm> has column descriptions of \"CDSCode\". \nfrpm.`County Code`: The column 'County Code' in Table <frpm> has column descriptions of \"County Code\".  Value examples: ['19', '37', '30', '36', '33', '43'].\nfrpm.`County Name`: The column 'County Name' in Table <frpm> has column descriptions of \"County Name\".  Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].\nfrpm.`District Name`: The column 'District Name' in Table <frpm> has column descriptions of \"District Name\". \nfrpm.`Charter School (Y/N)`: The column 'Charter School (Y/N)' in Table <frpm> has column descriptions of \"Charter School (Y/N)\".  Value examples: [None, 0, 1].\nschools.`CDSCode`: The column 'CDSCode' in Table <schools> has column descriptions of \"CDSCode\". \nschools.`County`: The column 'County' in Table <schools> has column descriptions of \"County name\".  Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].\nschools.`Zip`: The column 'Zip' in Table <schools> has column descriptions of \"Zip\".  Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].\n\n【old SQL】\n```sql\nSELECT DISTINCT S.`Zip` FROM frpm AS F JOIN schools AS S ON F.`CDSCode` = S.`CDSCode` WHERE F.`Charter School (Y/N)` = 1 AND F.`County Name` = 'Fresno County Office of Education' \n```\n【SQLite error】 \nno data selected\n【Exception class】\n\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 1459, "response_token": 221, "cur_total_prompt_tokens": 35190, "cur_total_response_tokens": 3381}
{"idx": 2, "db_id": "california_schools", "query": "Please list the zip code of all the charter schools in Fresno County Office of Education.", "evidence": "Charter schools refers to `Charter School (Y/N)` = 1 in the table fprm", "difficulty": "simple", "ground_truth": "SELECT T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`District Name` = 'Fresno County Office of Education' AND T1.`Charter School (Y/N)` = 1", "send_to": "Generator", "response": "\nTo generate the final SQL query for the question about listing the zip codes of all charter schools in Fresno County Office of Education, we need to consider the provided sub-SQL and the relevant constraints.\n\n### Analyzing the Sub-SQL\nThe provided Sub-SQL is:\n```sql\nSELECT DISTINCT S.`Zip` \nFROM frpm AS F \nJOIN schools AS S ON F.`CDSCode` = S.`CDSCode` \nWHERE F.`Charter School (Y/N)` = 1 \nAND F.`County Code` = '19'\n```\n\n### Understanding the Components\n1. **Charter Schools**: The condition `F.`Charter School (Y/N)` = 1` indicates that we are filtering for charter schools.\n2. **Fresno County Office of Education**: The `County Code` for Fresno County is '19', which is already included in the Sub-SQL.\n3. **Zip Code**: We are selecting the `Zip` column from the `schools` table.\n\n### Final SQL Query\nSince the Sub-SQL already includes the necessary conditions to filter for charter schools in Fresno County, we can use it directly as our final SQL query without any modifications. \n\n### Final SQL\n```sql\nSELECT DISTINCT S.`Zip` \nFROM frpm AS F \nJOIN schools AS S ON F.`CDSCode` = S.`CDSCode` \nWHERE F.`Charter School (Y/N)` = 1 \nAND F.`County Code` = '19'\n```\n\nThis SQL query effectively retrieves the distinct zip codes of all charter schools located in Fresno County, adhering to the constraints and requirements outlined in the question.\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】, a 【Question】, a 【Subquesion】 extracted from 【Question】 and a 【Sub-SQL】 for the 【Subquestion】, you need to use valid SQLite and understand the database and knowledge, and then generate a complete SQL for the 【Question】 based on 【Sub-SQL】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); made by Japan refers to country = 'Japan'\n【Question】\nWhat is the price of the fastest car made by Japan?\n【Subquestion】\nWhat is the price of the fastest car?\n【Sub-SQL】\n```\nSELECT T1.`price` FROM price AS T1 INNER JOIN data AS T2 ON T2.`ID` = T1.`ID` ORDER BY T2.`horsepower` DESC LIMIT 1\n```\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\n【Subquestion】 is decomposed from 【Question】, now we provide Sub-SQL corresponding to Subquestion, you just need to complete the remaining conditions based on Sub-SQL to generate SQL for 【Question】. Consider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, and then generate SQL after thinking step by step:\nhints from 【Evidence】: the fastest refers to max(horsepower); made by Japan refers to country = 'Japan';\nFind necessary columns from 【Database schema】 in addition to Sub-SQL: Japan refers to country.`country`\nConnection of tables: the connection of <data> and <country> is needed, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`price` \n  FROM price AS T1 \n  INNER JOIN data AS T2\n  on T2.`ID` = T1.`ID`\n  INNER JOIN production AS T3 \n  ON T3.`ID` = T2.`ID` \n  INNER JOIN country AS T4 \n  ON T4.`origin` = T3.`country` \n  WHERE T4.`country` = 'Japan' \n  ORDER BY T2.`horsepower` DESC LIMIT 1\n```\n\nQuestion solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`state`: The column 'state' in Table <institution_details> has column descriptions of \"Institution state\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \ninstitution_grads.`race`: The column 'race' in Table <institution_grads> has column descriptions of \"race/ethnicity of students\". Value examples: ['X', 'Ai', 'A', 'B', 'H'].\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Subquestion】\nList the race of institutions in 'Alabama'. \n【Sub-SQL】\n```\nSELECT DISTINCT T1.`race` FROM institution_grads AS T1 INNER JOIN institution_details AS T2 ON T1.`unitid` = T2.`unitid` WHERE T2.`state` = 'Alabama'\n```\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ninstitution_details.`city` = 'Alabama'; institution_details.`state` = 'Alabama'\n\n【Subquestion】 is decomposed from 【Question】, now we provide Sub-SQL corresponding to Subquestion, you just need to complete the remaining conditions based on Sub-SQL to generate SQL for 【Question】. Consider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, and then generate SQL after thinking step by step:\nhints from 【Evidence】: Alabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFind necessary columns from 【Database schema】 in addition to Sub-SQL: number of students refers to institution_details.`student_count`\nConnection of tables: the table <institution_details> is already in Sub-SQL, no more connection is needed\nFinal SQL:\n```sql\nSELECT DISTINCT T1.`race` \n  FROM institution_grads AS T1 \n  INNER JOIN institution_details AS T2 \n  ON T1.`unitid` = T2.`unitid` \n  WHERE T2.`student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details \n  ) \n  AND T2.`state` = 'Alabama'\n```\n\nQuestion solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\nfrpm.`CDSCode`: The column 'CDSCode' in Table <frpm> has column descriptions of \"CDSCode\". \nfrpm.`County Code`: The column 'County Code' in Table <frpm> has column descriptions of \"County Code\".  Value examples: ['19', '37', '30', '36', '33', '43'].\nfrpm.`County Name`: The column 'County Name' in Table <frpm> has column descriptions of \"County Name\".  Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].\nfrpm.`District Name`: The column 'District Name' in Table <frpm> has column descriptions of \"District Name\". \nfrpm.`Charter School (Y/N)`: The column 'Charter School (Y/N)' in Table <frpm> has column descriptions of \"Charter School (Y/N)\".  Value examples: [None, 0, 1].\nschools.`CDSCode`: The column 'CDSCode' in Table <schools> has column descriptions of \"CDSCode\". \nschools.`County`: The column 'County' in Table <schools> has column descriptions of \"County name\".  Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].\nschools.`Zip`: The column 'Zip' in Table <schools> has column descriptions of \"Zip\".  Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].\n\n【Evidence】\nCharter schools refers to `Charter School (Y/N)` = 1 in the table fprm\n【Question】\nPlease list the zip code of all the charter schools in Fresno County Office of Education.\n【Subquestion】\nList the zip code of all the charter schools in Fresno County Office of Education\n【Sub-SQL】\nSELECT DISTINCT S.`Zip` FROM frpm AS F JOIN schools AS S ON F.`CDSCode` = S.`CDSCode` WHERE F.`Charter School (Y/N)` = 1 AND F.`County Code` = '19' \n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\n【Subquestion】 is decomposed from 【Question】, now we provide Sub-SQL corresponding to Subquestion, you just need to complete the remaining conditions based on Sub-SQL to generate SQL for 【Question】. Consider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, and then generate SQL after thinking step by step:\n", "prompt_token": 3259, "response_token": 340, "cur_total_prompt_tokens": 38449, "cur_total_response_tokens": 3721}
{"idx": 3, "db_id": "california_schools", "query": "What is the unabbreviated mailing address of the school with the highest FRPM count for K-12 students?", "evidence": "", "difficulty": "simple", "ground_truth": "SELECT T2.MailStreet FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 1", "send_to": "Soft_Schema_Linker", "response": "\nThe entities extracted from the 【Question】 are: \n1. unabbreviated mailing address\n2. school\n3. highest FRPM count\n4. K-12 students\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. unabbreviated mailing address --no related evidence **the columns about mailing address are related**\n2. school --no related evidence **the columns about school are related**\n3. highest FRPM count --no related evidence **the columns about FRPM count are related**\n4. K-12 students --no related evidence **the columns about K-12 enrollment are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"unabbreviated mailing address\": [\"schools.MailStreet\",\"schools.MailCity\",\"schools.MailZip\"],\n  \"school\": [\"schools.School\",\"schools.CDSCode\",\"schools.District\"],\n  \"highest FRPM count\": [\"frpm.FRPM Count (K-12)\",\"frpm.CDSCode\",\"frpm.Enrollment (K-12)\"],\n  \"K-12 students\": [\"frpm.Enrollment (K-12)\",\"frpm.Free Meal Count (K-12)\",\"frpm.Percent (%) Eligible Free (K-12)\"]\n}\n```\nQuestion Solved.\n", "input_prompt": "As an experienced and professional database administrator, your task is to analyze a user question and a database schema to provide relevant information. The database schema consists of table descriptions, each containing multiple column descriptions. Your goal is to extract the entities from question and identify the relevant tables and columns based on these entities and the evidence provided.\n\n[Instruction]:\n1. Extract the mentioned entities from the user question. Make sure all of the entities are extracted. \n2. For each entity, keep at least 3 related columns.\n4. Your output should include entity extraction, analysis and related database schema.\n5. The related database schema should be in JSON format.\n6. Each column's information in provided 【Schema】 is in this format: (column, description. Value examples<optional>)\n\n[Requirements]:\n1. Sort the related columns in each list corresponding to each entity in descending order of relevance.\n2. The chosen columns should be in this format: <table.column>.\n3. Make sure each chosen list is not empty. The value [] will be punished. \n4.【Matched values】 may contain redundant or useless information in addition to the correct matching values, so you need to select the useful information in conjunction with the specific column names and descriptions.\n5. An entity may not have a corresponding evidence, which requires you to find the relevant columns yourself through your understanding of the database schema.\n\nHere is a typical example:\n\n==========\n【DB_ID】 banking_system\n【Schema】\n# Table: account\n[\n  (account_id <INTEGER>, the id of the account. Value examples: [11382, 11362, 2, 1, 2367].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (frequency <TEXT>, frequency of the acount. Value examples: ['POPLATEK MESICNE', 'POPLATEK TYDNE', 'POPLATEK PO OBRATU'].),\n  (date <DATE>, the creation date of the account. Value examples: ['1997-12-29', '1997-12-28'].)\n]\n# Table: client\n[\n  (client_id <INTEGER>, the unique number. Value examples: [13998, 13971, 2, 1, 2839].),\n  (gender <TEXT>, gender. Value examples: ['M', 'F']. And F：female . M：male ),\n  (birth_date <DATE>, birth date. Value examples: ['1987-09-27', '1986-08-13'].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (first_name <TEXT>, first_name.),\n  (last_name <TEXT>, last_name.)\n]\n# Table: loan\n[\n  (loan_id <INTEGER>, the id number identifying the loan data. Value examples: [4959, 4960, 4961].),\n  (account_id <INTEGER>, the id number identifying the account. Value examples: [10, 80, 55, 43].),\n  (date <DATE>, the date when the loan is approved. Value examples: ['1998-07-12', '1998-04-19'].),\n  (amount <INTEGER>, the id number identifying the loan data. Value examples: [1567, 7877, 9988].),\n  (duration <INTEGER>, the id number identifying the loan data. Value examples: [60, 48, 24, 12, 36].),\n  (payments <INTEGER>, the id number identifying the loan data. Value examples: [3456, 8972, 9845].),\n  (status <TEXT>, the id number identifying the loan data. Value examples: ['C', 'A', 'D', 'B'].)\n]\n# Table: district\n[\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76].),\n  (A2 <REAL>, area in square kilometers. Value examples: [50.5, 48.9].),\n  (A4 <INTEGER>, number of inhabitants. Value examples: [95907, 95616].),\n  (A5 <INTEGER>, number of households. Value examples: [35678, 34892].),\n  (A6 <REAL>, literacy rate. Value examples: [95.6, 92.3, 89.7].),\n  (A7 <INTEGER>, number of entrepreneurs. Value examples: [1234, 1456].),\n  (A8 <INTEGERt>, number of cities. Value examples: [5, 4].),\n  (A9 <INTEGER>, number of schools. Value examples: [15, 12, 10].),\n  (A10 <INTEGER>, number of hospitals. Value examples: [8, 6, 4].),\n  (A11 <REAL>, average salary. Value examples: [12541.5, 11277].),\n  (A12 <REAL>, poverty rate. Value examples: [12.4, 9.8].),\n  (A13 <REAL>, unemployment rate. Value examples: [8.2, 7.9].),\n  (A15 <INTEGER>, number of crimes. Value examples: [256, 189].)\n]\n【Primary keys】\naccount.`account_id` | client.`client_id` | loan.`loan_id` | district.`district_id`\n【Foreign keys】\nclient.`district_id` = district.`district_id`\n【Question】\nWhat is the gender of the youngest client who opened account in the lowest average salary branch and when did this client open the account? Please list their full name.\n【Evidence】\nLater birthdate refers to younger age; A11 refers to average salary; Full name refers to first_name, last_name\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\nThe entities extracted from the 【Question】 are: \n1. gender; \n2. youngest client; \n3. account; \n4. lowest average salary branch; \n5. when did this client open the account; \n6. full name\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. gender --no related evidence **the columns about gender are related**\n2. youngest client  --Later birthdate refers to younger age; **the columns about birth date of client and the id of client are related**\n3. account --no related evidence **the columns about account or account ids are related**\n4. lowest average salary branch  --A11 refers to average salary **the columns about average salary and branch are related**\n5. when did this client open the account --no related evidence **the columns about time or date of the account are related**\n6. full name  --Full name refers to first_name, last_name **the columns about first_name, last_name of the client are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"gender\": [\"client.gender\",\"client.client_id\",\"loan.status\"],\n  \"youngest client\": [\"client.birth_date\",\"client.client_id\",\"account.date\",\"loan.date\"],\n  \"account\": [\"account.account_id\",\"loan.account_id\",\"account.date\"],\n  \"lowest average salary branch\": [\"district.A11\",\"district.district_id\",\"district.A13\"],\n  \"when did this client open the account\": [\"account.date\",\"loan.date\",\"client.birth_date\"],\n  \"full name\": [\"client.first_name\",\"client.last_name\",\"client.client_id\"]\n}\n```\nQuestion Solved.\n\n==========\n\nHere is a new example, please start answering:\n\n【DB_ID】 california_schools\n【Schema】\n# Table: frpm\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (Academic Year <TEXT>,  Academic Year. Value examples: ['2014-2015'].),\n  (County Code <TEXT>,  County Code. Value examples: ['19', '37', '30', '36', '33', '43'].),\n  (District Code <INTEGER>,  District Code.),\n  (School Code <TEXT>,  School Code. Value examples: ['0000000', '9010745', '6121081', '6121073', '6121016', '6120968'].),\n  (County Name <TEXT>,  County Name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].),\n  (District Name <TEXT>,  District Name.),\n  (School Name <TEXT>,  School Name.),\n  (District Type <TEXT>,  District Type. Value examples: ['Unified School District', 'Elementary School District', 'High School District', 'County Office of Education (COE)', 'State Board of Education', 'Statewide Benefit Charter'].),\n  (School Type <TEXT>,  School Type. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].),\n  (Educational Option Type <TEXT>,  Educational Option Type. Value examples: [None, 'Traditional', 'Continuation School', 'Alternative School of Choice', 'Community Day School', 'Special Education School', 'County Community School'].),\n  (NSLP Provision Status <TEXT>,  NSLP Provision Status. Value examples: [None, 'Provision 2', 'Breakfast Provision 2', 'CEP', 'Multiple Provision Types', 'Provision 1', 'Lunch Provision 2'].),\n  (Charter School (Y/N) <INTEGER>,  Charter School (Y/N). Value examples: [None, 0, 1].),\n  (Charter School Number <TEXT>,  Charter School Number. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1700', '1696'].),\n  (Charter Funding Type <TEXT>,  Charter Funding Type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (IRC <INTEGER>,  IRC. Value examples: [None, 0, 1].),\n  (Low Grade <TEXT>,  Low Grade. Value examples: ['K', '9', '6', '7', 'P', '5'].),\n  (High Grade <TEXT>,  High Grade. Value examples: ['12', '5', '8', '6', '3', '4'].),\n  (Enrollment (K-12) <REAL>,  Enrollment (K-12).),\n  (Free Meal Count (K-12) <REAL>,  Free Meal Count (K-12).),\n  (Percent (%) Eligible Free (K-12) <REAL>,  Percent (%) Eligible Free (K-12).),\n  (FRPM Count (K-12) <REAL>,  Free or Reduced Price Meal Count (K-12).),\n  (Percent (%) Eligible FRPM (K-12) <REAL>,  Percent (%) Eligible FRPM (K-12).),\n  (Enrollment (Ages 5-17) <REAL>,  Enrollment (Ages 5-17).),\n  (Free Meal Count (Ages 5-17) <REAL>,  Free Meal Count (Ages 5-17).),\n  (Percent (%) Eligible Free (Ages 5-17) <REAL>,  Percent (%) Eligible Free (Ages 5-17).),\n  (FRPM Count (Ages 5-17) <REAL>,  FRPM Count (Ages 5-17).),\n  (Percent (%) Eligible FRPM (Ages 5-17) <REAL>,  Percent (%) Eligible FRPM (Ages 5-17).),\n  (2013-14 CALPADS Fall 1 Certification Status <INTEGER>,  2013-14 CALPADS Fall 1 Certification Status. Value examples: [1].)\n]\n# Table: satscores\n[\n  (cds <TEXT>,  California Department Schools.),\n  (rtype <TEXT>,  rtype. Value examples: ['S', 'D'].),\n  (sname <TEXT>,  school name. Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].),\n  (dname <TEXT>,  district segment. Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].),\n  (cname <TEXT>,  county name. Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].),\n  (enroll12 <INTEGER>,  enrollment (1st-12nd grade).),\n  (NumTstTakr <INTEGER>,  Number of Test Takers in this school.),\n  (AvgScrRead <INTEGER>,  average scores in Reading.),\n  (AvgScrMath <INTEGER>,  average scores in Math.),\n  (AvgScrWrite <INTEGER>,  average scores in writing.),\n  (NumGE1500 <INTEGER>,  Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500.)\n]\n# Table: schools\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (NCESDist <TEXT>,  This field represents the 7-digit National Center for Educational Statistics (NCES) school district identification number. The first 2 digits identify the state and the last 5 digits identify the school district. Combined, they make a unique 7-digit ID for each school district.. Value examples: [None, '0622710', '0634320', '0628050', '0634410', '0614550', '0633840'].),\n  (NCESSchool <TEXT>,  This field represents the 5-digit NCES school identification number. The NCESSchool combined with the NCESDist form a unique 12-digit ID for each school.. Value examples: [None, '12271', '13785', '13747', '12909', '12311', '12003'].),\n  (StatusType <TEXT>,  This field identifies the status of the district.. Value examples: ['Active', 'Closed', 'Merged', 'Pending'].),\n  (County <TEXT>,  County name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].),\n  (District <TEXT>,  District.),\n  (School <TEXT>,  School.),\n  (Street <TEXT>,  Street.),\n  (StreetAbr <TEXT>,  The abbreviated street address of the school, district, or administrative authority’s physical location..),\n  (City <TEXT>,  City. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].),\n  (Zip <TEXT>,  Zip. Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].),\n  (State <TEXT>,  State. Value examples: [None, 'CA'].),\n  (MailStreet <TEXT>,  MailStreet.),\n  (MailStrAbr <TEXT>,  mailing street address.),\n  (MailCity <TEXT>,  mailing city. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].),\n  (MailZip <TEXT>,  mailing zip. Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].),\n  (MailState <TEXT>,  mailing state. Value examples: [None, 'CA'].),\n  (Phone <TEXT>,  Phone. Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].),\n  (Ext <TEXT>,  The phone number extension of the school, district, or administrative authority.. Value examples: [None, '200', '201', '111', '352', '221', '203'].),\n  (Website <TEXT>,  The website address of the school, district, or administrative authority..),\n  (OpenDate <DATE>,  The date the school opened.. Value examples: [None, '1980-07-01'].),\n  (ClosedDate <DATE>,  The date the school closed.. Value examples: [None, '1989-06-30'].),\n  (Charter <INTEGER>,  This field identifies a charter school.. Value examples: [None, 0, 1].),\n  (CharterNum <TEXT>,  The charter school number,. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1826', '1710'].),\n  (FundingType <TEXT>,  Indicates the charter school funding type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (DOC <TEXT>,  District Ownership Code. Value examples: ['54', '52', '00', '56', '98', '02'].),\n  (DOCType <TEXT>,  The District Ownership Code Type is the text description of the DOC category.. Value examples: ['Unified School District', 'Elementary School District', 'County Office of Education (COE)', 'High School District', 'Regional Occupation Center/Program (ROC/P)', 'State Board of Education'].),\n  (SOC <TEXT>,  The School Ownership Code is a numeric code used to identify the type of school.. Value examples: [None, '60', '66', '62', '68', '09', '69'].),\n  (SOCType <TEXT>,  The School Ownership Code Type is the text description of the type of school.. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Special Education Schools (Public)', 'District Community Day Schools'].),\n  (EdOpsCode <TEXT>,  The Education Option Code is a short text description of the type of education offered.. Value examples: [None, 'TRAD', 'CON', 'COMMDAY', 'ALTSOC', 'SPEC', 'COMM'].),\n  (EdOpsName <TEXT>,  Educational Option Name. Value examples: [None, 'Traditional', 'Continuation School', 'Community Day School', 'Alternative School of Choice', 'Special Education School', 'County Community School'].),\n  (EILCode <TEXT>,  The Educational Instruction Level Code is a short text description of the institution's type relative to the grade range served.. Value examples: [None, 'ELEM', 'HS', 'UG', 'INTMIDJR', 'ELEMHIGH', 'A'].),\n  (EILName <TEXT>,  The Educational Instruction Level Name is the long text description of the institution’s type relative to the grade range served.. Value examples: [None, 'Elementary', 'High School', 'Ungraded', 'Intermediate/Middle/Junior High', 'Elementary-High Combination', 'Adult'].),\n  (GSoffered <TEXT>,  The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.. Value examples: [None, 'K-5', '9-12', 'K-6', 'K-8', '6-8', 'K-12'].),\n  (GSserved <TEXT>,  It is the lowest grade and the highest grade of student enrollment as reported in the most recent certified CALPADS Fall 1 data collection. Only K–12 enrollment is reported through CALPADS. This field may differ from the grade span offered.. Value examples: [None, 'K-5', 'K-6', '9-12', 'K-8', '6-8', '7-8'].),\n  (Virtual <TEXT>,  This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.. Value examples: [None, 'N', 'P', 'F'].),\n  (Magnet <INTEGER>,  This field identifies whether a school is a magnet school and/or provides a magnet program.. Value examples: [None, 0, 1].),\n  (Latitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the equator measured north to south..),\n  (Longitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the prime meridian (Greenwich, England) measured from west to east..),\n  (AdmFName1 <TEXT>,  administrator's first name 1. Value examples: [None, 'David', 'Michael', 'John', 'Jennifer', 'Lisa', 'Robert'].),\n  (AdmLName1 <TEXT>,  administrator's last name 1.),\n  (AdmEmail1 <TEXT>,  administrator's email address 1.),\n  (AdmFName2 <TEXT>,  administrator's first name 2. Value examples: [None, 'Steve', 'Delphine', 'Tim', 'Michael', 'Lisa', 'Jeff'].),\n  (AdmLName2 <TEXT>,  administrator's last name 2. Value examples: [None, 'Sherman', 'Jones', 'Wilson', 'Petersen', 'Landry', 'Hambright'].),\n  (AdmEmail2 <TEXT>,  administrator's email address 2.),\n  (AdmFName3 <TEXT>,  administrator's first name 3. Value examples: [None, 'Mark', 'Eric', 'Vickie', 'Tracie', 'Shawn', 'Sarah'].),\n  (AdmLName3 <TEXT>,  administrator's last name 3. Value examples: [None, 'Zerpoli', 'Yount', 'Woodruff', 'Wood', 'Wolk', 'Spotts'].),\n  (AdmEmail3 <TEXT>,  administrator's email address 3.),\n  (LastUpdate <DATE>,  Last Update. Value examples: ['2015-06-18'].)\n]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Question】\nWhat is the unabbreviated mailing address of the school with the highest FRPM count for K-12 students?\n【Evidence】\n\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\n", "prompt_token": 5116, "response_token": 274, "cur_total_prompt_tokens": 43565, "cur_total_response_tokens": 3995}
{"idx": 3, "db_id": "california_schools", "query": "What is the unabbreviated mailing address of the school with the highest FRPM count for K-12 students?", "evidence": "", "difficulty": "simple", "ground_truth": "SELECT T2.MailStreet FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 1", "send_to": "Decomposer", "response": "\nTargets: List the unabbreviated mailing address of the school with the highest FRPM count for K-12 students\nConditions: \n1. with the highest FRPM count for K-12 students --Condition_1\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the unabbreviated mailing address of the school with the highest FRPM count for K-12 students\n", "input_prompt": "[Instruction]\nGiven a 【query】, you need to understanding the intent of Query, and then deceompose it into Targets and Conditions. Then you need to combine Targets and Conditions into Subquerys step by step. \nFor the case where Conditions is NULL, consider Targets as the final Subquery directly. \nFor the case where Conditions are not NULL, combine Targets and the first Condition to get the first Subquery, then combine this Subquery and the next Condition into a new Subquery until all Conditions are used (which means the content of the last Subquery and the original Query is the same).\n\n[Requirements]\n-Try not to overlap Targets and Conditions.\n-Make sure the decomposed Target and Condition can cover all of the information in Query.\n-Don't change any information (specific value) in Query!\n-Mark each Subquery with ## in front of it.\n\nHere are some examples:\n==========\n\n【Query】\nShow the stadium name and the number of concerts in each stadium. Please also list the year the stadium was built. \n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the stadium name, the year the stadium built and the number of concerts in each stadium\nConditions: NULL\n\nSubqueries:\n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the stadium name, the year the stadium built and the number of concerts in each stadium\n==========\n\n【Query】\nWhat is the qualification rate for the H-11 products produced in 2023/11/2?\n【Evidence】\nqualification rate = `Numqualified(H-11)` / `production(H-11)`\n\n【Decomposition】\nTargets: List the qualification rate for the H-11 Products\nConditions:\n1. produced in 2023/11/2 --Condition_1\n\nSubqueries:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the qualification rate for the H-11 Products produced in 2023/11/2\n\n==========\n\n【Query】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n\n【Decomposition】\nTargets: List the race of institutions\nConditions: \n1. in Alabama --Condition_1\n2. number of students greater than the 90% of average number of students of all institutions --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the race of institution in Alabama\n2. Conbine the first Subquery and Conditon_2 to get the seconed Subquery.\n##Subquery: List the race of institutions in Alabama with number of number of students greater than the 90% of average number of students of all institutions\n\n==========\n\n【Query】\nWhich president got a higher approval rating, Joseph Biden or Donald Trump?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\nConditions: \nNULL\n\nSubqueries: \n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\n\n==========\n\n【Query】\nFor movie id 1269, how many users, who was a paying subscriber and was eligible for trial when he rated the movie, gave the movie a rating score of less than or equal to 2?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the number of users\nConditions:\n1. was a paying subscriber --Condition_1\n2. was eligible for trial --Condition_2\n3. for movie id 1269, gave the movie a rating score of less than or equal to 2 --Condition3\n\nSubquerys:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the number of users who was a paying subscriber\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial\n3. Combine the second Subquery and Condition_3 to get the third Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial and gave the movie whose id is 1269 a rating score of less than or equal to 2\n\n==========\n\nHere is a new query need to be decomposed:\n\n【Query】\nWhat is the unabbreviated mailing address of the school with the highest FRPM count for K-12 students?\n【Evidence】\n\n\n【Decomposition】\n", "prompt_token": 1035, "response_token": 88, "cur_total_prompt_tokens": 44600, "cur_total_response_tokens": 4083}
{"idx": 3, "db_id": "california_schools", "query": "What is the unabbreviated mailing address of the school with the highest FRPM count for K-12 students?", "evidence": "", "difficulty": "simple", "ground_truth": "SELECT T2.MailStreet FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 1", "send_to": "Generator", "response": "\nTo answer the question \"What is the unabbreviated mailing address of the school with the highest FRPM count for K-12 students?\", we need to identify the relevant columns from the database schema and construct the SQL query accordingly.\n\n### Step-by-Step Breakdown:\n\n1. **Identify Target Columns**:\n   - The unabbreviated mailing address consists of:\n     - `MailStreet` (the street address)\n     - `MailCity` (the mailing city)\n     - `MailZip` (the mailing zip code)\n   - The highest FRPM count for K-12 students refers to `FRPM Count (K-12)` from the `frpm` table.\n\n2. **Determine the Connection Between Tables**:\n   - The `frpm` table is connected to the `schools` table via the `CDSCode` column. We will need to join these two tables.\n\n3. **Construct the SQL Query**:\n   - We will first find the maximum FRPM count for K-12 students.\n   - Then, we will select the mailing address of the school that has this maximum FRPM count.\n\n### Final SQL Query:\n```sql\nSELECT T2.`MailStreet`, T2.`MailCity`, T2.`MailZip`\nFROM frpm AS T1\nJOIN schools AS T2 ON T1.`CDSCode` = T2.`CDSCode`\nWHERE T1.`FRPM Count (K-12)` = (\n    SELECT MAX(`FRPM Count (K-12)`)\n    FROM frpm\n)\n```\n\n### Explanation of the SQL Query:\n- We are selecting the `MailStreet`, `MailCity`, and `MailZip` from the `schools` table (aliased as `T2`).\n- We join the `frpm` table (aliased as `T1`) on the `CDSCode` to link the FRPM count with the corresponding school.\n- The `WHERE` clause filters the results to only include the school(s) with the maximum FRPM count for K-12 students, which is determined by a subquery that selects the maximum value from the `FRPM Count (K-12)` column in the `frpm` table.\n\nThis query will return the unabbreviated mailing address of the school with the highest FRPM count for K-12 students.\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】and a 【Question】, you need to use valid SQLite and understand the database and knowledge so that you can generate a good SQL for the 【Question】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# stadium: [Stadium_ID (INTEGER), Location (TEXT), Name (TEXT)]\n# concert: [concert_ID (INTEGER), concert_Name (TEXT), Stadium_ID (INTEGER)]\n【Primary keys】\nstadium.`Stadium_ID` | concert.`concert_ID`\n【Foreign keys】\nconcert.`Stadium_ID` = stadium.`Stadium_ID`\n【Detailed descriptions of tables and columns】\nstadium.`Stadium_ID`: The column 'Stadium_ID' in Table <stadium> has column descriptions of \"stadium id\". Value examples: [1, 2, 3, 4, 5, 6].\nstadium.`Name`:  The column 'Name' in Table <stadium> has column descriptions of \"name of stadium\". Value examples: [\"Stark's Park\", 'Somerset Park', 'Recreation Park', 'Hampden Park', 'Glebe Park', 'Gayfield Park'].\nstadium.`Location`: The column 'Location' in Table <stadium> has column descriptions of \"location of stadium\". Value examples: ['Stirling Albion', 'Raith Rovers', \"Queen's Park\", 'Peterhead', 'East Fife', 'Brechin City'].\nconcert.`concert_ID`: The column 'concert_ID' in Table <concert> has column descriptions of \"concert id\". Value examples: [1, 2, 3, 4, 5, 6].\nconcert.`concert_Name`: The column 'concert_Name' in Table <concert> has column descriptions of \"concert name\". Value examples: ['Week 1', 'Week 2', 'Super bootcamp', 'Home Visits', 'Auditions'].\nconcert.`Stadium_ID`: The column 'Stadium_ID' in Table <concert> has column descriptions of \"stadium id\". Value examples: [2, 9, 7, 10, 1].\n【Evidence】\nNULL\n【Question】\nShow the stadium name and the number of concerts in each stadium.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: Show the stadium name and the number of concerts in each stadium.\nTargets for `SELECT`: the stadium name and the number of concerts\nhints from 【Evidence】:NULL\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the stadium name refers to stadium.`Name`, the number of concerts refers to COUNT(concert.`concert_ID`), each stadium refers to stadium.`Stadium_ID`\nConnection of tables: include tables <stadium> and <concert>, get connected keys from 【Foreign keys】: concert.`Stadium_ID` = stadium.`Stadium_ID`\nFinal SQL:\n```sql\nSELECT T1.`Name`, COUNT(T2.concert_ID) AS num_concerts\n  FROM stadium AS T1\n  JOIN concert AS T2\n  ON T1.`Stadium_ID` = T2.`Stadium_ID`\n  GROUP BY T1.`Stadium_ID`\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); name of the car refers to car_name\n【Question】\nWhat is the fastest car made by Japan?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ncountry.`country` = 'Japan'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: What is the fastest car made by Japan?\nTargets for `SELECT`: the name of the fastest car\nhints from 【Evidence】: the fastest refers to max(horsepower); name of the car refers to car_name\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: car refers to data.`car_name`, the fastest refers to MAX(data.`horsepower`), Japan refers to country.`country`\nConnection of tables: includes tables <data> and <country>, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`car_name` \n  FROM data AS T1 \n  INNER JOIN production AS T2 \n  ON T1.`ID` = T2.`ID` \n  INNER JOIN country AS T3 \n  ON T3.`origin` = T2.`country` \n  WHERE T3.`country` = 'Japan' \n  ORDER BY T1.`horsepower` DESC LIMIT 1\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`chronname`: The column 'chronname' in Table <institution_details> has column descriptions of \"Institution name\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \n【Evidence】\nnumber of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the chronname of institutions with number of students greater than the 90% of average number of students of all institutions?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: List the chroname of institutions with number of students greater than the 90% of average number of students of all institutions?\nTargets for `SELECT`: the chroname of institutions\nhints from 【Evidence】: number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the chronname of institutions refers to institution_details.`chronname`, number of students refers to institution_details.`student_count`\nConnection of tables: include only one table <institution_details>, no connection\nFinal SQL:\n```sql\nSELECT DISTINCT `chroname`\n  FROM institution_details\n  WHERE `student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details\n  ) \n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\nfrpm.`CDSCode`: The column 'CDSCode' in Table <frpm> has column descriptions of \"CDSCode\". \nfrpm.`Enrollment (K-12)`: The column 'Enrollment (K-12)' in Table <frpm> has column descriptions of \"Enrollment (K-12)\". \nfrpm.`Free Meal Count (K-12)`: The column 'Free Meal Count (K-12)' in Table <frpm> has column descriptions of \"Free Meal Count (K-12)\". \nfrpm.`Percent (%) Eligible Free (K-12)`: The column 'Percent (%) Eligible Free (K-12)' in Table <frpm> has column descriptions of \"Percent (%) Eligible Free (K-12)\". \nfrpm.`FRPM Count (K-12)`: The column 'FRPM Count (K-12)' in Table <frpm> has column descriptions of \"Free or Reduced Price Meal Count (K-12)\". \nschools.`CDSCode`: The column 'CDSCode' in Table <schools> has column descriptions of \"CDSCode\". \nschools.`District`: The column 'District' in Table <schools> has column descriptions of \"District\". \nschools.`School`: The column 'School' in Table <schools> has column descriptions of \"School\". \nschools.`MailStreet`: The column 'MailStreet' in Table <schools> has column descriptions of \"MailStreet\". \nschools.`MailCity`: The column 'MailCity' in Table <schools> has column descriptions of \"mailing city\".  Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].\nschools.`MailZip`: The column 'MailZip' in Table <schools> has column descriptions of \"mailing zip\".  Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].\n\n【Evidence】\n\n【Question】\nWhat is the unabbreviated mailing address of the school with the highest FRPM count for K-12 students?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n", "prompt_token": 3677, "response_token": 481, "cur_total_prompt_tokens": 48277, "cur_total_response_tokens": 4564}
{"idx": 4, "db_id": "california_schools", "query": "Please list the phone numbers of the direct charter-funded schools that are opened after 2000/1/1.", "evidence": "Charter schools refers to `Charter School (Y/N)` = 1 in the frpm", "difficulty": "moderate", "ground_truth": "SELECT T2.Phone FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter Funding Type` = 'Directly funded' AND T1.`Charter School (Y/N)` = 1 AND T2.OpenDate > '2000-01-01'", "send_to": "Soft_Schema_Linker", "response": "\nThe entities extracted from the 【Question】 are: \n1. phone numbers\n2. direct charter-funded schools\n3. opened after 2000/1/1\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. phone numbers --no related evidence **the columns about phone numbers are related**\n2. direct charter-funded schools --Charter schools refers to `Charter School (Y/N)` = 1 in the frpm **the columns about charter schools are related**\n3. opened after 2000/1/1 --no related evidence **the columns about opening dates are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"phone numbers\": [\"schools.Phone\", \"schools.Ext\", \"schools.MailZip\"],\n  \"direct charter-funded schools\": [\"frpm.Charter School (Y/N)\", \"frpm.Charter Funding Type\", \"frpm.CDSCode\"],\n  \"opened after 2000/1/1\": [\"schools.OpenDate\", \"schools.ClosedDate\", \"frpm.Academic Year\"]\n}\n```\nQuestion Solved.\n", "input_prompt": "As an experienced and professional database administrator, your task is to analyze a user question and a database schema to provide relevant information. The database schema consists of table descriptions, each containing multiple column descriptions. Your goal is to extract the entities from question and identify the relevant tables and columns based on these entities and the evidence provided.\n\n[Instruction]:\n1. Extract the mentioned entities from the user question. Make sure all of the entities are extracted. \n2. For each entity, keep at least 3 related columns.\n4. Your output should include entity extraction, analysis and related database schema.\n5. The related database schema should be in JSON format.\n6. Each column's information in provided 【Schema】 is in this format: (column, description. Value examples<optional>)\n\n[Requirements]:\n1. Sort the related columns in each list corresponding to each entity in descending order of relevance.\n2. The chosen columns should be in this format: <table.column>.\n3. Make sure each chosen list is not empty. The value [] will be punished. \n4.【Matched values】 may contain redundant or useless information in addition to the correct matching values, so you need to select the useful information in conjunction with the specific column names and descriptions.\n5. An entity may not have a corresponding evidence, which requires you to find the relevant columns yourself through your understanding of the database schema.\n\nHere is a typical example:\n\n==========\n【DB_ID】 banking_system\n【Schema】\n# Table: account\n[\n  (account_id <INTEGER>, the id of the account. Value examples: [11382, 11362, 2, 1, 2367].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (frequency <TEXT>, frequency of the acount. Value examples: ['POPLATEK MESICNE', 'POPLATEK TYDNE', 'POPLATEK PO OBRATU'].),\n  (date <DATE>, the creation date of the account. Value examples: ['1997-12-29', '1997-12-28'].)\n]\n# Table: client\n[\n  (client_id <INTEGER>, the unique number. Value examples: [13998, 13971, 2, 1, 2839].),\n  (gender <TEXT>, gender. Value examples: ['M', 'F']. And F：female . M：male ),\n  (birth_date <DATE>, birth date. Value examples: ['1987-09-27', '1986-08-13'].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (first_name <TEXT>, first_name.),\n  (last_name <TEXT>, last_name.)\n]\n# Table: loan\n[\n  (loan_id <INTEGER>, the id number identifying the loan data. Value examples: [4959, 4960, 4961].),\n  (account_id <INTEGER>, the id number identifying the account. Value examples: [10, 80, 55, 43].),\n  (date <DATE>, the date when the loan is approved. Value examples: ['1998-07-12', '1998-04-19'].),\n  (amount <INTEGER>, the id number identifying the loan data. Value examples: [1567, 7877, 9988].),\n  (duration <INTEGER>, the id number identifying the loan data. Value examples: [60, 48, 24, 12, 36].),\n  (payments <INTEGER>, the id number identifying the loan data. Value examples: [3456, 8972, 9845].),\n  (status <TEXT>, the id number identifying the loan data. Value examples: ['C', 'A', 'D', 'B'].)\n]\n# Table: district\n[\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76].),\n  (A2 <REAL>, area in square kilometers. Value examples: [50.5, 48.9].),\n  (A4 <INTEGER>, number of inhabitants. Value examples: [95907, 95616].),\n  (A5 <INTEGER>, number of households. Value examples: [35678, 34892].),\n  (A6 <REAL>, literacy rate. Value examples: [95.6, 92.3, 89.7].),\n  (A7 <INTEGER>, number of entrepreneurs. Value examples: [1234, 1456].),\n  (A8 <INTEGERt>, number of cities. Value examples: [5, 4].),\n  (A9 <INTEGER>, number of schools. Value examples: [15, 12, 10].),\n  (A10 <INTEGER>, number of hospitals. Value examples: [8, 6, 4].),\n  (A11 <REAL>, average salary. Value examples: [12541.5, 11277].),\n  (A12 <REAL>, poverty rate. Value examples: [12.4, 9.8].),\n  (A13 <REAL>, unemployment rate. Value examples: [8.2, 7.9].),\n  (A15 <INTEGER>, number of crimes. Value examples: [256, 189].)\n]\n【Primary keys】\naccount.`account_id` | client.`client_id` | loan.`loan_id` | district.`district_id`\n【Foreign keys】\nclient.`district_id` = district.`district_id`\n【Question】\nWhat is the gender of the youngest client who opened account in the lowest average salary branch and when did this client open the account? Please list their full name.\n【Evidence】\nLater birthdate refers to younger age; A11 refers to average salary; Full name refers to first_name, last_name\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\nThe entities extracted from the 【Question】 are: \n1. gender; \n2. youngest client; \n3. account; \n4. lowest average salary branch; \n5. when did this client open the account; \n6. full name\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. gender --no related evidence **the columns about gender are related**\n2. youngest client  --Later birthdate refers to younger age; **the columns about birth date of client and the id of client are related**\n3. account --no related evidence **the columns about account or account ids are related**\n4. lowest average salary branch  --A11 refers to average salary **the columns about average salary and branch are related**\n5. when did this client open the account --no related evidence **the columns about time or date of the account are related**\n6. full name  --Full name refers to first_name, last_name **the columns about first_name, last_name of the client are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"gender\": [\"client.gender\",\"client.client_id\",\"loan.status\"],\n  \"youngest client\": [\"client.birth_date\",\"client.client_id\",\"account.date\",\"loan.date\"],\n  \"account\": [\"account.account_id\",\"loan.account_id\",\"account.date\"],\n  \"lowest average salary branch\": [\"district.A11\",\"district.district_id\",\"district.A13\"],\n  \"when did this client open the account\": [\"account.date\",\"loan.date\",\"client.birth_date\"],\n  \"full name\": [\"client.first_name\",\"client.last_name\",\"client.client_id\"]\n}\n```\nQuestion Solved.\n\n==========\n\nHere is a new example, please start answering:\n\n【DB_ID】 california_schools\n【Schema】\n# Table: frpm\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (Academic Year <TEXT>,  Academic Year. Value examples: ['2014-2015'].),\n  (County Code <TEXT>,  County Code. Value examples: ['19', '37', '30', '36', '33', '43'].),\n  (District Code <INTEGER>,  District Code.),\n  (School Code <TEXT>,  School Code. Value examples: ['0000000', '9010745', '6121081', '6121073', '6121016', '6120968'].),\n  (County Name <TEXT>,  County Name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].),\n  (District Name <TEXT>,  District Name.),\n  (School Name <TEXT>,  School Name.),\n  (District Type <TEXT>,  District Type. Value examples: ['Unified School District', 'Elementary School District', 'High School District', 'County Office of Education (COE)', 'State Board of Education', 'Statewide Benefit Charter'].),\n  (School Type <TEXT>,  School Type. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].),\n  (Educational Option Type <TEXT>,  Educational Option Type. Value examples: [None, 'Traditional', 'Continuation School', 'Alternative School of Choice', 'Community Day School', 'Special Education School', 'County Community School'].),\n  (NSLP Provision Status <TEXT>,  NSLP Provision Status. Value examples: [None, 'Provision 2', 'Breakfast Provision 2', 'CEP', 'Multiple Provision Types', 'Provision 1', 'Lunch Provision 2'].),\n  (Charter School (Y/N) <INTEGER>,  Charter School (Y/N). Value examples: [None, 0, 1].),\n  (Charter School Number <TEXT>,  Charter School Number. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1700', '1696'].),\n  (Charter Funding Type <TEXT>,  Charter Funding Type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (IRC <INTEGER>,  IRC. Value examples: [None, 0, 1].),\n  (Low Grade <TEXT>,  Low Grade. Value examples: ['K', '9', '6', '7', 'P', '5'].),\n  (High Grade <TEXT>,  High Grade. Value examples: ['12', '5', '8', '6', '3', '4'].),\n  (Enrollment (K-12) <REAL>,  Enrollment (K-12).),\n  (Free Meal Count (K-12) <REAL>,  Free Meal Count (K-12).),\n  (Percent (%) Eligible Free (K-12) <REAL>,  Percent (%) Eligible Free (K-12).),\n  (FRPM Count (K-12) <REAL>,  Free or Reduced Price Meal Count (K-12).),\n  (Percent (%) Eligible FRPM (K-12) <REAL>,  Percent (%) Eligible FRPM (K-12).),\n  (Enrollment (Ages 5-17) <REAL>,  Enrollment (Ages 5-17).),\n  (Free Meal Count (Ages 5-17) <REAL>,  Free Meal Count (Ages 5-17).),\n  (Percent (%) Eligible Free (Ages 5-17) <REAL>,  Percent (%) Eligible Free (Ages 5-17).),\n  (FRPM Count (Ages 5-17) <REAL>,  FRPM Count (Ages 5-17).),\n  (Percent (%) Eligible FRPM (Ages 5-17) <REAL>,  Percent (%) Eligible FRPM (Ages 5-17).),\n  (2013-14 CALPADS Fall 1 Certification Status <INTEGER>,  2013-14 CALPADS Fall 1 Certification Status. Value examples: [1].)\n]\n# Table: satscores\n[\n  (cds <TEXT>,  California Department Schools.),\n  (rtype <TEXT>,  rtype. Value examples: ['S', 'D'].),\n  (sname <TEXT>,  school name. Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].),\n  (dname <TEXT>,  district segment. Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].),\n  (cname <TEXT>,  county name. Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].),\n  (enroll12 <INTEGER>,  enrollment (1st-12nd grade).),\n  (NumTstTakr <INTEGER>,  Number of Test Takers in this school.),\n  (AvgScrRead <INTEGER>,  average scores in Reading.),\n  (AvgScrMath <INTEGER>,  average scores in Math.),\n  (AvgScrWrite <INTEGER>,  average scores in writing.),\n  (NumGE1500 <INTEGER>,  Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500.)\n]\n# Table: schools\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (NCESDist <TEXT>,  This field represents the 7-digit National Center for Educational Statistics (NCES) school district identification number. The first 2 digits identify the state and the last 5 digits identify the school district. Combined, they make a unique 7-digit ID for each school district.. Value examples: [None, '0622710', '0634320', '0628050', '0634410', '0614550', '0633840'].),\n  (NCESSchool <TEXT>,  This field represents the 5-digit NCES school identification number. The NCESSchool combined with the NCESDist form a unique 12-digit ID for each school.. Value examples: [None, '12271', '13785', '13747', '12909', '12311', '12003'].),\n  (StatusType <TEXT>,  This field identifies the status of the district.. Value examples: ['Active', 'Closed', 'Merged', 'Pending'].),\n  (County <TEXT>,  County name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].),\n  (District <TEXT>,  District.),\n  (School <TEXT>,  School.),\n  (Street <TEXT>,  Street.),\n  (StreetAbr <TEXT>,  The abbreviated street address of the school, district, or administrative authority’s physical location..),\n  (City <TEXT>,  City. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].),\n  (Zip <TEXT>,  Zip. Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].),\n  (State <TEXT>,  State. Value examples: [None, 'CA'].),\n  (MailStreet <TEXT>,  MailStreet.),\n  (MailStrAbr <TEXT>,  mailing street address.),\n  (MailCity <TEXT>,  mailing city. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].),\n  (MailZip <TEXT>,  mailing zip. Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].),\n  (MailState <TEXT>,  mailing state. Value examples: [None, 'CA'].),\n  (Phone <TEXT>,  Phone. Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].),\n  (Ext <TEXT>,  The phone number extension of the school, district, or administrative authority.. Value examples: [None, '200', '201', '111', '352', '221', '203'].),\n  (Website <TEXT>,  The website address of the school, district, or administrative authority..),\n  (OpenDate <DATE>,  The date the school opened.. Value examples: [None, '1980-07-01'].),\n  (ClosedDate <DATE>,  The date the school closed.. Value examples: [None, '1989-06-30'].),\n  (Charter <INTEGER>,  This field identifies a charter school.. Value examples: [None, 0, 1].),\n  (CharterNum <TEXT>,  The charter school number,. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1826', '1710'].),\n  (FundingType <TEXT>,  Indicates the charter school funding type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (DOC <TEXT>,  District Ownership Code. Value examples: ['54', '52', '00', '56', '98', '02'].),\n  (DOCType <TEXT>,  The District Ownership Code Type is the text description of the DOC category.. Value examples: ['Unified School District', 'Elementary School District', 'County Office of Education (COE)', 'High School District', 'Regional Occupation Center/Program (ROC/P)', 'State Board of Education'].),\n  (SOC <TEXT>,  The School Ownership Code is a numeric code used to identify the type of school.. Value examples: [None, '60', '66', '62', '68', '09', '69'].),\n  (SOCType <TEXT>,  The School Ownership Code Type is the text description of the type of school.. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Special Education Schools (Public)', 'District Community Day Schools'].),\n  (EdOpsCode <TEXT>,  The Education Option Code is a short text description of the type of education offered.. Value examples: [None, 'TRAD', 'CON', 'COMMDAY', 'ALTSOC', 'SPEC', 'COMM'].),\n  (EdOpsName <TEXT>,  Educational Option Name. Value examples: [None, 'Traditional', 'Continuation School', 'Community Day School', 'Alternative School of Choice', 'Special Education School', 'County Community School'].),\n  (EILCode <TEXT>,  The Educational Instruction Level Code is a short text description of the institution's type relative to the grade range served.. Value examples: [None, 'ELEM', 'HS', 'UG', 'INTMIDJR', 'ELEMHIGH', 'A'].),\n  (EILName <TEXT>,  The Educational Instruction Level Name is the long text description of the institution’s type relative to the grade range served.. Value examples: [None, 'Elementary', 'High School', 'Ungraded', 'Intermediate/Middle/Junior High', 'Elementary-High Combination', 'Adult'].),\n  (GSoffered <TEXT>,  The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.. Value examples: [None, 'K-5', '9-12', 'K-6', 'K-8', '6-8', 'K-12'].),\n  (GSserved <TEXT>,  It is the lowest grade and the highest grade of student enrollment as reported in the most recent certified CALPADS Fall 1 data collection. Only K–12 enrollment is reported through CALPADS. This field may differ from the grade span offered.. Value examples: [None, 'K-5', 'K-6', '9-12', 'K-8', '6-8', '7-8'].),\n  (Virtual <TEXT>,  This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.. Value examples: [None, 'N', 'P', 'F'].),\n  (Magnet <INTEGER>,  This field identifies whether a school is a magnet school and/or provides a magnet program.. Value examples: [None, 0, 1].),\n  (Latitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the equator measured north to south..),\n  (Longitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the prime meridian (Greenwich, England) measured from west to east..),\n  (AdmFName1 <TEXT>,  administrator's first name 1. Value examples: [None, 'David', 'Michael', 'John', 'Jennifer', 'Lisa', 'Robert'].),\n  (AdmLName1 <TEXT>,  administrator's last name 1.),\n  (AdmEmail1 <TEXT>,  administrator's email address 1.),\n  (AdmFName2 <TEXT>,  administrator's first name 2. Value examples: [None, 'Steve', 'Delphine', 'Tim', 'Michael', 'Lisa', 'Jeff'].),\n  (AdmLName2 <TEXT>,  administrator's last name 2. Value examples: [None, 'Sherman', 'Jones', 'Wilson', 'Petersen', 'Landry', 'Hambright'].),\n  (AdmEmail2 <TEXT>,  administrator's email address 2.),\n  (AdmFName3 <TEXT>,  administrator's first name 3. Value examples: [None, 'Mark', 'Eric', 'Vickie', 'Tracie', 'Shawn', 'Sarah'].),\n  (AdmLName3 <TEXT>,  administrator's last name 3. Value examples: [None, 'Zerpoli', 'Yount', 'Woodruff', 'Wood', 'Wolk', 'Spotts'].),\n  (AdmEmail3 <TEXT>,  administrator's email address 3.),\n  (LastUpdate <DATE>,  Last Update. Value examples: ['2015-06-18'].)\n]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Question】\nPlease list the phone numbers of the direct charter-funded schools that are opened after 2000/1/1.\n【Evidence】\nCharter schools refers to `Charter School (Y/N)` = 1 in the frpm\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\n", "prompt_token": 5138, "response_token": 240, "cur_total_prompt_tokens": 53415, "cur_total_response_tokens": 4804}
{"idx": 4, "db_id": "california_schools", "query": "Please list the phone numbers of the direct charter-funded schools that are opened after 2000/1/1.", "evidence": "Charter schools refers to `Charter School (Y/N)` = 1 in the frpm", "difficulty": "moderate", "ground_truth": "SELECT T2.Phone FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter Funding Type` = 'Directly funded' AND T1.`Charter School (Y/N)` = 1 AND T2.OpenDate > '2000-01-01'", "send_to": "Decomposer", "response": "\nTargets: List the phone numbers of the direct charter-funded schools  \nConditions: \n1. opened after 2000/1/1 --Condition_1\n2. direct charter-funded schools --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_2 to get the first Subquery.  \n##Subquery: List the phone numbers of the direct charter-funded schools  \n2. Combine the first Subquery and Condition_1 to get the second Subquery.  \n##Subquery: List the phone numbers of the direct charter-funded schools that are opened after 2000/1/1\n", "input_prompt": "[Instruction]\nGiven a 【query】, you need to understanding the intent of Query, and then deceompose it into Targets and Conditions. Then you need to combine Targets and Conditions into Subquerys step by step. \nFor the case where Conditions is NULL, consider Targets as the final Subquery directly. \nFor the case where Conditions are not NULL, combine Targets and the first Condition to get the first Subquery, then combine this Subquery and the next Condition into a new Subquery until all Conditions are used (which means the content of the last Subquery and the original Query is the same).\n\n[Requirements]\n-Try not to overlap Targets and Conditions.\n-Make sure the decomposed Target and Condition can cover all of the information in Query.\n-Don't change any information (specific value) in Query!\n-Mark each Subquery with ## in front of it.\n\nHere are some examples:\n==========\n\n【Query】\nShow the stadium name and the number of concerts in each stadium. Please also list the year the stadium was built. \n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the stadium name, the year the stadium built and the number of concerts in each stadium\nConditions: NULL\n\nSubqueries:\n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the stadium name, the year the stadium built and the number of concerts in each stadium\n==========\n\n【Query】\nWhat is the qualification rate for the H-11 products produced in 2023/11/2?\n【Evidence】\nqualification rate = `Numqualified(H-11)` / `production(H-11)`\n\n【Decomposition】\nTargets: List the qualification rate for the H-11 Products\nConditions:\n1. produced in 2023/11/2 --Condition_1\n\nSubqueries:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the qualification rate for the H-11 Products produced in 2023/11/2\n\n==========\n\n【Query】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n\n【Decomposition】\nTargets: List the race of institutions\nConditions: \n1. in Alabama --Condition_1\n2. number of students greater than the 90% of average number of students of all institutions --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the race of institution in Alabama\n2. Conbine the first Subquery and Conditon_2 to get the seconed Subquery.\n##Subquery: List the race of institutions in Alabama with number of number of students greater than the 90% of average number of students of all institutions\n\n==========\n\n【Query】\nWhich president got a higher approval rating, Joseph Biden or Donald Trump?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\nConditions: \nNULL\n\nSubqueries: \n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\n\n==========\n\n【Query】\nFor movie id 1269, how many users, who was a paying subscriber and was eligible for trial when he rated the movie, gave the movie a rating score of less than or equal to 2?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the number of users\nConditions:\n1. was a paying subscriber --Condition_1\n2. was eligible for trial --Condition_2\n3. for movie id 1269, gave the movie a rating score of less than or equal to 2 --Condition3\n\nSubquerys:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the number of users who was a paying subscriber\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial\n3. Combine the second Subquery and Condition_3 to get the third Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial and gave the movie whose id is 1269 a rating score of less than or equal to 2\n\n==========\n\nHere is a new query need to be decomposed:\n\n【Query】\nPlease list the phone numbers of the direct charter-funded schools that are opened after 2000/1/1.\n【Evidence】\nCharter schools refers to `Charter School (Y/N)` = 1 in the frpm\n\n【Decomposition】\n", "prompt_token": 1056, "response_token": 121, "cur_total_prompt_tokens": 54471, "cur_total_response_tokens": 4925}
{"idx": 4, "db_id": "california_schools", "query": "Please list the phone numbers of the direct charter-funded schools that are opened after 2000/1/1.", "evidence": "Charter schools refers to `Charter School (Y/N)` = 1 in the frpm", "difficulty": "moderate", "ground_truth": "SELECT T2.Phone FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter Funding Type` = 'Directly funded' AND T1.`Charter School (Y/N)` = 1 AND T2.OpenDate > '2000-01-01'", "send_to": "Generator", "response": "\nTo answer the question \"List the phone numbers of the direct charter-funded schools,\" we need to follow these steps:\n\n1. **Identify the relevant columns**: \n   - We need the phone numbers from the `schools` table, which corresponds to `schools.Phone`.\n   - We also need to filter for direct charter-funded schools, which is indicated by the `Charter Funding Type` in the `frpm` table.\n\n2. **Understand the evidence**: \n   - The evidence states that charter schools are identified by `Charter School (Y/N)` = 1 in the `frpm` table. \n   - We need to ensure that we only select those charter schools that are directly funded.\n\n3. **Establish the connection between tables**: \n   - The `frpm` table is connected to the `schools` table via the `CDSCode` column. \n   - We will need to join these two tables to filter the results correctly.\n\n4. **Construct the SQL query**:\n   - We will select the `Phone` column from the `schools` table.\n   - We will join the `frpm` table to filter for schools that are charter schools and are directly funded.\n\nHere is the SQL query that accomplishes this:\n\n```sql\nSELECT S.`Phone`\n  FROM schools AS S\n  JOIN frpm AS F\n  ON S.`CDSCode` = F.`CDSCode`\n  WHERE F.`Charter School (Y/N)` = 1 \n    AND F.`Charter Funding Type` = 'Directly funded'\n```\n\n### Explanation of the SQL:\n- `SELECT S.`Phone``: We are selecting the phone numbers from the `schools` table.\n- `FROM schools AS S`: We are using the `schools` table and aliasing it as `S`.\n- `JOIN frpm AS F ON S.`CDSCode` = F.`CDSCode``: We are joining the `frpm` table (aliased as `F`) on the `CDSCode` to connect the two tables.\n- `WHERE F.`Charter School (Y/N)` = 1`: This condition filters for charter schools.\n- `AND F.`Charter Funding Type` = 'Directly funded'`: This additional condition ensures that we only include schools that are directly funded.\n\nThis query will return the phone numbers of all direct charter-funded schools.\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】and a 【Question】, you need to use valid SQLite and understand the database and knowledge so that you can generate a good SQL for the 【Question】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# stadium: [Stadium_ID (INTEGER), Location (TEXT), Name (TEXT)]\n# concert: [concert_ID (INTEGER), concert_Name (TEXT), Stadium_ID (INTEGER)]\n【Primary keys】\nstadium.`Stadium_ID` | concert.`concert_ID`\n【Foreign keys】\nconcert.`Stadium_ID` = stadium.`Stadium_ID`\n【Detailed descriptions of tables and columns】\nstadium.`Stadium_ID`: The column 'Stadium_ID' in Table <stadium> has column descriptions of \"stadium id\". Value examples: [1, 2, 3, 4, 5, 6].\nstadium.`Name`:  The column 'Name' in Table <stadium> has column descriptions of \"name of stadium\". Value examples: [\"Stark's Park\", 'Somerset Park', 'Recreation Park', 'Hampden Park', 'Glebe Park', 'Gayfield Park'].\nstadium.`Location`: The column 'Location' in Table <stadium> has column descriptions of \"location of stadium\". Value examples: ['Stirling Albion', 'Raith Rovers', \"Queen's Park\", 'Peterhead', 'East Fife', 'Brechin City'].\nconcert.`concert_ID`: The column 'concert_ID' in Table <concert> has column descriptions of \"concert id\". Value examples: [1, 2, 3, 4, 5, 6].\nconcert.`concert_Name`: The column 'concert_Name' in Table <concert> has column descriptions of \"concert name\". Value examples: ['Week 1', 'Week 2', 'Super bootcamp', 'Home Visits', 'Auditions'].\nconcert.`Stadium_ID`: The column 'Stadium_ID' in Table <concert> has column descriptions of \"stadium id\". Value examples: [2, 9, 7, 10, 1].\n【Evidence】\nNULL\n【Question】\nShow the stadium name and the number of concerts in each stadium.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: Show the stadium name and the number of concerts in each stadium.\nTargets for `SELECT`: the stadium name and the number of concerts\nhints from 【Evidence】:NULL\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the stadium name refers to stadium.`Name`, the number of concerts refers to COUNT(concert.`concert_ID`), each stadium refers to stadium.`Stadium_ID`\nConnection of tables: include tables <stadium> and <concert>, get connected keys from 【Foreign keys】: concert.`Stadium_ID` = stadium.`Stadium_ID`\nFinal SQL:\n```sql\nSELECT T1.`Name`, COUNT(T2.concert_ID) AS num_concerts\n  FROM stadium AS T1\n  JOIN concert AS T2\n  ON T1.`Stadium_ID` = T2.`Stadium_ID`\n  GROUP BY T1.`Stadium_ID`\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); name of the car refers to car_name\n【Question】\nWhat is the fastest car made by Japan?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ncountry.`country` = 'Japan'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: What is the fastest car made by Japan?\nTargets for `SELECT`: the name of the fastest car\nhints from 【Evidence】: the fastest refers to max(horsepower); name of the car refers to car_name\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: car refers to data.`car_name`, the fastest refers to MAX(data.`horsepower`), Japan refers to country.`country`\nConnection of tables: includes tables <data> and <country>, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`car_name` \n  FROM data AS T1 \n  INNER JOIN production AS T2 \n  ON T1.`ID` = T2.`ID` \n  INNER JOIN country AS T3 \n  ON T3.`origin` = T2.`country` \n  WHERE T3.`country` = 'Japan' \n  ORDER BY T1.`horsepower` DESC LIMIT 1\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`chronname`: The column 'chronname' in Table <institution_details> has column descriptions of \"Institution name\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \n【Evidence】\nnumber of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the chronname of institutions with number of students greater than the 90% of average number of students of all institutions?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: List the chroname of institutions with number of students greater than the 90% of average number of students of all institutions?\nTargets for `SELECT`: the chroname of institutions\nhints from 【Evidence】: number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the chronname of institutions refers to institution_details.`chronname`, number of students refers to institution_details.`student_count`\nConnection of tables: include only one table <institution_details>, no connection\nFinal SQL:\n```sql\nSELECT DISTINCT `chroname`\n  FROM institution_details\n  WHERE `student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details\n  ) \n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\nfrpm.`CDSCode`: The column 'CDSCode' in Table <frpm> has column descriptions of \"CDSCode\". \nfrpm.`Academic Year`: The column 'Academic Year' in Table <frpm> has column descriptions of \"Academic Year\".  Value examples: ['2014-2015'].\nfrpm.`Charter School (Y/N)`: The column 'Charter School (Y/N)' in Table <frpm> has column descriptions of \"Charter School (Y/N)\".  Value examples: [None, 0, 1].\nfrpm.`Charter Funding Type`: The column 'Charter Funding Type' in Table <frpm> has column descriptions of \"Charter Funding Type\".  Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].\nschools.`MailZip`: The column 'MailZip' in Table <schools> has column descriptions of \"mailing zip\".  Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].\nschools.`Phone`: The column 'Phone' in Table <schools> has column descriptions of \"Phone\".  Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].\nschools.`Ext`: The column 'Ext' in Table <schools> has column descriptions of \"The phone number extension of the school, district, or administrative authority.\".  Value examples: [None, '200', '201', '111', '352', '221', '203'].\nschools.`OpenDate`: The column 'OpenDate' in Table <schools> has column descriptions of \"The date the school opened.\".  Value examples: [None, '1980-07-01'].\nschools.`ClosedDate`: The column 'ClosedDate' in Table <schools> has column descriptions of \"The date the school closed.\".  Value examples: [None, '1989-06-30'].\n\n【Evidence】\nCharter schools refers to `Charter School (Y/N)` = 1 in the frpm\n【Question】\nList the phone numbers of the direct charter-funded schools\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n", "prompt_token": 3732, "response_token": 493, "cur_total_prompt_tokens": 58203, "cur_total_response_tokens": 5418}
{"idx": 4, "db_id": "california_schools", "query": "Please list the phone numbers of the direct charter-funded schools that are opened after 2000/1/1.", "evidence": "Charter schools refers to `Charter School (Y/N)` = 1 in the frpm", "difficulty": "moderate", "ground_truth": "SELECT T2.Phone FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter Funding Type` = 'Directly funded' AND T1.`Charter School (Y/N)` = 1 AND T2.OpenDate > '2000-01-01'", "send_to": "Refiner", "response": "\nAnalysis:\nThe original SQL query attempts to select phone numbers from the `schools` table for charter-funded schools based on the `Charter School (Y/N)` and `Charter Funding Type` columns in the `frpm` table. However, it encounters an error due to the presence of `None` values in the `Phone` column. To resolve this, we need to add a condition to ensure that the `Phone` column is not null. \n\nCorrect SQL:\n```sql\nSELECT S.`Phone` \nFROM schools AS S \nJOIN frpm AS F ON S.`CDSCode` = F.`CDSCode` \nWHERE F.`Charter School (Y/N)` = 1 \nAND F.`Charter Funding Type` = 'Directly funded' \nAND S.`Phone` IS NOT NULL\n```\n\n【Evidence】\nThe condition `S.Phone IS NOT NULL` ensures that only schools with valid phone numbers are included in the results, thus preventing the error related to `None` values.\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nCharter schools refers to `Charter School (Y/N)` = 1 in the frpm\n【Query】\n-- List the phone numbers of the direct charter-funded schools\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\nfrpm.`CDSCode`: The column 'CDSCode' in Table <frpm> has column descriptions of \"CDSCode\". \nfrpm.`Academic Year`: The column 'Academic Year' in Table <frpm> has column descriptions of \"Academic Year\".  Value examples: ['2014-2015'].\nfrpm.`Charter School (Y/N)`: The column 'Charter School (Y/N)' in Table <frpm> has column descriptions of \"Charter School (Y/N)\".  Value examples: [None, 0, 1].\nfrpm.`Charter Funding Type`: The column 'Charter Funding Type' in Table <frpm> has column descriptions of \"Charter Funding Type\".  Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].\nschools.`MailZip`: The column 'MailZip' in Table <schools> has column descriptions of \"mailing zip\".  Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].\nschools.`Phone`: The column 'Phone' in Table <schools> has column descriptions of \"Phone\".  Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].\nschools.`Ext`: The column 'Ext' in Table <schools> has column descriptions of \"The phone number extension of the school, district, or administrative authority.\".  Value examples: [None, '200', '201', '111', '352', '221', '203'].\nschools.`OpenDate`: The column 'OpenDate' in Table <schools> has column descriptions of \"The date the school opened.\".  Value examples: [None, '1980-07-01'].\nschools.`ClosedDate`: The column 'ClosedDate' in Table <schools> has column descriptions of \"The date the school closed.\".  Value examples: [None, '1989-06-30'].\n\n【old SQL】\n```sql\nSELECT S.`Phone` FROM schools AS S JOIN frpm AS F ON S.`CDSCode` = F.`CDSCode` WHERE F.`Charter School (Y/N)` = 1 AND F.`Charter Funding Type` = 'Directly funded' \n```\n【SQLite error】 \nexist None value, you can add `IS NOT NULL` in SQL\n【Exception class】\n\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 1591, "response_token": 208, "cur_total_prompt_tokens": 59794, "cur_total_response_tokens": 5626}
{"idx": 4, "db_id": "california_schools", "query": "Please list the phone numbers of the direct charter-funded schools that are opened after 2000/1/1.", "evidence": "Charter schools refers to `Charter School (Y/N)` = 1 in the frpm", "difficulty": "moderate", "ground_truth": "SELECT T2.Phone FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter Funding Type` = 'Directly funded' AND T1.`Charter School (Y/N)` = 1 AND T2.OpenDate > '2000-01-01'", "send_to": "Soft_Schema_Linker", "response": "\nThe entities extracted from the 【Question】 are: \n1. phone numbers\n2. direct charter-funded schools\n3. opened after 2000/1/1\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. phone numbers --no related evidence **the columns about phone numbers are related**\n2. direct charter-funded schools --Charter schools refers to `Charter School (Y/N)` = 1 in the frpm **the columns about charter schools are related**\n3. opened after 2000/1/1 --no related evidence **the columns about opening dates are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"phone numbers\": [\"schools.Phone\", \"schools.Ext\", \"schools.CDSCode\"],\n  \"direct charter-funded schools\": [\"frpm.Charter School (Y/N)\", \"frpm.Charter Funding Type\", \"frpm.CDSCode\"],\n  \"opened after 2000/1/1\": [\"schools.OpenDate\", \"schools.ClosedDate\", \"frpm.Academic Year\"]\n}\n```\nQuestion Solved.\n", "input_prompt": "As an experienced and professional database administrator, your task is to analyze a user question and a database schema to provide relevant information. The database schema consists of table descriptions, each containing multiple column descriptions. Your goal is to extract the entities from question and identify the relevant tables and columns based on these entities and the evidence provided.\n\n[Instruction]:\n1. Extract the mentioned entities from the user question. Make sure all of the entities are extracted. \n2. For each entity, keep at least 3 related columns.\n4. Your output should include entity extraction, analysis and related database schema.\n5. The related database schema should be in JSON format.\n6. Each column's information in provided 【Schema】 is in this format: (column, description. Value examples<optional>)\n\n[Requirements]:\n1. Sort the related columns in each list corresponding to each entity in descending order of relevance.\n2. The chosen columns should be in this format: <table.column>.\n3. Make sure each chosen list is not empty. The value [] will be punished. \n4.【Matched values】 may contain redundant or useless information in addition to the correct matching values, so you need to select the useful information in conjunction with the specific column names and descriptions.\n5. An entity may not have a corresponding evidence, which requires you to find the relevant columns yourself through your understanding of the database schema.\n\nHere is a typical example:\n\n==========\n【DB_ID】 banking_system\n【Schema】\n# Table: account\n[\n  (account_id <INTEGER>, the id of the account. Value examples: [11382, 11362, 2, 1, 2367].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (frequency <TEXT>, frequency of the acount. Value examples: ['POPLATEK MESICNE', 'POPLATEK TYDNE', 'POPLATEK PO OBRATU'].),\n  (date <DATE>, the creation date of the account. Value examples: ['1997-12-29', '1997-12-28'].)\n]\n# Table: client\n[\n  (client_id <INTEGER>, the unique number. Value examples: [13998, 13971, 2, 1, 2839].),\n  (gender <TEXT>, gender. Value examples: ['M', 'F']. And F：female . M：male ),\n  (birth_date <DATE>, birth date. Value examples: ['1987-09-27', '1986-08-13'].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (first_name <TEXT>, first_name.),\n  (last_name <TEXT>, last_name.)\n]\n# Table: loan\n[\n  (loan_id <INTEGER>, the id number identifying the loan data. Value examples: [4959, 4960, 4961].),\n  (account_id <INTEGER>, the id number identifying the account. Value examples: [10, 80, 55, 43].),\n  (date <DATE>, the date when the loan is approved. Value examples: ['1998-07-12', '1998-04-19'].),\n  (amount <INTEGER>, the id number identifying the loan data. Value examples: [1567, 7877, 9988].),\n  (duration <INTEGER>, the id number identifying the loan data. Value examples: [60, 48, 24, 12, 36].),\n  (payments <INTEGER>, the id number identifying the loan data. Value examples: [3456, 8972, 9845].),\n  (status <TEXT>, the id number identifying the loan data. Value examples: ['C', 'A', 'D', 'B'].)\n]\n# Table: district\n[\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76].),\n  (A2 <REAL>, area in square kilometers. Value examples: [50.5, 48.9].),\n  (A4 <INTEGER>, number of inhabitants. Value examples: [95907, 95616].),\n  (A5 <INTEGER>, number of households. Value examples: [35678, 34892].),\n  (A6 <REAL>, literacy rate. Value examples: [95.6, 92.3, 89.7].),\n  (A7 <INTEGER>, number of entrepreneurs. Value examples: [1234, 1456].),\n  (A8 <INTEGERt>, number of cities. Value examples: [5, 4].),\n  (A9 <INTEGER>, number of schools. Value examples: [15, 12, 10].),\n  (A10 <INTEGER>, number of hospitals. Value examples: [8, 6, 4].),\n  (A11 <REAL>, average salary. Value examples: [12541.5, 11277].),\n  (A12 <REAL>, poverty rate. Value examples: [12.4, 9.8].),\n  (A13 <REAL>, unemployment rate. Value examples: [8.2, 7.9].),\n  (A15 <INTEGER>, number of crimes. Value examples: [256, 189].)\n]\n【Primary keys】\naccount.`account_id` | client.`client_id` | loan.`loan_id` | district.`district_id`\n【Foreign keys】\nclient.`district_id` = district.`district_id`\n【Question】\nWhat is the gender of the youngest client who opened account in the lowest average salary branch and when did this client open the account? Please list their full name.\n【Evidence】\nLater birthdate refers to younger age; A11 refers to average salary; Full name refers to first_name, last_name\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\nThe entities extracted from the 【Question】 are: \n1. gender; \n2. youngest client; \n3. account; \n4. lowest average salary branch; \n5. when did this client open the account; \n6. full name\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. gender --no related evidence **the columns about gender are related**\n2. youngest client  --Later birthdate refers to younger age; **the columns about birth date of client and the id of client are related**\n3. account --no related evidence **the columns about account or account ids are related**\n4. lowest average salary branch  --A11 refers to average salary **the columns about average salary and branch are related**\n5. when did this client open the account --no related evidence **the columns about time or date of the account are related**\n6. full name  --Full name refers to first_name, last_name **the columns about first_name, last_name of the client are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"gender\": [\"client.gender\",\"client.client_id\",\"loan.status\"],\n  \"youngest client\": [\"client.birth_date\",\"client.client_id\",\"account.date\",\"loan.date\"],\n  \"account\": [\"account.account_id\",\"loan.account_id\",\"account.date\"],\n  \"lowest average salary branch\": [\"district.A11\",\"district.district_id\",\"district.A13\"],\n  \"when did this client open the account\": [\"account.date\",\"loan.date\",\"client.birth_date\"],\n  \"full name\": [\"client.first_name\",\"client.last_name\",\"client.client_id\"]\n}\n```\nQuestion Solved.\n\n==========\n\nHere is a new example, please start answering:\n\n【DB_ID】 california_schools\n【Schema】\n# Table: frpm\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (Academic Year <TEXT>,  Academic Year. Value examples: ['2014-2015'].),\n  (County Code <TEXT>,  County Code. Value examples: ['19', '37', '30', '36', '33', '43'].),\n  (District Code <INTEGER>,  District Code.),\n  (School Code <TEXT>,  School Code. Value examples: ['0000000', '9010745', '6121081', '6121073', '6121016', '6120968'].),\n  (County Name <TEXT>,  County Name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].),\n  (District Name <TEXT>,  District Name.),\n  (School Name <TEXT>,  School Name.),\n  (District Type <TEXT>,  District Type. Value examples: ['Unified School District', 'Elementary School District', 'High School District', 'County Office of Education (COE)', 'State Board of Education', 'Statewide Benefit Charter'].),\n  (School Type <TEXT>,  School Type. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].),\n  (Educational Option Type <TEXT>,  Educational Option Type. Value examples: [None, 'Traditional', 'Continuation School', 'Alternative School of Choice', 'Community Day School', 'Special Education School', 'County Community School'].),\n  (NSLP Provision Status <TEXT>,  NSLP Provision Status. Value examples: [None, 'Provision 2', 'Breakfast Provision 2', 'CEP', 'Multiple Provision Types', 'Provision 1', 'Lunch Provision 2'].),\n  (Charter School (Y/N) <INTEGER>,  Charter School (Y/N). Value examples: [None, 0, 1].),\n  (Charter School Number <TEXT>,  Charter School Number. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1700', '1696'].),\n  (Charter Funding Type <TEXT>,  Charter Funding Type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (IRC <INTEGER>,  IRC. Value examples: [None, 0, 1].),\n  (Low Grade <TEXT>,  Low Grade. Value examples: ['K', '9', '6', '7', 'P', '5'].),\n  (High Grade <TEXT>,  High Grade. Value examples: ['12', '5', '8', '6', '3', '4'].),\n  (Enrollment (K-12) <REAL>,  Enrollment (K-12).),\n  (Free Meal Count (K-12) <REAL>,  Free Meal Count (K-12).),\n  (Percent (%) Eligible Free (K-12) <REAL>,  Percent (%) Eligible Free (K-12).),\n  (FRPM Count (K-12) <REAL>,  Free or Reduced Price Meal Count (K-12).),\n  (Percent (%) Eligible FRPM (K-12) <REAL>,  Percent (%) Eligible FRPM (K-12).),\n  (Enrollment (Ages 5-17) <REAL>,  Enrollment (Ages 5-17).),\n  (Free Meal Count (Ages 5-17) <REAL>,  Free Meal Count (Ages 5-17).),\n  (Percent (%) Eligible Free (Ages 5-17) <REAL>,  Percent (%) Eligible Free (Ages 5-17).),\n  (FRPM Count (Ages 5-17) <REAL>,  FRPM Count (Ages 5-17).),\n  (Percent (%) Eligible FRPM (Ages 5-17) <REAL>,  Percent (%) Eligible FRPM (Ages 5-17).),\n  (2013-14 CALPADS Fall 1 Certification Status <INTEGER>,  2013-14 CALPADS Fall 1 Certification Status. Value examples: [1].)\n]\n# Table: satscores\n[\n  (cds <TEXT>,  California Department Schools.),\n  (rtype <TEXT>,  rtype. Value examples: ['S', 'D'].),\n  (sname <TEXT>,  school name. Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].),\n  (dname <TEXT>,  district segment. Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].),\n  (cname <TEXT>,  county name. Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].),\n  (enroll12 <INTEGER>,  enrollment (1st-12nd grade).),\n  (NumTstTakr <INTEGER>,  Number of Test Takers in this school.),\n  (AvgScrRead <INTEGER>,  average scores in Reading.),\n  (AvgScrMath <INTEGER>,  average scores in Math.),\n  (AvgScrWrite <INTEGER>,  average scores in writing.),\n  (NumGE1500 <INTEGER>,  Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500.)\n]\n# Table: schools\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (NCESDist <TEXT>,  This field represents the 7-digit National Center for Educational Statistics (NCES) school district identification number. The first 2 digits identify the state and the last 5 digits identify the school district. Combined, they make a unique 7-digit ID for each school district.. Value examples: [None, '0622710', '0634320', '0628050', '0634410', '0614550', '0633840'].),\n  (NCESSchool <TEXT>,  This field represents the 5-digit NCES school identification number. The NCESSchool combined with the NCESDist form a unique 12-digit ID for each school.. Value examples: [None, '12271', '13785', '13747', '12909', '12311', '12003'].),\n  (StatusType <TEXT>,  This field identifies the status of the district.. Value examples: ['Active', 'Closed', 'Merged', 'Pending'].),\n  (County <TEXT>,  County name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].),\n  (District <TEXT>,  District.),\n  (School <TEXT>,  School.),\n  (Street <TEXT>,  Street.),\n  (StreetAbr <TEXT>,  The abbreviated street address of the school, district, or administrative authority’s physical location..),\n  (City <TEXT>,  City. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].),\n  (Zip <TEXT>,  Zip. Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].),\n  (State <TEXT>,  State. Value examples: [None, 'CA'].),\n  (MailStreet <TEXT>,  MailStreet.),\n  (MailStrAbr <TEXT>,  mailing street address.),\n  (MailCity <TEXT>,  mailing city. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].),\n  (MailZip <TEXT>,  mailing zip. Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].),\n  (MailState <TEXT>,  mailing state. Value examples: [None, 'CA'].),\n  (Phone <TEXT>,  Phone. Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].),\n  (Ext <TEXT>,  The phone number extension of the school, district, or administrative authority.. Value examples: [None, '200', '201', '111', '352', '221', '203'].),\n  (Website <TEXT>,  The website address of the school, district, or administrative authority..),\n  (OpenDate <DATE>,  The date the school opened.. Value examples: [None, '1980-07-01'].),\n  (ClosedDate <DATE>,  The date the school closed.. Value examples: [None, '1989-06-30'].),\n  (Charter <INTEGER>,  This field identifies a charter school.. Value examples: [None, 0, 1].),\n  (CharterNum <TEXT>,  The charter school number,. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1826', '1710'].),\n  (FundingType <TEXT>,  Indicates the charter school funding type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (DOC <TEXT>,  District Ownership Code. Value examples: ['54', '52', '00', '56', '98', '02'].),\n  (DOCType <TEXT>,  The District Ownership Code Type is the text description of the DOC category.. Value examples: ['Unified School District', 'Elementary School District', 'County Office of Education (COE)', 'High School District', 'Regional Occupation Center/Program (ROC/P)', 'State Board of Education'].),\n  (SOC <TEXT>,  The School Ownership Code is a numeric code used to identify the type of school.. Value examples: [None, '60', '66', '62', '68', '09', '69'].),\n  (SOCType <TEXT>,  The School Ownership Code Type is the text description of the type of school.. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Special Education Schools (Public)', 'District Community Day Schools'].),\n  (EdOpsCode <TEXT>,  The Education Option Code is a short text description of the type of education offered.. Value examples: [None, 'TRAD', 'CON', 'COMMDAY', 'ALTSOC', 'SPEC', 'COMM'].),\n  (EdOpsName <TEXT>,  Educational Option Name. Value examples: [None, 'Traditional', 'Continuation School', 'Community Day School', 'Alternative School of Choice', 'Special Education School', 'County Community School'].),\n  (EILCode <TEXT>,  The Educational Instruction Level Code is a short text description of the institution's type relative to the grade range served.. Value examples: [None, 'ELEM', 'HS', 'UG', 'INTMIDJR', 'ELEMHIGH', 'A'].),\n  (EILName <TEXT>,  The Educational Instruction Level Name is the long text description of the institution’s type relative to the grade range served.. Value examples: [None, 'Elementary', 'High School', 'Ungraded', 'Intermediate/Middle/Junior High', 'Elementary-High Combination', 'Adult'].),\n  (GSoffered <TEXT>,  The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.. Value examples: [None, 'K-5', '9-12', 'K-6', 'K-8', '6-8', 'K-12'].),\n  (GSserved <TEXT>,  It is the lowest grade and the highest grade of student enrollment as reported in the most recent certified CALPADS Fall 1 data collection. Only K–12 enrollment is reported through CALPADS. This field may differ from the grade span offered.. Value examples: [None, 'K-5', 'K-6', '9-12', 'K-8', '6-8', '7-8'].),\n  (Virtual <TEXT>,  This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.. Value examples: [None, 'N', 'P', 'F'].),\n  (Magnet <INTEGER>,  This field identifies whether a school is a magnet school and/or provides a magnet program.. Value examples: [None, 0, 1].),\n  (Latitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the equator measured north to south..),\n  (Longitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the prime meridian (Greenwich, England) measured from west to east..),\n  (AdmFName1 <TEXT>,  administrator's first name 1. Value examples: [None, 'David', 'Michael', 'John', 'Jennifer', 'Lisa', 'Robert'].),\n  (AdmLName1 <TEXT>,  administrator's last name 1.),\n  (AdmEmail1 <TEXT>,  administrator's email address 1.),\n  (AdmFName2 <TEXT>,  administrator's first name 2. Value examples: [None, 'Steve', 'Delphine', 'Tim', 'Michael', 'Lisa', 'Jeff'].),\n  (AdmLName2 <TEXT>,  administrator's last name 2. Value examples: [None, 'Sherman', 'Jones', 'Wilson', 'Petersen', 'Landry', 'Hambright'].),\n  (AdmEmail2 <TEXT>,  administrator's email address 2.),\n  (AdmFName3 <TEXT>,  administrator's first name 3. Value examples: [None, 'Mark', 'Eric', 'Vickie', 'Tracie', 'Shawn', 'Sarah'].),\n  (AdmLName3 <TEXT>,  administrator's last name 3. Value examples: [None, 'Zerpoli', 'Yount', 'Woodruff', 'Wood', 'Wolk', 'Spotts'].),\n  (AdmEmail3 <TEXT>,  administrator's email address 3.),\n  (LastUpdate <DATE>,  Last Update. Value examples: ['2015-06-18'].)\n]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Question】\nPlease list the phone numbers of the direct charter-funded schools that are opened after 2000/1/1.\n【Evidence】\nCharter schools refers to `Charter School (Y/N)` = 1 in the frpm\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\n", "prompt_token": 5138, "response_token": 241, "cur_total_prompt_tokens": 5138, "cur_total_response_tokens": 241}
{"idx": 4, "db_id": "california_schools", "query": "Please list the phone numbers of the direct charter-funded schools that are opened after 2000/1/1.", "evidence": "Charter schools refers to `Charter School (Y/N)` = 1 in the frpm", "difficulty": "moderate", "ground_truth": "SELECT T2.Phone FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter Funding Type` = 'Directly funded' AND T1.`Charter School (Y/N)` = 1 AND T2.OpenDate > '2000-01-01'", "send_to": "Decomposer", "response": "\nTargets: List the phone numbers of the direct charter-funded schools  \nConditions: \n1. opened after 2000/1/1 --Condition_1\n2. direct charter-funded schools --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_2 to get the first Subquery.\n##Subquery: List the phone numbers of the direct charter-funded schools\n2. Combine the first Subquery and Condition_1 to get the second Subquery.\n##Subquery: List the phone numbers of the direct charter-funded schools that are opened after 2000/1/1\n", "input_prompt": "[Instruction]\nGiven a 【query】, you need to understanding the intent of Query, and then deceompose it into Targets and Conditions. Then you need to combine Targets and Conditions into Subquerys step by step. \nFor the case where Conditions is NULL, consider Targets as the final Subquery directly. \nFor the case where Conditions are not NULL, combine Targets and the first Condition to get the first Subquery, then combine this Subquery and the next Condition into a new Subquery until all Conditions are used (which means the content of the last Subquery and the original Query is the same).\n\n[Requirements]\n-Try not to overlap Targets and Conditions.\n-Make sure the decomposed Target and Condition can cover all of the information in Query.\n-Don't change any information (specific value) in Query!\n-Mark each Subquery with ## in front of it.\n\nHere are some examples:\n==========\n\n【Query】\nShow the stadium name and the number of concerts in each stadium. Please also list the year the stadium was built. \n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the stadium name, the year the stadium built and the number of concerts in each stadium\nConditions: NULL\n\nSubqueries:\n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the stadium name, the year the stadium built and the number of concerts in each stadium\n==========\n\n【Query】\nWhat is the qualification rate for the H-11 products produced in 2023/11/2?\n【Evidence】\nqualification rate = `Numqualified(H-11)` / `production(H-11)`\n\n【Decomposition】\nTargets: List the qualification rate for the H-11 Products\nConditions:\n1. produced in 2023/11/2 --Condition_1\n\nSubqueries:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the qualification rate for the H-11 Products produced in 2023/11/2\n\n==========\n\n【Query】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n\n【Decomposition】\nTargets: List the race of institutions\nConditions: \n1. in Alabama --Condition_1\n2. number of students greater than the 90% of average number of students of all institutions --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the race of institution in Alabama\n2. Conbine the first Subquery and Conditon_2 to get the seconed Subquery.\n##Subquery: List the race of institutions in Alabama with number of number of students greater than the 90% of average number of students of all institutions\n\n==========\n\n【Query】\nWhich president got a higher approval rating, Joseph Biden or Donald Trump?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\nConditions: \nNULL\n\nSubqueries: \n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\n\n==========\n\n【Query】\nFor movie id 1269, how many users, who was a paying subscriber and was eligible for trial when he rated the movie, gave the movie a rating score of less than or equal to 2?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the number of users\nConditions:\n1. was a paying subscriber --Condition_1\n2. was eligible for trial --Condition_2\n3. for movie id 1269, gave the movie a rating score of less than or equal to 2 --Condition3\n\nSubquerys:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the number of users who was a paying subscriber\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial\n3. Combine the second Subquery and Condition_3 to get the third Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial and gave the movie whose id is 1269 a rating score of less than or equal to 2\n\n==========\n\nHere is a new query need to be decomposed:\n\n【Query】\nPlease list the phone numbers of the direct charter-funded schools that are opened after 2000/1/1.\n【Evidence】\nCharter schools refers to `Charter School (Y/N)` = 1 in the frpm\n\n【Decomposition】\n", "prompt_token": 1056, "response_token": 119, "cur_total_prompt_tokens": 6194, "cur_total_response_tokens": 360}
{"idx": 4, "db_id": "california_schools", "query": "Please list the phone numbers of the direct charter-funded schools that are opened after 2000/1/1.", "evidence": "Charter schools refers to `Charter School (Y/N)` = 1 in the frpm", "difficulty": "moderate", "ground_truth": "SELECT T2.Phone FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter Funding Type` = 'Directly funded' AND T1.`Charter School (Y/N)` = 1 AND T2.OpenDate > '2000-01-01'", "send_to": "Generator", "response": "\nTo answer the question \"List the phone numbers of the direct charter-funded schools,\" we need to follow these steps:\n\n1. **Identify the relevant columns**: \n   - We need the phone numbers from the `schools` table, which corresponds to `schools.Phone`.\n   - We also need to filter for direct charter-funded schools, which is indicated by the `Charter Funding Type` in the `frpm` table.\n\n2. **Understand the evidence**: \n   - The evidence states that charter schools are identified by `Charter School (Y/N)` = 1 in the `frpm` table. \n   - We need to find those that are directly funded, which implies we should look for `Charter Funding Type` = 'Directly funded'.\n\n3. **Establish the connection between tables**: \n   - The `frpm` table is connected to the `schools` table through the `CDSCode` column. We will need to join these two tables to get the necessary information.\n\n4. **Construct the SQL query**: \n   - We will select the phone numbers from the `schools` table where the corresponding entries in the `frpm` table indicate that the school is a charter school and is directly funded.\n\nHere’s the SQL query that meets these requirements:\n\n```sql\nSELECT S.`Phone`\n  FROM schools AS S\n  JOIN frpm AS F\n  ON S.`CDSCode` = F.`CDSCode`\n  WHERE F.`Charter School (Y/N)` = 1 \n    AND F.`Charter Funding Type` = 'Directly funded'\n```\n\n### Explanation of the SQL:\n- **SELECT S.`Phone`**: We are selecting the phone numbers from the `schools` table.\n- **FROM schools AS S**: We are using the `schools` table and aliasing it as `S`.\n- **JOIN frpm AS F ON S.`CDSCode` = F.`CDSCode`**: We are joining the `frpm` table (aliased as `F`) on the `CDSCode` to connect the two tables.\n- **WHERE F.`Charter School (Y/N)` = 1**: This condition filters for charter schools.\n- **AND F.`Charter Funding Type` = 'Directly funded'**: This condition ensures we only get those charter schools that are directly funded.\n\nThis SQL query will return the phone numbers of all direct charter-funded schools.\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】and a 【Question】, you need to use valid SQLite and understand the database and knowledge so that you can generate a good SQL for the 【Question】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# stadium: [Stadium_ID (INTEGER), Location (TEXT), Name (TEXT)]\n# concert: [concert_ID (INTEGER), concert_Name (TEXT), Stadium_ID (INTEGER)]\n【Primary keys】\nstadium.`Stadium_ID` | concert.`concert_ID`\n【Foreign keys】\nconcert.`Stadium_ID` = stadium.`Stadium_ID`\n【Detailed descriptions of tables and columns】\nstadium.`Stadium_ID`: The column 'Stadium_ID' in Table <stadium> has column descriptions of \"stadium id\". Value examples: [1, 2, 3, 4, 5, 6].\nstadium.`Name`:  The column 'Name' in Table <stadium> has column descriptions of \"name of stadium\". Value examples: [\"Stark's Park\", 'Somerset Park', 'Recreation Park', 'Hampden Park', 'Glebe Park', 'Gayfield Park'].\nstadium.`Location`: The column 'Location' in Table <stadium> has column descriptions of \"location of stadium\". Value examples: ['Stirling Albion', 'Raith Rovers', \"Queen's Park\", 'Peterhead', 'East Fife', 'Brechin City'].\nconcert.`concert_ID`: The column 'concert_ID' in Table <concert> has column descriptions of \"concert id\". Value examples: [1, 2, 3, 4, 5, 6].\nconcert.`concert_Name`: The column 'concert_Name' in Table <concert> has column descriptions of \"concert name\". Value examples: ['Week 1', 'Week 2', 'Super bootcamp', 'Home Visits', 'Auditions'].\nconcert.`Stadium_ID`: The column 'Stadium_ID' in Table <concert> has column descriptions of \"stadium id\". Value examples: [2, 9, 7, 10, 1].\n【Evidence】\nNULL\n【Question】\nShow the stadium name and the number of concerts in each stadium.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: Show the stadium name and the number of concerts in each stadium.\nTargets for `SELECT`: the stadium name and the number of concerts\nhints from 【Evidence】:NULL\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the stadium name refers to stadium.`Name`, the number of concerts refers to COUNT(concert.`concert_ID`), each stadium refers to stadium.`Stadium_ID`\nConnection of tables: include tables <stadium> and <concert>, get connected keys from 【Foreign keys】: concert.`Stadium_ID` = stadium.`Stadium_ID`\nFinal SQL:\n```sql\nSELECT T1.`Name`, COUNT(T2.concert_ID) AS num_concerts\n  FROM stadium AS T1\n  JOIN concert AS T2\n  ON T1.`Stadium_ID` = T2.`Stadium_ID`\n  GROUP BY T1.`Stadium_ID`\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); name of the car refers to car_name\n【Question】\nWhat is the fastest car made by Japan?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ncountry.`country` = 'Japan'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: What is the fastest car made by Japan?\nTargets for `SELECT`: the name of the fastest car\nhints from 【Evidence】: the fastest refers to max(horsepower); name of the car refers to car_name\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: car refers to data.`car_name`, the fastest refers to MAX(data.`horsepower`), Japan refers to country.`country`\nConnection of tables: includes tables <data> and <country>, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`car_name` \n  FROM data AS T1 \n  INNER JOIN production AS T2 \n  ON T1.`ID` = T2.`ID` \n  INNER JOIN country AS T3 \n  ON T3.`origin` = T2.`country` \n  WHERE T3.`country` = 'Japan' \n  ORDER BY T1.`horsepower` DESC LIMIT 1\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`chronname`: The column 'chronname' in Table <institution_details> has column descriptions of \"Institution name\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \n【Evidence】\nnumber of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the chronname of institutions with number of students greater than the 90% of average number of students of all institutions?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: List the chroname of institutions with number of students greater than the 90% of average number of students of all institutions?\nTargets for `SELECT`: the chroname of institutions\nhints from 【Evidence】: number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the chronname of institutions refers to institution_details.`chronname`, number of students refers to institution_details.`student_count`\nConnection of tables: include only one table <institution_details>, no connection\nFinal SQL:\n```sql\nSELECT DISTINCT `chroname`\n  FROM institution_details\n  WHERE `student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details\n  ) \n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\nfrpm.`CDSCode`: The column 'CDSCode' in Table <frpm> has column descriptions of \"CDSCode\". \nfrpm.`Academic Year`: The column 'Academic Year' in Table <frpm> has column descriptions of \"Academic Year\".  Value examples: ['2014-2015'].\nfrpm.`Charter School (Y/N)`: The column 'Charter School (Y/N)' in Table <frpm> has column descriptions of \"Charter School (Y/N)\".  Value examples: [None, 0, 1].\nfrpm.`Charter Funding Type`: The column 'Charter Funding Type' in Table <frpm> has column descriptions of \"Charter Funding Type\".  Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].\nschools.`CDSCode`: The column 'CDSCode' in Table <schools> has column descriptions of \"CDSCode\". \nschools.`Phone`: The column 'Phone' in Table <schools> has column descriptions of \"Phone\".  Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].\nschools.`Ext`: The column 'Ext' in Table <schools> has column descriptions of \"The phone number extension of the school, district, or administrative authority.\".  Value examples: [None, '200', '201', '111', '352', '221', '203'].\nschools.`OpenDate`: The column 'OpenDate' in Table <schools> has column descriptions of \"The date the school opened.\".  Value examples: [None, '1980-07-01'].\nschools.`ClosedDate`: The column 'ClosedDate' in Table <schools> has column descriptions of \"The date the school closed.\".  Value examples: [None, '1989-06-30'].\n\n【Evidence】\nCharter schools refers to `Charter School (Y/N)` = 1 in the frpm\n【Question】\nList the phone numbers of the direct charter-funded schools\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n", "prompt_token": 3694, "response_token": 500, "cur_total_prompt_tokens": 9888, "cur_total_response_tokens": 860}
{"idx": 4, "db_id": "california_schools", "query": "Please list the phone numbers of the direct charter-funded schools that are opened after 2000/1/1.", "evidence": "Charter schools refers to `Charter School (Y/N)` = 1 in the frpm", "difficulty": "moderate", "ground_truth": "SELECT T2.Phone FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter Funding Type` = 'Directly funded' AND T1.`Charter School (Y/N)` = 1 AND T2.OpenDate > '2000-01-01'", "send_to": "Refiner", "response": "\nAnalysis:\nThe original SQL query attempts to select phone numbers from the `schools` table for charter-funded schools based on the `frpm` table. However, it encounters an error due to the presence of `None` values in the `Phone` column. To resolve this, we need to add a condition to filter out any `None` values from the `Phone` column. Additionally, the condition for `Charter Funding Type` is not necessary for the task, as the query only requires charter-funded schools.\n\nCorrect SQL:\n```sql\nSELECT S.`Phone` FROM schools AS S JOIN frpm AS F ON S.`CDSCode` = F.`CDSCode` WHERE F.`Charter School (Y/N)` = 1 AND S.`Phone` IS NOT NULL\n```\n\n【Evidence】\nThe query now correctly filters for charter schools (where `Charter School (Y/N)` = 1) and ensures that the `Phone` column does not contain `None` values, thus preventing any errors related to null values.\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nCharter schools refers to `Charter School (Y/N)` = 1 in the frpm\n【Query】\n-- List the phone numbers of the direct charter-funded schools\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\nfrpm.`CDSCode`: The column 'CDSCode' in Table <frpm> has column descriptions of \"CDSCode\". \nfrpm.`Academic Year`: The column 'Academic Year' in Table <frpm> has column descriptions of \"Academic Year\".  Value examples: ['2014-2015'].\nfrpm.`Charter School (Y/N)`: The column 'Charter School (Y/N)' in Table <frpm> has column descriptions of \"Charter School (Y/N)\".  Value examples: [None, 0, 1].\nfrpm.`Charter Funding Type`: The column 'Charter Funding Type' in Table <frpm> has column descriptions of \"Charter Funding Type\".  Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].\nschools.`CDSCode`: The column 'CDSCode' in Table <schools> has column descriptions of \"CDSCode\". \nschools.`Phone`: The column 'Phone' in Table <schools> has column descriptions of \"Phone\".  Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].\nschools.`Ext`: The column 'Ext' in Table <schools> has column descriptions of \"The phone number extension of the school, district, or administrative authority.\".  Value examples: [None, '200', '201', '111', '352', '221', '203'].\nschools.`OpenDate`: The column 'OpenDate' in Table <schools> has column descriptions of \"The date the school opened.\".  Value examples: [None, '1980-07-01'].\nschools.`ClosedDate`: The column 'ClosedDate' in Table <schools> has column descriptions of \"The date the school closed.\".  Value examples: [None, '1989-06-30'].\n\n【old SQL】\n```sql\nSELECT S.`Phone` FROM schools AS S JOIN frpm AS F ON S.`CDSCode` = F.`CDSCode` WHERE F.`Charter School (Y/N)` = 1 AND F.`Charter Funding Type` = 'Directly funded' \n```\n【SQLite error】 \nexist None value, you can add `IS NOT NULL` in SQL\n【Exception class】\n\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 1553, "response_token": 213, "cur_total_prompt_tokens": 11441, "cur_total_response_tokens": 1073}
{"idx": 4, "db_id": "california_schools", "query": "Please list the phone numbers of the direct charter-funded schools that are opened after 2000/1/1.", "evidence": "Charter schools refers to `Charter School (Y/N)` = 1 in the frpm", "difficulty": "moderate", "ground_truth": "SELECT T2.Phone FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter Funding Type` = 'Directly funded' AND T1.`Charter School (Y/N)` = 1 AND T2.OpenDate > '2000-01-01'", "send_to": "Generator", "response": "\nTo generate the final SQL query for the question, we need to incorporate the additional condition from the question regarding the opening date of the schools. The evidence indicates that we are looking for direct charter-funded schools, which is already reflected in the Sub-SQL. \n\n### Step-by-step Breakdown:\n\n1. **Understanding the Sub-SQL**: \n   The provided Sub-SQL is:\n   ```sql\n   SELECT S.`Phone` FROM schools AS S JOIN frpm AS F ON S.`CDSCode` = F.`CDSCode` WHERE F.`Charter School (Y/N)` = 1 AND S.`Phone` IS NOT NULL \n   ```\n   This query selects the phone numbers of charter schools where the phone number is not null.\n\n2. **Adding the Additional Condition**: \n   The question specifies that we need to filter for schools that opened after January 1, 2000. This means we need to add a condition to check the `OpenDate` in the `schools` table.\n\n3. **Final SQL Construction**:\n   We will modify the Sub-SQL to include the condition for the `OpenDate`. The condition will be:\n   ```sql\n   S.`OpenDate` > '2000-01-01'\n   ```\n\n4. **Final SQL Query**:\n   Combining everything, the final SQL query will look like this:\n   ```sql\n   SELECT S.`Phone` \n   FROM schools AS S \n   JOIN frpm AS F ON S.`CDSCode` = F.`CDSCode` \n   WHERE F.`Charter School (Y/N)` = 1 \n   AND S.`Phone` IS NOT NULL \n   AND S.`OpenDate` > '2000-01-01'\n   ```\n\n### Complete SQL:\n```sql\nSELECT S.`Phone` \nFROM schools AS S \nJOIN frpm AS F ON S.`CDSCode` = F.`CDSCode` \nWHERE F.`Charter School (Y/N)` = 1 \nAND S.`Phone` IS NOT NULL \nAND S.`OpenDate` > '2000-01-01'\n```\n\nThis SQL query will return the phone numbers of direct charter-funded schools that have opened after January 1, 2000, fulfilling the requirements of the question.\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】, a 【Question】, a 【Subquesion】 extracted from 【Question】 and a 【Sub-SQL】 for the 【Subquestion】, you need to use valid SQLite and understand the database and knowledge, and then generate a complete SQL for the 【Question】 based on 【Sub-SQL】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); made by Japan refers to country = 'Japan'\n【Question】\nWhat is the price of the fastest car made by Japan?\n【Subquestion】\nWhat is the price of the fastest car?\n【Sub-SQL】\n```\nSELECT T1.`price` FROM price AS T1 INNER JOIN data AS T2 ON T2.`ID` = T1.`ID` ORDER BY T2.`horsepower` DESC LIMIT 1\n```\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\n【Subquestion】 is decomposed from 【Question】, now we provide Sub-SQL corresponding to Subquestion, you just need to complete the remaining conditions based on Sub-SQL to generate SQL for 【Question】. Consider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, and then generate SQL after thinking step by step:\nhints from 【Evidence】: the fastest refers to max(horsepower); made by Japan refers to country = 'Japan';\nFind necessary columns from 【Database schema】 in addition to Sub-SQL: Japan refers to country.`country`\nConnection of tables: the connection of <data> and <country> is needed, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`price` \n  FROM price AS T1 \n  INNER JOIN data AS T2\n  on T2.`ID` = T1.`ID`\n  INNER JOIN production AS T3 \n  ON T3.`ID` = T2.`ID` \n  INNER JOIN country AS T4 \n  ON T4.`origin` = T3.`country` \n  WHERE T4.`country` = 'Japan' \n  ORDER BY T2.`horsepower` DESC LIMIT 1\n```\n\nQuestion solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`state`: The column 'state' in Table <institution_details> has column descriptions of \"Institution state\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \ninstitution_grads.`race`: The column 'race' in Table <institution_grads> has column descriptions of \"race/ethnicity of students\". Value examples: ['X', 'Ai', 'A', 'B', 'H'].\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Subquestion】\nList the race of institutions in 'Alabama'. \n【Sub-SQL】\n```\nSELECT DISTINCT T1.`race` FROM institution_grads AS T1 INNER JOIN institution_details AS T2 ON T1.`unitid` = T2.`unitid` WHERE T2.`state` = 'Alabama'\n```\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ninstitution_details.`city` = 'Alabama'; institution_details.`state` = 'Alabama'\n\n【Subquestion】 is decomposed from 【Question】, now we provide Sub-SQL corresponding to Subquestion, you just need to complete the remaining conditions based on Sub-SQL to generate SQL for 【Question】. Consider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, and then generate SQL after thinking step by step:\nhints from 【Evidence】: Alabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFind necessary columns from 【Database schema】 in addition to Sub-SQL: number of students refers to institution_details.`student_count`\nConnection of tables: the table <institution_details> is already in Sub-SQL, no more connection is needed\nFinal SQL:\n```sql\nSELECT DISTINCT T1.`race` \n  FROM institution_grads AS T1 \n  INNER JOIN institution_details AS T2 \n  ON T1.`unitid` = T2.`unitid` \n  WHERE T2.`student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details \n  ) \n  AND T2.`state` = 'Alabama'\n```\n\nQuestion solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\nfrpm.`CDSCode`: The column 'CDSCode' in Table <frpm> has column descriptions of \"CDSCode\". \nfrpm.`Academic Year`: The column 'Academic Year' in Table <frpm> has column descriptions of \"Academic Year\".  Value examples: ['2014-2015'].\nfrpm.`Charter School (Y/N)`: The column 'Charter School (Y/N)' in Table <frpm> has column descriptions of \"Charter School (Y/N)\".  Value examples: [None, 0, 1].\nfrpm.`Charter Funding Type`: The column 'Charter Funding Type' in Table <frpm> has column descriptions of \"Charter Funding Type\".  Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].\nschools.`CDSCode`: The column 'CDSCode' in Table <schools> has column descriptions of \"CDSCode\". \nschools.`Phone`: The column 'Phone' in Table <schools> has column descriptions of \"Phone\".  Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].\nschools.`Ext`: The column 'Ext' in Table <schools> has column descriptions of \"The phone number extension of the school, district, or administrative authority.\".  Value examples: [None, '200', '201', '111', '352', '221', '203'].\nschools.`OpenDate`: The column 'OpenDate' in Table <schools> has column descriptions of \"The date the school opened.\".  Value examples: [None, '1980-07-01'].\nschools.`ClosedDate`: The column 'ClosedDate' in Table <schools> has column descriptions of \"The date the school closed.\".  Value examples: [None, '1989-06-30'].\n\n【Evidence】\nCharter schools refers to `Charter School (Y/N)` = 1 in the frpm\n【Question】\nPlease list the phone numbers of the direct charter-funded schools that are opened after 2000/1/1.\n【Subquestion】\nList the phone numbers of the direct charter-funded schools\n【Sub-SQL】\nSELECT S.`Phone` FROM schools AS S JOIN frpm AS F ON S.`CDSCode` = F.`CDSCode` WHERE F.`Charter School (Y/N)` = 1 AND S.`Phone` IS NOT NULL \n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\n【Subquestion】 is decomposed from 【Question】, now we provide Sub-SQL corresponding to Subquestion, you just need to complete the remaining conditions based on Sub-SQL to generate SQL for 【Question】. Consider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, and then generate SQL after thinking step by step:\n", "prompt_token": 3348, "response_token": 472, "cur_total_prompt_tokens": 14789, "cur_total_response_tokens": 1545}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Soft_Schema_Linker", "response": "\nThe entities extracted from the 【Question】 are: \n1. schools\n2. average score in Math\n3. SAT test\n4. exclusively virtual\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. schools --no related evidence **the columns about schools are related**\n2. average score in Math --no related evidence **the columns about average scores in Math are related**\n3. SAT test --no related evidence **the columns about SAT test scores are related**\n4. exclusively virtual --Exclusively virtual refers to Virtual = 'F' **the columns about virtual instruction are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"schools\": [\"schools.CDSCode\", \"schools.School\", \"schools.District\"],\n  \"average score in Math\": [\"satscores.AvgScrMath\", \"satscores.NumTstTakr\", \"satscores.enroll12\"],\n  \"SAT test\": [\"satscores.cds\", \"satscores.sname\", \"satscores.dname\"],\n  \"exclusively virtual\": [\"schools.Virtual\", \"schools.School\", \"schools.District\"]\n}\n```\n", "input_prompt": "As an experienced and professional database administrator, your task is to analyze a user question and a database schema to provide relevant information. The database schema consists of table descriptions, each containing multiple column descriptions. Your goal is to extract the entities from question and identify the relevant tables and columns based on these entities and the evidence provided.\n\n[Instruction]:\n1. Extract the mentioned entities from the user question. Make sure all of the entities are extracted. \n2. For each entity, keep at least 3 related columns.\n4. Your output should include entity extraction, analysis and related database schema.\n5. The related database schema should be in JSON format.\n6. Each column's information in provided 【Schema】 is in this format: (column, description. Value examples<optional>)\n\n[Requirements]:\n1. Sort the related columns in each list corresponding to each entity in descending order of relevance.\n2. The chosen columns should be in this format: <table.column>.\n3. Make sure each chosen list is not empty. The value [] will be punished. \n4.【Matched values】 may contain redundant or useless information in addition to the correct matching values, so you need to select the useful information in conjunction with the specific column names and descriptions.\n5. An entity may not have a corresponding evidence, which requires you to find the relevant columns yourself through your understanding of the database schema.\n\nHere is a typical example:\n\n==========\n【DB_ID】 banking_system\n【Schema】\n# Table: account\n[\n  (account_id <INTEGER>, the id of the account. Value examples: [11382, 11362, 2, 1, 2367].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (frequency <TEXT>, frequency of the acount. Value examples: ['POPLATEK MESICNE', 'POPLATEK TYDNE', 'POPLATEK PO OBRATU'].),\n  (date <DATE>, the creation date of the account. Value examples: ['1997-12-29', '1997-12-28'].)\n]\n# Table: client\n[\n  (client_id <INTEGER>, the unique number. Value examples: [13998, 13971, 2, 1, 2839].),\n  (gender <TEXT>, gender. Value examples: ['M', 'F']. And F：female . M：male ),\n  (birth_date <DATE>, birth date. Value examples: ['1987-09-27', '1986-08-13'].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (first_name <TEXT>, first_name.),\n  (last_name <TEXT>, last_name.)\n]\n# Table: loan\n[\n  (loan_id <INTEGER>, the id number identifying the loan data. Value examples: [4959, 4960, 4961].),\n  (account_id <INTEGER>, the id number identifying the account. Value examples: [10, 80, 55, 43].),\n  (date <DATE>, the date when the loan is approved. Value examples: ['1998-07-12', '1998-04-19'].),\n  (amount <INTEGER>, the id number identifying the loan data. Value examples: [1567, 7877, 9988].),\n  (duration <INTEGER>, the id number identifying the loan data. Value examples: [60, 48, 24, 12, 36].),\n  (payments <INTEGER>, the id number identifying the loan data. Value examples: [3456, 8972, 9845].),\n  (status <TEXT>, the id number identifying the loan data. Value examples: ['C', 'A', 'D', 'B'].)\n]\n# Table: district\n[\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76].),\n  (A2 <REAL>, area in square kilometers. Value examples: [50.5, 48.9].),\n  (A4 <INTEGER>, number of inhabitants. Value examples: [95907, 95616].),\n  (A5 <INTEGER>, number of households. Value examples: [35678, 34892].),\n  (A6 <REAL>, literacy rate. Value examples: [95.6, 92.3, 89.7].),\n  (A7 <INTEGER>, number of entrepreneurs. Value examples: [1234, 1456].),\n  (A8 <INTEGERt>, number of cities. Value examples: [5, 4].),\n  (A9 <INTEGER>, number of schools. Value examples: [15, 12, 10].),\n  (A10 <INTEGER>, number of hospitals. Value examples: [8, 6, 4].),\n  (A11 <REAL>, average salary. Value examples: [12541.5, 11277].),\n  (A12 <REAL>, poverty rate. Value examples: [12.4, 9.8].),\n  (A13 <REAL>, unemployment rate. Value examples: [8.2, 7.9].),\n  (A15 <INTEGER>, number of crimes. Value examples: [256, 189].)\n]\n【Primary keys】\naccount.`account_id` | client.`client_id` | loan.`loan_id` | district.`district_id`\n【Foreign keys】\nclient.`district_id` = district.`district_id`\n【Question】\nWhat is the gender of the youngest client who opened account in the lowest average salary branch and when did this client open the account? Please list their full name.\n【Evidence】\nLater birthdate refers to younger age; A11 refers to average salary; Full name refers to first_name, last_name\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\nThe entities extracted from the 【Question】 are: \n1. gender; \n2. youngest client; \n3. account; \n4. lowest average salary branch; \n5. when did this client open the account; \n6. full name\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. gender --no related evidence **the columns about gender are related**\n2. youngest client  --Later birthdate refers to younger age; **the columns about birth date of client and the id of client are related**\n3. account --no related evidence **the columns about account or account ids are related**\n4. lowest average salary branch  --A11 refers to average salary **the columns about average salary and branch are related**\n5. when did this client open the account --no related evidence **the columns about time or date of the account are related**\n6. full name  --Full name refers to first_name, last_name **the columns about first_name, last_name of the client are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"gender\": [\"client.gender\",\"client.client_id\",\"loan.status\"],\n  \"youngest client\": [\"client.birth_date\",\"client.client_id\",\"account.date\",\"loan.date\"],\n  \"account\": [\"account.account_id\",\"loan.account_id\",\"account.date\"],\n  \"lowest average salary branch\": [\"district.A11\",\"district.district_id\",\"district.A13\"],\n  \"when did this client open the account\": [\"account.date\",\"loan.date\",\"client.birth_date\"],\n  \"full name\": [\"client.first_name\",\"client.last_name\",\"client.client_id\"]\n}\n```\nQuestion Solved.\n\n==========\n\nHere is a new example, please start answering:\n\n【DB_ID】 california_schools\n【Schema】\n# Table: frpm\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (Academic Year <TEXT>,  Academic Year. Value examples: ['2014-2015'].),\n  (County Code <TEXT>,  County Code. Value examples: ['19', '37', '30', '36', '33', '43'].),\n  (District Code <INTEGER>,  District Code.),\n  (School Code <TEXT>,  School Code. Value examples: ['0000000', '9010745', '6121081', '6121073', '6121016', '6120968'].),\n  (County Name <TEXT>,  County Name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].),\n  (District Name <TEXT>,  District Name.),\n  (School Name <TEXT>,  School Name.),\n  (District Type <TEXT>,  District Type. Value examples: ['Unified School District', 'Elementary School District', 'High School District', 'County Office of Education (COE)', 'State Board of Education', 'Statewide Benefit Charter'].),\n  (School Type <TEXT>,  School Type. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].),\n  (Educational Option Type <TEXT>,  Educational Option Type. Value examples: [None, 'Traditional', 'Continuation School', 'Alternative School of Choice', 'Community Day School', 'Special Education School', 'County Community School'].),\n  (NSLP Provision Status <TEXT>,  NSLP Provision Status. Value examples: [None, 'Provision 2', 'Breakfast Provision 2', 'CEP', 'Multiple Provision Types', 'Provision 1', 'Lunch Provision 2'].),\n  (Charter School (Y/N) <INTEGER>,  Charter School (Y/N). Value examples: [None, 0, 1].),\n  (Charter School Number <TEXT>,  Charter School Number. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1700', '1696'].),\n  (Charter Funding Type <TEXT>,  Charter Funding Type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (IRC <INTEGER>,  IRC. Value examples: [None, 0, 1].),\n  (Low Grade <TEXT>,  Low Grade. Value examples: ['K', '9', '6', '7', 'P', '5'].),\n  (High Grade <TEXT>,  High Grade. Value examples: ['12', '5', '8', '6', '3', '4'].),\n  (Enrollment (K-12) <REAL>,  Enrollment (K-12).),\n  (Free Meal Count (K-12) <REAL>,  Free Meal Count (K-12).),\n  (Percent (%) Eligible Free (K-12) <REAL>,  Percent (%) Eligible Free (K-12).),\n  (FRPM Count (K-12) <REAL>,  Free or Reduced Price Meal Count (K-12).),\n  (Percent (%) Eligible FRPM (K-12) <REAL>,  Percent (%) Eligible FRPM (K-12).),\n  (Enrollment (Ages 5-17) <REAL>,  Enrollment (Ages 5-17).),\n  (Free Meal Count (Ages 5-17) <REAL>,  Free Meal Count (Ages 5-17).),\n  (Percent (%) Eligible Free (Ages 5-17) <REAL>,  Percent (%) Eligible Free (Ages 5-17).),\n  (FRPM Count (Ages 5-17) <REAL>,  FRPM Count (Ages 5-17).),\n  (Percent (%) Eligible FRPM (Ages 5-17) <REAL>,  Percent (%) Eligible FRPM (Ages 5-17).),\n  (2013-14 CALPADS Fall 1 Certification Status <INTEGER>,  2013-14 CALPADS Fall 1 Certification Status. Value examples: [1].)\n]\n# Table: satscores\n[\n  (cds <TEXT>,  California Department Schools.),\n  (rtype <TEXT>,  rtype. Value examples: ['S', 'D'].),\n  (sname <TEXT>,  school name. Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].),\n  (dname <TEXT>,  district segment. Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].),\n  (cname <TEXT>,  county name. Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].),\n  (enroll12 <INTEGER>,  enrollment (1st-12nd grade).),\n  (NumTstTakr <INTEGER>,  Number of Test Takers in this school.),\n  (AvgScrRead <INTEGER>,  average scores in Reading.),\n  (AvgScrMath <INTEGER>,  average scores in Math.),\n  (AvgScrWrite <INTEGER>,  average scores in writing.),\n  (NumGE1500 <INTEGER>,  Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500.)\n]\n# Table: schools\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (NCESDist <TEXT>,  This field represents the 7-digit National Center for Educational Statistics (NCES) school district identification number. The first 2 digits identify the state and the last 5 digits identify the school district. Combined, they make a unique 7-digit ID for each school district.. Value examples: [None, '0622710', '0634320', '0628050', '0634410', '0614550', '0633840'].),\n  (NCESSchool <TEXT>,  This field represents the 5-digit NCES school identification number. The NCESSchool combined with the NCESDist form a unique 12-digit ID for each school.. Value examples: [None, '12271', '13785', '13747', '12909', '12311', '12003'].),\n  (StatusType <TEXT>,  This field identifies the status of the district.. Value examples: ['Active', 'Closed', 'Merged', 'Pending'].),\n  (County <TEXT>,  County name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].),\n  (District <TEXT>,  District.),\n  (School <TEXT>,  School.),\n  (Street <TEXT>,  Street.),\n  (StreetAbr <TEXT>,  The abbreviated street address of the school, district, or administrative authority’s physical location..),\n  (City <TEXT>,  City. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].),\n  (Zip <TEXT>,  Zip. Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].),\n  (State <TEXT>,  State. Value examples: [None, 'CA'].),\n  (MailStreet <TEXT>,  MailStreet.),\n  (MailStrAbr <TEXT>,  mailing street address.),\n  (MailCity <TEXT>,  mailing city. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].),\n  (MailZip <TEXT>,  mailing zip. Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].),\n  (MailState <TEXT>,  mailing state. Value examples: [None, 'CA'].),\n  (Phone <TEXT>,  Phone. Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].),\n  (Ext <TEXT>,  The phone number extension of the school, district, or administrative authority.. Value examples: [None, '200', '201', '111', '352', '221', '203'].),\n  (Website <TEXT>,  The website address of the school, district, or administrative authority..),\n  (OpenDate <DATE>,  The date the school opened.. Value examples: [None, '1980-07-01'].),\n  (ClosedDate <DATE>,  The date the school closed.. Value examples: [None, '1989-06-30'].),\n  (Charter <INTEGER>,  This field identifies a charter school.. Value examples: [None, 0, 1].),\n  (CharterNum <TEXT>,  The charter school number,. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1826', '1710'].),\n  (FundingType <TEXT>,  Indicates the charter school funding type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (DOC <TEXT>,  District Ownership Code. Value examples: ['54', '52', '00', '56', '98', '02'].),\n  (DOCType <TEXT>,  The District Ownership Code Type is the text description of the DOC category.. Value examples: ['Unified School District', 'Elementary School District', 'County Office of Education (COE)', 'High School District', 'Regional Occupation Center/Program (ROC/P)', 'State Board of Education'].),\n  (SOC <TEXT>,  The School Ownership Code is a numeric code used to identify the type of school.. Value examples: [None, '60', '66', '62', '68', '09', '69'].),\n  (SOCType <TEXT>,  The School Ownership Code Type is the text description of the type of school.. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Special Education Schools (Public)', 'District Community Day Schools'].),\n  (EdOpsCode <TEXT>,  The Education Option Code is a short text description of the type of education offered.. Value examples: [None, 'TRAD', 'CON', 'COMMDAY', 'ALTSOC', 'SPEC', 'COMM'].),\n  (EdOpsName <TEXT>,  Educational Option Name. Value examples: [None, 'Traditional', 'Continuation School', 'Community Day School', 'Alternative School of Choice', 'Special Education School', 'County Community School'].),\n  (EILCode <TEXT>,  The Educational Instruction Level Code is a short text description of the institution's type relative to the grade range served.. Value examples: [None, 'ELEM', 'HS', 'UG', 'INTMIDJR', 'ELEMHIGH', 'A'].),\n  (EILName <TEXT>,  The Educational Instruction Level Name is the long text description of the institution’s type relative to the grade range served.. Value examples: [None, 'Elementary', 'High School', 'Ungraded', 'Intermediate/Middle/Junior High', 'Elementary-High Combination', 'Adult'].),\n  (GSoffered <TEXT>,  The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.. Value examples: [None, 'K-5', '9-12', 'K-6', 'K-8', '6-8', 'K-12'].),\n  (GSserved <TEXT>,  It is the lowest grade and the highest grade of student enrollment as reported in the most recent certified CALPADS Fall 1 data collection. Only K–12 enrollment is reported through CALPADS. This field may differ from the grade span offered.. Value examples: [None, 'K-5', 'K-6', '9-12', 'K-8', '6-8', '7-8'].),\n  (Virtual <TEXT>,  This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.. Value examples: [None, 'N', 'P', 'F'].),\n  (Magnet <INTEGER>,  This field identifies whether a school is a magnet school and/or provides a magnet program.. Value examples: [None, 0, 1].),\n  (Latitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the equator measured north to south..),\n  (Longitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the prime meridian (Greenwich, England) measured from west to east..),\n  (AdmFName1 <TEXT>,  administrator's first name 1. Value examples: [None, 'David', 'Michael', 'John', 'Jennifer', 'Lisa', 'Robert'].),\n  (AdmLName1 <TEXT>,  administrator's last name 1.),\n  (AdmEmail1 <TEXT>,  administrator's email address 1.),\n  (AdmFName2 <TEXT>,  administrator's first name 2. Value examples: [None, 'Steve', 'Delphine', 'Tim', 'Michael', 'Lisa', 'Jeff'].),\n  (AdmLName2 <TEXT>,  administrator's last name 2. Value examples: [None, 'Sherman', 'Jones', 'Wilson', 'Petersen', 'Landry', 'Hambright'].),\n  (AdmEmail2 <TEXT>,  administrator's email address 2.),\n  (AdmFName3 <TEXT>,  administrator's first name 3. Value examples: [None, 'Mark', 'Eric', 'Vickie', 'Tracie', 'Shawn', 'Sarah'].),\n  (AdmLName3 <TEXT>,  administrator's last name 3. Value examples: [None, 'Zerpoli', 'Yount', 'Woodruff', 'Wood', 'Wolk', 'Spotts'].),\n  (AdmEmail3 <TEXT>,  administrator's email address 3.),\n  (LastUpdate <DATE>,  Last Update. Value examples: ['2015-06-18'].)\n]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Question】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\n", "prompt_token": 5125, "response_token": 256, "cur_total_prompt_tokens": 19914, "cur_total_response_tokens": 1801}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Decomposer", "response": "\nTargets: List the number of schools\nConditions:\n1. with an average score in Math under 400 in the SAT test --Condition_1\n2. are exclusively virtual --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the number of schools with an average score in Math under 400 in the SAT test\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of schools with an average score in Math under 400 in the SAT test that are exclusively virtual\n", "input_prompt": "[Instruction]\nGiven a 【query】, you need to understanding the intent of Query, and then deceompose it into Targets and Conditions. Then you need to combine Targets and Conditions into Subquerys step by step. \nFor the case where Conditions is NULL, consider Targets as the final Subquery directly. \nFor the case where Conditions are not NULL, combine Targets and the first Condition to get the first Subquery, then combine this Subquery and the next Condition into a new Subquery until all Conditions are used (which means the content of the last Subquery and the original Query is the same).\n\n[Requirements]\n-Try not to overlap Targets and Conditions.\n-Make sure the decomposed Target and Condition can cover all of the information in Query.\n-Don't change any information (specific value) in Query!\n-Mark each Subquery with ## in front of it.\n\nHere are some examples:\n==========\n\n【Query】\nShow the stadium name and the number of concerts in each stadium. Please also list the year the stadium was built. \n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the stadium name, the year the stadium built and the number of concerts in each stadium\nConditions: NULL\n\nSubqueries:\n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the stadium name, the year the stadium built and the number of concerts in each stadium\n==========\n\n【Query】\nWhat is the qualification rate for the H-11 products produced in 2023/11/2?\n【Evidence】\nqualification rate = `Numqualified(H-11)` / `production(H-11)`\n\n【Decomposition】\nTargets: List the qualification rate for the H-11 Products\nConditions:\n1. produced in 2023/11/2 --Condition_1\n\nSubqueries:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the qualification rate for the H-11 Products produced in 2023/11/2\n\n==========\n\n【Query】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n\n【Decomposition】\nTargets: List the race of institutions\nConditions: \n1. in Alabama --Condition_1\n2. number of students greater than the 90% of average number of students of all institutions --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the race of institution in Alabama\n2. Conbine the first Subquery and Conditon_2 to get the seconed Subquery.\n##Subquery: List the race of institutions in Alabama with number of number of students greater than the 90% of average number of students of all institutions\n\n==========\n\n【Query】\nWhich president got a higher approval rating, Joseph Biden or Donald Trump?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\nConditions: \nNULL\n\nSubqueries: \n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\n\n==========\n\n【Query】\nFor movie id 1269, how many users, who was a paying subscriber and was eligible for trial when he rated the movie, gave the movie a rating score of less than or equal to 2?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the number of users\nConditions:\n1. was a paying subscriber --Condition_1\n2. was eligible for trial --Condition_2\n3. for movie id 1269, gave the movie a rating score of less than or equal to 2 --Condition3\n\nSubquerys:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the number of users who was a paying subscriber\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial\n3. Combine the second Subquery and Condition_3 to get the third Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial and gave the movie whose id is 1269 a rating score of less than or equal to 2\n\n==========\n\nHere is a new query need to be decomposed:\n\n【Query】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n\n【Decomposition】\n", "prompt_token": 1043, "response_token": 125, "cur_total_prompt_tokens": 20957, "cur_total_response_tokens": 1926}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Generator", "response": "\nTo answer the question \"List the number of schools with an average score in Math under 400 in the SAT test,\" we need to follow these steps:\n\n1. **Identify the relevant columns**: \n   - We need to select the average score in Math, which corresponds to `AvgScrMath` from the `satscores` table.\n   - We also need to count the number of schools that meet the criteria.\n\n2. **Determine the condition**: \n   - The condition is that the average score in Math must be under 400.\n\n3. **Identify the tables involved**: \n   - The relevant table for this query is `satscores`, as it contains the average scores.\n\n4. **Formulate the SQL query**:\n   - We will use the `COUNT` function to count the number of schools with an average score in Math under 400.\n   - We will apply a `WHERE` clause to filter the results based on the average score.\n\n5. **Final SQL**:\n   - Since we only need to count the number of schools, we do not need to join with any other tables.\n\nHere is the SQL query that meets the requirements:\n\n```sql\nSELECT COUNT(*) AS number_of_schools\n  FROM satscores\n  WHERE AvgScrMath < 400\n```\n\nThis query counts all entries in the `satscores` table where the average score in Math is less than 400, providing the total number of such schools. \n\n**Question Solved.**\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】and a 【Question】, you need to use valid SQLite and understand the database and knowledge so that you can generate a good SQL for the 【Question】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# stadium: [Stadium_ID (INTEGER), Location (TEXT), Name (TEXT)]\n# concert: [concert_ID (INTEGER), concert_Name (TEXT), Stadium_ID (INTEGER)]\n【Primary keys】\nstadium.`Stadium_ID` | concert.`concert_ID`\n【Foreign keys】\nconcert.`Stadium_ID` = stadium.`Stadium_ID`\n【Detailed descriptions of tables and columns】\nstadium.`Stadium_ID`: The column 'Stadium_ID' in Table <stadium> has column descriptions of \"stadium id\". Value examples: [1, 2, 3, 4, 5, 6].\nstadium.`Name`:  The column 'Name' in Table <stadium> has column descriptions of \"name of stadium\". Value examples: [\"Stark's Park\", 'Somerset Park', 'Recreation Park', 'Hampden Park', 'Glebe Park', 'Gayfield Park'].\nstadium.`Location`: The column 'Location' in Table <stadium> has column descriptions of \"location of stadium\". Value examples: ['Stirling Albion', 'Raith Rovers', \"Queen's Park\", 'Peterhead', 'East Fife', 'Brechin City'].\nconcert.`concert_ID`: The column 'concert_ID' in Table <concert> has column descriptions of \"concert id\". Value examples: [1, 2, 3, 4, 5, 6].\nconcert.`concert_Name`: The column 'concert_Name' in Table <concert> has column descriptions of \"concert name\". Value examples: ['Week 1', 'Week 2', 'Super bootcamp', 'Home Visits', 'Auditions'].\nconcert.`Stadium_ID`: The column 'Stadium_ID' in Table <concert> has column descriptions of \"stadium id\". Value examples: [2, 9, 7, 10, 1].\n【Evidence】\nNULL\n【Question】\nShow the stadium name and the number of concerts in each stadium.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: Show the stadium name and the number of concerts in each stadium.\nTargets for `SELECT`: the stadium name and the number of concerts\nhints from 【Evidence】:NULL\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the stadium name refers to stadium.`Name`, the number of concerts refers to COUNT(concert.`concert_ID`), each stadium refers to stadium.`Stadium_ID`\nConnection of tables: include tables <stadium> and <concert>, get connected keys from 【Foreign keys】: concert.`Stadium_ID` = stadium.`Stadium_ID`\nFinal SQL:\n```sql\nSELECT T1.`Name`, COUNT(T2.concert_ID) AS num_concerts\n  FROM stadium AS T1\n  JOIN concert AS T2\n  ON T1.`Stadium_ID` = T2.`Stadium_ID`\n  GROUP BY T1.`Stadium_ID`\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); name of the car refers to car_name\n【Question】\nWhat is the fastest car made by Japan?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ncountry.`country` = 'Japan'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: What is the fastest car made by Japan?\nTargets for `SELECT`: the name of the fastest car\nhints from 【Evidence】: the fastest refers to max(horsepower); name of the car refers to car_name\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: car refers to data.`car_name`, the fastest refers to MAX(data.`horsepower`), Japan refers to country.`country`\nConnection of tables: includes tables <data> and <country>, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`car_name` \n  FROM data AS T1 \n  INNER JOIN production AS T2 \n  ON T1.`ID` = T2.`ID` \n  INNER JOIN country AS T3 \n  ON T3.`origin` = T2.`country` \n  WHERE T3.`country` = 'Japan' \n  ORDER BY T1.`horsepower` DESC LIMIT 1\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`chronname`: The column 'chronname' in Table <institution_details> has column descriptions of \"Institution name\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \n【Evidence】\nnumber of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the chronname of institutions with number of students greater than the 90% of average number of students of all institutions?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: List the chroname of institutions with number of students greater than the 90% of average number of students of all institutions?\nTargets for `SELECT`: the chroname of institutions\nhints from 【Evidence】: number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the chronname of institutions refers to institution_details.`chronname`, number of students refers to institution_details.`student_count`\nConnection of tables: include only one table <institution_details>, no connection\nFinal SQL:\n```sql\nSELECT DISTINCT `chroname`\n  FROM institution_details\n  WHERE `student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details\n  ) \n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\nsatscores.`cds`: The column 'cds' in Table <satscores> has column descriptions of \"California Department Schools\". \nsatscores.`sname`: The column 'sname' in Table <satscores> has column descriptions of \"school name\".  Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].\nsatscores.`dname`: The column 'dname' in Table <satscores> has column descriptions of \"district segment\".  Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].\nsatscores.`enroll12`: The column 'enroll12' in Table <satscores> has column descriptions of \"enrollment (1st-12nd grade)\". \nsatscores.`NumTstTakr`: The column 'NumTstTakr' in Table <satscores> has column descriptions of \"Number of Test Takers in this school\". \nsatscores.`AvgScrMath`: The column 'AvgScrMath' in Table <satscores> has column descriptions of \"average scores in Math\". \nschools.`CDSCode`: The column 'CDSCode' in Table <schools> has column descriptions of \"CDSCode\". \nschools.`District`: The column 'District' in Table <schools> has column descriptions of \"District\". \nschools.`School`: The column 'School' in Table <schools> has column descriptions of \"School\". \nschools.`Virtual`: The column 'Virtual' in Table <schools> has column descriptions of \"This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.\".  Value examples: [None, 'N', 'P', 'F'].\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Question】\nList the number of schools with an average score in Math under 400 in the SAT test\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n", "prompt_token": 3680, "response_token": 309, "cur_total_prompt_tokens": 24637, "cur_total_response_tokens": 2235}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Soft_Schema_Linker", "response": "\n你好\n", "input_prompt": "As an experienced and professional database administrator, your task is to analyze a user question and a database schema to provide relevant information. The database schema consists of table descriptions, each containing multiple column descriptions. Your goal is to extract the entities from question and identify the relevant tables and columns based on these entities and the evidence provided.\n\n[Instruction]:\n1. Extract the mentioned entities from the user question. Make sure all of the entities are extracted. \n2. For each entity, keep at least 3 related columns.\n4. Your output should include entity extraction, analysis and related database schema.\n5. The related database schema should be in JSON format.\n6. Each column's information in provided 【Schema】 is in this format: (column, description. Value examples<optional>)\n\n[Requirements]:\n1. Sort the related columns in each list corresponding to each entity in descending order of relevance.\n2. The chosen columns should be in this format: <table.column>.\n3. Make sure each chosen list is not empty. The value [] will be punished. \n4.【Matched values】 may contain redundant or useless information in addition to the correct matching values, so you need to select the useful information in conjunction with the specific column names and descriptions.\n5. An entity may not have a corresponding evidence, which requires you to find the relevant columns yourself through your understanding of the database schema.\n\nHere is a typical example:\n\n==========\n【DB_ID】 banking_system\n【Schema】\n# Table: account\n[\n  (account_id <INTEGER>, the id of the account. Value examples: [11382, 11362, 2, 1, 2367].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (frequency <TEXT>, frequency of the acount. Value examples: ['POPLATEK MESICNE', 'POPLATEK TYDNE', 'POPLATEK PO OBRATU'].),\n  (date <DATE>, the creation date of the account. Value examples: ['1997-12-29', '1997-12-28'].)\n]\n# Table: client\n[\n  (client_id <INTEGER>, the unique number. Value examples: [13998, 13971, 2, 1, 2839].),\n  (gender <TEXT>, gender. Value examples: ['M', 'F']. And F：female . M：male ),\n  (birth_date <DATE>, birth date. Value examples: ['1987-09-27', '1986-08-13'].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (first_name <TEXT>, first_name.),\n  (last_name <TEXT>, last_name.)\n]\n# Table: loan\n[\n  (loan_id <INTEGER>, the id number identifying the loan data. Value examples: [4959, 4960, 4961].),\n  (account_id <INTEGER>, the id number identifying the account. Value examples: [10, 80, 55, 43].),\n  (date <DATE>, the date when the loan is approved. Value examples: ['1998-07-12', '1998-04-19'].),\n  (amount <INTEGER>, the id number identifying the loan data. Value examples: [1567, 7877, 9988].),\n  (duration <INTEGER>, the id number identifying the loan data. Value examples: [60, 48, 24, 12, 36].),\n  (payments <INTEGER>, the id number identifying the loan data. Value examples: [3456, 8972, 9845].),\n  (status <TEXT>, the id number identifying the loan data. Value examples: ['C', 'A', 'D', 'B'].)\n]\n# Table: district\n[\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76].),\n  (A2 <REAL>, area in square kilometers. Value examples: [50.5, 48.9].),\n  (A4 <INTEGER>, number of inhabitants. Value examples: [95907, 95616].),\n  (A5 <INTEGER>, number of households. Value examples: [35678, 34892].),\n  (A6 <REAL>, literacy rate. Value examples: [95.6, 92.3, 89.7].),\n  (A7 <INTEGER>, number of entrepreneurs. Value examples: [1234, 1456].),\n  (A8 <INTEGERt>, number of cities. Value examples: [5, 4].),\n  (A9 <INTEGER>, number of schools. Value examples: [15, 12, 10].),\n  (A10 <INTEGER>, number of hospitals. Value examples: [8, 6, 4].),\n  (A11 <REAL>, average salary. Value examples: [12541.5, 11277].),\n  (A12 <REAL>, poverty rate. Value examples: [12.4, 9.8].),\n  (A13 <REAL>, unemployment rate. Value examples: [8.2, 7.9].),\n  (A15 <INTEGER>, number of crimes. Value examples: [256, 189].)\n]\n【Primary keys】\naccount.`account_id` | client.`client_id` | loan.`loan_id` | district.`district_id`\n【Foreign keys】\nclient.`district_id` = district.`district_id`\n【Question】\nWhat is the gender of the youngest client who opened account in the lowest average salary branch and when did this client open the account? Please list their full name.\n【Evidence】\nLater birthdate refers to younger age; A11 refers to average salary; Full name refers to first_name, last_name\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\nThe entities extracted from the 【Question】 are: \n1. gender; \n2. youngest client; \n3. account; \n4. lowest average salary branch; \n5. when did this client open the account; \n6. full name\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. gender --no related evidence **the columns about gender are related**\n2. youngest client  --Later birthdate refers to younger age; **the columns about birth date of client and the id of client are related**\n3. account --no related evidence **the columns about account or account ids are related**\n4. lowest average salary branch  --A11 refers to average salary **the columns about average salary and branch are related**\n5. when did this client open the account --no related evidence **the columns about time or date of the account are related**\n6. full name  --Full name refers to first_name, last_name **the columns about first_name, last_name of the client are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"gender\": [\"client.gender\",\"client.client_id\",\"loan.status\"],\n  \"youngest client\": [\"client.birth_date\",\"client.client_id\",\"account.date\",\"loan.date\"],\n  \"account\": [\"account.account_id\",\"loan.account_id\",\"account.date\"],\n  \"lowest average salary branch\": [\"district.A11\",\"district.district_id\",\"district.A13\"],\n  \"when did this client open the account\": [\"account.date\",\"loan.date\",\"client.birth_date\"],\n  \"full name\": [\"client.first_name\",\"client.last_name\",\"client.client_id\"]\n}\n```\nQuestion Solved.\n\n==========\n\nHere is a new example, please start answering:\n\n【DB_ID】 california_schools\n【Schema】\n# Table: frpm\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (Academic Year <TEXT>,  Academic Year. Value examples: ['2014-2015'].),\n  (County Code <TEXT>,  County Code. Value examples: ['19', '37', '30', '36', '33', '43'].),\n  (District Code <INTEGER>,  District Code.),\n  (School Code <TEXT>,  School Code. Value examples: ['0000000', '9010745', '6121081', '6121073', '6121016', '6120968'].),\n  (County Name <TEXT>,  County Name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].),\n  (District Name <TEXT>,  District Name.),\n  (School Name <TEXT>,  School Name.),\n  (District Type <TEXT>,  District Type. Value examples: ['Unified School District', 'Elementary School District', 'High School District', 'County Office of Education (COE)', 'State Board of Education', 'Statewide Benefit Charter'].),\n  (School Type <TEXT>,  School Type. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].),\n  (Educational Option Type <TEXT>,  Educational Option Type. Value examples: [None, 'Traditional', 'Continuation School', 'Alternative School of Choice', 'Community Day School', 'Special Education School', 'County Community School'].),\n  (NSLP Provision Status <TEXT>,  NSLP Provision Status. Value examples: [None, 'Provision 2', 'Breakfast Provision 2', 'CEP', 'Multiple Provision Types', 'Provision 1', 'Lunch Provision 2'].),\n  (Charter School (Y/N) <INTEGER>,  Charter School (Y/N). Value examples: [None, 0, 1].),\n  (Charter School Number <TEXT>,  Charter School Number. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1700', '1696'].),\n  (Charter Funding Type <TEXT>,  Charter Funding Type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (IRC <INTEGER>,  IRC. Value examples: [None, 0, 1].),\n  (Low Grade <TEXT>,  Low Grade. Value examples: ['K', '9', '6', '7', 'P', '5'].),\n  (High Grade <TEXT>,  High Grade. Value examples: ['12', '5', '8', '6', '3', '4'].),\n  (Enrollment (K-12) <REAL>,  Enrollment (K-12).),\n  (Free Meal Count (K-12) <REAL>,  Free Meal Count (K-12).),\n  (Percent (%) Eligible Free (K-12) <REAL>,  Percent (%) Eligible Free (K-12).),\n  (FRPM Count (K-12) <REAL>,  Free or Reduced Price Meal Count (K-12).),\n  (Percent (%) Eligible FRPM (K-12) <REAL>,  Percent (%) Eligible FRPM (K-12).),\n  (Enrollment (Ages 5-17) <REAL>,  Enrollment (Ages 5-17).),\n  (Free Meal Count (Ages 5-17) <REAL>,  Free Meal Count (Ages 5-17).),\n  (Percent (%) Eligible Free (Ages 5-17) <REAL>,  Percent (%) Eligible Free (Ages 5-17).),\n  (FRPM Count (Ages 5-17) <REAL>,  FRPM Count (Ages 5-17).),\n  (Percent (%) Eligible FRPM (Ages 5-17) <REAL>,  Percent (%) Eligible FRPM (Ages 5-17).),\n  (2013-14 CALPADS Fall 1 Certification Status <INTEGER>,  2013-14 CALPADS Fall 1 Certification Status. Value examples: [1].)\n]\n# Table: satscores\n[\n  (cds <TEXT>,  California Department Schools.),\n  (rtype <TEXT>,  rtype. Value examples: ['S', 'D'].),\n  (sname <TEXT>,  school name. Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].),\n  (dname <TEXT>,  district segment. Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].),\n  (cname <TEXT>,  county name. Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].),\n  (enroll12 <INTEGER>,  enrollment (1st-12nd grade).),\n  (NumTstTakr <INTEGER>,  Number of Test Takers in this school.),\n  (AvgScrRead <INTEGER>,  average scores in Reading.),\n  (AvgScrMath <INTEGER>,  average scores in Math.),\n  (AvgScrWrite <INTEGER>,  average scores in writing.),\n  (NumGE1500 <INTEGER>,  Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500.)\n]\n# Table: schools\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (NCESDist <TEXT>,  This field represents the 7-digit National Center for Educational Statistics (NCES) school district identification number. The first 2 digits identify the state and the last 5 digits identify the school district. Combined, they make a unique 7-digit ID for each school district.. Value examples: [None, '0622710', '0634320', '0628050', '0634410', '0614550', '0633840'].),\n  (NCESSchool <TEXT>,  This field represents the 5-digit NCES school identification number. The NCESSchool combined with the NCESDist form a unique 12-digit ID for each school.. Value examples: [None, '12271', '13785', '13747', '12909', '12311', '12003'].),\n  (StatusType <TEXT>,  This field identifies the status of the district.. Value examples: ['Active', 'Closed', 'Merged', 'Pending'].),\n  (County <TEXT>,  County name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].),\n  (District <TEXT>,  District.),\n  (School <TEXT>,  School.),\n  (Street <TEXT>,  Street.),\n  (StreetAbr <TEXT>,  The abbreviated street address of the school, district, or administrative authority’s physical location..),\n  (City <TEXT>,  City. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].),\n  (Zip <TEXT>,  Zip. Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].),\n  (State <TEXT>,  State. Value examples: [None, 'CA'].),\n  (MailStreet <TEXT>,  MailStreet.),\n  (MailStrAbr <TEXT>,  mailing street address.),\n  (MailCity <TEXT>,  mailing city. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].),\n  (MailZip <TEXT>,  mailing zip. Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].),\n  (MailState <TEXT>,  mailing state. Value examples: [None, 'CA'].),\n  (Phone <TEXT>,  Phone. Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].),\n  (Ext <TEXT>,  The phone number extension of the school, district, or administrative authority.. Value examples: [None, '200', '201', '111', '352', '221', '203'].),\n  (Website <TEXT>,  The website address of the school, district, or administrative authority..),\n  (OpenDate <DATE>,  The date the school opened.. Value examples: [None, '1980-07-01'].),\n  (ClosedDate <DATE>,  The date the school closed.. Value examples: [None, '1989-06-30'].),\n  (Charter <INTEGER>,  This field identifies a charter school.. Value examples: [None, 0, 1].),\n  (CharterNum <TEXT>,  The charter school number,. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1826', '1710'].),\n  (FundingType <TEXT>,  Indicates the charter school funding type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (DOC <TEXT>,  District Ownership Code. Value examples: ['54', '52', '00', '56', '98', '02'].),\n  (DOCType <TEXT>,  The District Ownership Code Type is the text description of the DOC category.. Value examples: ['Unified School District', 'Elementary School District', 'County Office of Education (COE)', 'High School District', 'Regional Occupation Center/Program (ROC/P)', 'State Board of Education'].),\n  (SOC <TEXT>,  The School Ownership Code is a numeric code used to identify the type of school.. Value examples: [None, '60', '66', '62', '68', '09', '69'].),\n  (SOCType <TEXT>,  The School Ownership Code Type is the text description of the type of school.. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Special Education Schools (Public)', 'District Community Day Schools'].),\n  (EdOpsCode <TEXT>,  The Education Option Code is a short text description of the type of education offered.. Value examples: [None, 'TRAD', 'CON', 'COMMDAY', 'ALTSOC', 'SPEC', 'COMM'].),\n  (EdOpsName <TEXT>,  Educational Option Name. Value examples: [None, 'Traditional', 'Continuation School', 'Community Day School', 'Alternative School of Choice', 'Special Education School', 'County Community School'].),\n  (EILCode <TEXT>,  The Educational Instruction Level Code is a short text description of the institution's type relative to the grade range served.. Value examples: [None, 'ELEM', 'HS', 'UG', 'INTMIDJR', 'ELEMHIGH', 'A'].),\n  (EILName <TEXT>,  The Educational Instruction Level Name is the long text description of the institution’s type relative to the grade range served.. Value examples: [None, 'Elementary', 'High School', 'Ungraded', 'Intermediate/Middle/Junior High', 'Elementary-High Combination', 'Adult'].),\n  (GSoffered <TEXT>,  The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.. Value examples: [None, 'K-5', '9-12', 'K-6', 'K-8', '6-8', 'K-12'].),\n  (GSserved <TEXT>,  It is the lowest grade and the highest grade of student enrollment as reported in the most recent certified CALPADS Fall 1 data collection. Only K–12 enrollment is reported through CALPADS. This field may differ from the grade span offered.. Value examples: [None, 'K-5', 'K-6', '9-12', 'K-8', '6-8', '7-8'].),\n  (Virtual <TEXT>,  This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.. Value examples: [None, 'N', 'P', 'F'].),\n  (Magnet <INTEGER>,  This field identifies whether a school is a magnet school and/or provides a magnet program.. Value examples: [None, 0, 1].),\n  (Latitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the equator measured north to south..),\n  (Longitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the prime meridian (Greenwich, England) measured from west to east..),\n  (AdmFName1 <TEXT>,  administrator's first name 1. Value examples: [None, 'David', 'Michael', 'John', 'Jennifer', 'Lisa', 'Robert'].),\n  (AdmLName1 <TEXT>,  administrator's last name 1.),\n  (AdmEmail1 <TEXT>,  administrator's email address 1.),\n  (AdmFName2 <TEXT>,  administrator's first name 2. Value examples: [None, 'Steve', 'Delphine', 'Tim', 'Michael', 'Lisa', 'Jeff'].),\n  (AdmLName2 <TEXT>,  administrator's last name 2. Value examples: [None, 'Sherman', 'Jones', 'Wilson', 'Petersen', 'Landry', 'Hambright'].),\n  (AdmEmail2 <TEXT>,  administrator's email address 2.),\n  (AdmFName3 <TEXT>,  administrator's first name 3. Value examples: [None, 'Mark', 'Eric', 'Vickie', 'Tracie', 'Shawn', 'Sarah'].),\n  (AdmLName3 <TEXT>,  administrator's last name 3. Value examples: [None, 'Zerpoli', 'Yount', 'Woodruff', 'Wood', 'Wolk', 'Spotts'].),\n  (AdmEmail3 <TEXT>,  administrator's email address 3.),\n  (LastUpdate <DATE>,  Last Update. Value examples: ['2015-06-18'].)\n]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Question】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 10, "cur_total_response_tokens": 10}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Decomposer", "response": "\n你好\n", "input_prompt": "[Instruction]\nGiven a 【query】, you need to understanding the intent of Query, and then deceompose it into Targets and Conditions. Then you need to combine Targets and Conditions into Subquerys step by step. \nFor the case where Conditions is NULL, consider Targets as the final Subquery directly. \nFor the case where Conditions are not NULL, combine Targets and the first Condition to get the first Subquery, then combine this Subquery and the next Condition into a new Subquery until all Conditions are used (which means the content of the last Subquery and the original Query is the same).\n\n[Requirements]\n-Try not to overlap Targets and Conditions.\n-Make sure the decomposed Target and Condition can cover all of the information in Query.\n-Don't change any information (specific value) in Query!\n-Mark each Subquery with ## in front of it.\n\nHere are some examples:\n==========\n\n【Query】\nShow the stadium name and the number of concerts in each stadium. Please also list the year the stadium was built. \n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the stadium name, the year the stadium built and the number of concerts in each stadium\nConditions: NULL\n\nSubqueries:\n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the stadium name, the year the stadium built and the number of concerts in each stadium\n==========\n\n【Query】\nWhat is the qualification rate for the H-11 products produced in 2023/11/2?\n【Evidence】\nqualification rate = `Numqualified(H-11)` / `production(H-11)`\n\n【Decomposition】\nTargets: List the qualification rate for the H-11 Products\nConditions:\n1. produced in 2023/11/2 --Condition_1\n\nSubqueries:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the qualification rate for the H-11 Products produced in 2023/11/2\n\n==========\n\n【Query】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n\n【Decomposition】\nTargets: List the race of institutions\nConditions: \n1. in Alabama --Condition_1\n2. number of students greater than the 90% of average number of students of all institutions --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the race of institution in Alabama\n2. Conbine the first Subquery and Conditon_2 to get the seconed Subquery.\n##Subquery: List the race of institutions in Alabama with number of number of students greater than the 90% of average number of students of all institutions\n\n==========\n\n【Query】\nWhich president got a higher approval rating, Joseph Biden or Donald Trump?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\nConditions: \nNULL\n\nSubqueries: \n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\n\n==========\n\n【Query】\nFor movie id 1269, how many users, who was a paying subscriber and was eligible for trial when he rated the movie, gave the movie a rating score of less than or equal to 2?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the number of users\nConditions:\n1. was a paying subscriber --Condition_1\n2. was eligible for trial --Condition_2\n3. for movie id 1269, gave the movie a rating score of less than or equal to 2 --Condition3\n\nSubquerys:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the number of users who was a paying subscriber\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial\n3. Combine the second Subquery and Condition_3 to get the third Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial and gave the movie whose id is 1269 a rating score of less than or equal to 2\n\n==========\n\nHere is a new query need to be decomposed:\n\n【Query】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n\n【Decomposition】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 20, "cur_total_response_tokens": 20}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Generator", "response": "\n你好\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】and a 【Question】, you need to use valid SQLite and understand the database and knowledge so that you can generate a good SQL for the 【Question】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# stadium: [Stadium_ID (INTEGER), Location (TEXT), Name (TEXT)]\n# concert: [concert_ID (INTEGER), concert_Name (TEXT), Stadium_ID (INTEGER)]\n【Primary keys】\nstadium.`Stadium_ID` | concert.`concert_ID`\n【Foreign keys】\nconcert.`Stadium_ID` = stadium.`Stadium_ID`\n【Detailed descriptions of tables and columns】\nstadium.`Stadium_ID`: The column 'Stadium_ID' in Table <stadium> has column descriptions of \"stadium id\". Value examples: [1, 2, 3, 4, 5, 6].\nstadium.`Name`:  The column 'Name' in Table <stadium> has column descriptions of \"name of stadium\". Value examples: [\"Stark's Park\", 'Somerset Park', 'Recreation Park', 'Hampden Park', 'Glebe Park', 'Gayfield Park'].\nstadium.`Location`: The column 'Location' in Table <stadium> has column descriptions of \"location of stadium\". Value examples: ['Stirling Albion', 'Raith Rovers', \"Queen's Park\", 'Peterhead', 'East Fife', 'Brechin City'].\nconcert.`concert_ID`: The column 'concert_ID' in Table <concert> has column descriptions of \"concert id\". Value examples: [1, 2, 3, 4, 5, 6].\nconcert.`concert_Name`: The column 'concert_Name' in Table <concert> has column descriptions of \"concert name\". Value examples: ['Week 1', 'Week 2', 'Super bootcamp', 'Home Visits', 'Auditions'].\nconcert.`Stadium_ID`: The column 'Stadium_ID' in Table <concert> has column descriptions of \"stadium id\". Value examples: [2, 9, 7, 10, 1].\n【Evidence】\nNULL\n【Question】\nShow the stadium name and the number of concerts in each stadium.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: Show the stadium name and the number of concerts in each stadium.\nTargets for `SELECT`: the stadium name and the number of concerts\nhints from 【Evidence】:NULL\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the stadium name refers to stadium.`Name`, the number of concerts refers to COUNT(concert.`concert_ID`), each stadium refers to stadium.`Stadium_ID`\nConnection of tables: include tables <stadium> and <concert>, get connected keys from 【Foreign keys】: concert.`Stadium_ID` = stadium.`Stadium_ID`\nFinal SQL:\n```sql\nSELECT T1.`Name`, COUNT(T2.concert_ID) AS num_concerts\n  FROM stadium AS T1\n  JOIN concert AS T2\n  ON T1.`Stadium_ID` = T2.`Stadium_ID`\n  GROUP BY T1.`Stadium_ID`\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); name of the car refers to car_name\n【Question】\nWhat is the fastest car made by Japan?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ncountry.`country` = 'Japan'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: What is the fastest car made by Japan?\nTargets for `SELECT`: the name of the fastest car\nhints from 【Evidence】: the fastest refers to max(horsepower); name of the car refers to car_name\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: car refers to data.`car_name`, the fastest refers to MAX(data.`horsepower`), Japan refers to country.`country`\nConnection of tables: includes tables <data> and <country>, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`car_name` \n  FROM data AS T1 \n  INNER JOIN production AS T2 \n  ON T1.`ID` = T2.`ID` \n  INNER JOIN country AS T3 \n  ON T3.`origin` = T2.`country` \n  WHERE T3.`country` = 'Japan' \n  ORDER BY T1.`horsepower` DESC LIMIT 1\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`chronname`: The column 'chronname' in Table <institution_details> has column descriptions of \"Institution name\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \n【Evidence】\nnumber of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the chronname of institutions with number of students greater than the 90% of average number of students of all institutions?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: List the chroname of institutions with number of students greater than the 90% of average number of students of all institutions?\nTargets for `SELECT`: the chroname of institutions\nhints from 【Evidence】: number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the chronname of institutions refers to institution_details.`chronname`, number of students refers to institution_details.`student_count`\nConnection of tables: include only one table <institution_details>, no connection\nFinal SQL:\n```sql\nSELECT DISTINCT `chroname`\n  FROM institution_details\n  WHERE `student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details\n  ) \n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Question】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 30, "cur_total_response_tokens": 30}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Query】\n-- How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 40, "cur_total_response_tokens": 40}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Query】\n-- How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 50, "cur_total_response_tokens": 50}
{"idx": 6, "db_id": "california_schools", "query": "Among the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.", "evidence": "Magnet schools or offer a magnet program means that Magnet = 1", "difficulty": "simple", "ground_truth": "SELECT T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Magnet = 1 AND T1.NumTstTakr > 500", "send_to": "Soft_Schema_Linker", "response": "\n你好\n", "input_prompt": "As an experienced and professional database administrator, your task is to analyze a user question and a database schema to provide relevant information. The database schema consists of table descriptions, each containing multiple column descriptions. Your goal is to extract the entities from question and identify the relevant tables and columns based on these entities and the evidence provided.\n\n[Instruction]:\n1. Extract the mentioned entities from the user question. Make sure all of the entities are extracted. \n2. For each entity, keep at least 3 related columns.\n4. Your output should include entity extraction, analysis and related database schema.\n5. The related database schema should be in JSON format.\n6. Each column's information in provided 【Schema】 is in this format: (column, description. Value examples<optional>)\n\n[Requirements]:\n1. Sort the related columns in each list corresponding to each entity in descending order of relevance.\n2. The chosen columns should be in this format: <table.column>.\n3. Make sure each chosen list is not empty. The value [] will be punished. \n4.【Matched values】 may contain redundant or useless information in addition to the correct matching values, so you need to select the useful information in conjunction with the specific column names and descriptions.\n5. An entity may not have a corresponding evidence, which requires you to find the relevant columns yourself through your understanding of the database schema.\n\nHere is a typical example:\n\n==========\n【DB_ID】 banking_system\n【Schema】\n# Table: account\n[\n  (account_id <INTEGER>, the id of the account. Value examples: [11382, 11362, 2, 1, 2367].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (frequency <TEXT>, frequency of the acount. Value examples: ['POPLATEK MESICNE', 'POPLATEK TYDNE', 'POPLATEK PO OBRATU'].),\n  (date <DATE>, the creation date of the account. Value examples: ['1997-12-29', '1997-12-28'].)\n]\n# Table: client\n[\n  (client_id <INTEGER>, the unique number. Value examples: [13998, 13971, 2, 1, 2839].),\n  (gender <TEXT>, gender. Value examples: ['M', 'F']. And F：female . M：male ),\n  (birth_date <DATE>, birth date. Value examples: ['1987-09-27', '1986-08-13'].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (first_name <TEXT>, first_name.),\n  (last_name <TEXT>, last_name.)\n]\n# Table: loan\n[\n  (loan_id <INTEGER>, the id number identifying the loan data. Value examples: [4959, 4960, 4961].),\n  (account_id <INTEGER>, the id number identifying the account. Value examples: [10, 80, 55, 43].),\n  (date <DATE>, the date when the loan is approved. Value examples: ['1998-07-12', '1998-04-19'].),\n  (amount <INTEGER>, the id number identifying the loan data. Value examples: [1567, 7877, 9988].),\n  (duration <INTEGER>, the id number identifying the loan data. Value examples: [60, 48, 24, 12, 36].),\n  (payments <INTEGER>, the id number identifying the loan data. Value examples: [3456, 8972, 9845].),\n  (status <TEXT>, the id number identifying the loan data. Value examples: ['C', 'A', 'D', 'B'].)\n]\n# Table: district\n[\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76].),\n  (A2 <REAL>, area in square kilometers. Value examples: [50.5, 48.9].),\n  (A4 <INTEGER>, number of inhabitants. Value examples: [95907, 95616].),\n  (A5 <INTEGER>, number of households. Value examples: [35678, 34892].),\n  (A6 <REAL>, literacy rate. Value examples: [95.6, 92.3, 89.7].),\n  (A7 <INTEGER>, number of entrepreneurs. Value examples: [1234, 1456].),\n  (A8 <INTEGERt>, number of cities. Value examples: [5, 4].),\n  (A9 <INTEGER>, number of schools. Value examples: [15, 12, 10].),\n  (A10 <INTEGER>, number of hospitals. Value examples: [8, 6, 4].),\n  (A11 <REAL>, average salary. Value examples: [12541.5, 11277].),\n  (A12 <REAL>, poverty rate. Value examples: [12.4, 9.8].),\n  (A13 <REAL>, unemployment rate. Value examples: [8.2, 7.9].),\n  (A15 <INTEGER>, number of crimes. Value examples: [256, 189].)\n]\n【Primary keys】\naccount.`account_id` | client.`client_id` | loan.`loan_id` | district.`district_id`\n【Foreign keys】\nclient.`district_id` = district.`district_id`\n【Question】\nWhat is the gender of the youngest client who opened account in the lowest average salary branch and when did this client open the account? Please list their full name.\n【Evidence】\nLater birthdate refers to younger age; A11 refers to average salary; Full name refers to first_name, last_name\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\nThe entities extracted from the 【Question】 are: \n1. gender; \n2. youngest client; \n3. account; \n4. lowest average salary branch; \n5. when did this client open the account; \n6. full name\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. gender --no related evidence **the columns about gender are related**\n2. youngest client  --Later birthdate refers to younger age; **the columns about birth date of client and the id of client are related**\n3. account --no related evidence **the columns about account or account ids are related**\n4. lowest average salary branch  --A11 refers to average salary **the columns about average salary and branch are related**\n5. when did this client open the account --no related evidence **the columns about time or date of the account are related**\n6. full name  --Full name refers to first_name, last_name **the columns about first_name, last_name of the client are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"gender\": [\"client.gender\",\"client.client_id\",\"loan.status\"],\n  \"youngest client\": [\"client.birth_date\",\"client.client_id\",\"account.date\",\"loan.date\"],\n  \"account\": [\"account.account_id\",\"loan.account_id\",\"account.date\"],\n  \"lowest average salary branch\": [\"district.A11\",\"district.district_id\",\"district.A13\"],\n  \"when did this client open the account\": [\"account.date\",\"loan.date\",\"client.birth_date\"],\n  \"full name\": [\"client.first_name\",\"client.last_name\",\"client.client_id\"]\n}\n```\nQuestion Solved.\n\n==========\n\nHere is a new example, please start answering:\n\n【DB_ID】 california_schools\n【Schema】\n# Table: frpm\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (Academic Year <TEXT>,  Academic Year. Value examples: ['2014-2015'].),\n  (County Code <TEXT>,  County Code. Value examples: ['19', '37', '30', '36', '33', '43'].),\n  (District Code <INTEGER>,  District Code.),\n  (School Code <TEXT>,  School Code. Value examples: ['0000000', '9010745', '6121081', '6121073', '6121016', '6120968'].),\n  (County Name <TEXT>,  County Name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].),\n  (District Name <TEXT>,  District Name.),\n  (School Name <TEXT>,  School Name.),\n  (District Type <TEXT>,  District Type. Value examples: ['Unified School District', 'Elementary School District', 'High School District', 'County Office of Education (COE)', 'State Board of Education', 'Statewide Benefit Charter'].),\n  (School Type <TEXT>,  School Type. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].),\n  (Educational Option Type <TEXT>,  Educational Option Type. Value examples: [None, 'Traditional', 'Continuation School', 'Alternative School of Choice', 'Community Day School', 'Special Education School', 'County Community School'].),\n  (NSLP Provision Status <TEXT>,  NSLP Provision Status. Value examples: [None, 'Provision 2', 'Breakfast Provision 2', 'CEP', 'Multiple Provision Types', 'Provision 1', 'Lunch Provision 2'].),\n  (Charter School (Y/N) <INTEGER>,  Charter School (Y/N). Value examples: [None, 0, 1].),\n  (Charter School Number <TEXT>,  Charter School Number. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1700', '1696'].),\n  (Charter Funding Type <TEXT>,  Charter Funding Type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (IRC <INTEGER>,  IRC. Value examples: [None, 0, 1].),\n  (Low Grade <TEXT>,  Low Grade. Value examples: ['K', '9', '6', '7', 'P', '5'].),\n  (High Grade <TEXT>,  High Grade. Value examples: ['12', '5', '8', '6', '3', '4'].),\n  (Enrollment (K-12) <REAL>,  Enrollment (K-12).),\n  (Free Meal Count (K-12) <REAL>,  Free Meal Count (K-12).),\n  (Percent (%) Eligible Free (K-12) <REAL>,  Percent (%) Eligible Free (K-12).),\n  (FRPM Count (K-12) <REAL>,  Free or Reduced Price Meal Count (K-12).),\n  (Percent (%) Eligible FRPM (K-12) <REAL>,  Percent (%) Eligible FRPM (K-12).),\n  (Enrollment (Ages 5-17) <REAL>,  Enrollment (Ages 5-17).),\n  (Free Meal Count (Ages 5-17) <REAL>,  Free Meal Count (Ages 5-17).),\n  (Percent (%) Eligible Free (Ages 5-17) <REAL>,  Percent (%) Eligible Free (Ages 5-17).),\n  (FRPM Count (Ages 5-17) <REAL>,  FRPM Count (Ages 5-17).),\n  (Percent (%) Eligible FRPM (Ages 5-17) <REAL>,  Percent (%) Eligible FRPM (Ages 5-17).),\n  (2013-14 CALPADS Fall 1 Certification Status <INTEGER>,  2013-14 CALPADS Fall 1 Certification Status. Value examples: [1].)\n]\n# Table: satscores\n[\n  (cds <TEXT>,  California Department Schools.),\n  (rtype <TEXT>,  rtype. Value examples: ['S', 'D'].),\n  (sname <TEXT>,  school name. Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].),\n  (dname <TEXT>,  district segment. Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].),\n  (cname <TEXT>,  county name. Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].),\n  (enroll12 <INTEGER>,  enrollment (1st-12nd grade).),\n  (NumTstTakr <INTEGER>,  Number of Test Takers in this school.),\n  (AvgScrRead <INTEGER>,  average scores in Reading.),\n  (AvgScrMath <INTEGER>,  average scores in Math.),\n  (AvgScrWrite <INTEGER>,  average scores in writing.),\n  (NumGE1500 <INTEGER>,  Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500.)\n]\n# Table: schools\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (NCESDist <TEXT>,  This field represents the 7-digit National Center for Educational Statistics (NCES) school district identification number. The first 2 digits identify the state and the last 5 digits identify the school district. Combined, they make a unique 7-digit ID for each school district.. Value examples: [None, '0622710', '0634320', '0628050', '0634410', '0614550', '0633840'].),\n  (NCESSchool <TEXT>,  This field represents the 5-digit NCES school identification number. The NCESSchool combined with the NCESDist form a unique 12-digit ID for each school.. Value examples: [None, '12271', '13785', '13747', '12909', '12311', '12003'].),\n  (StatusType <TEXT>,  This field identifies the status of the district.. Value examples: ['Active', 'Closed', 'Merged', 'Pending'].),\n  (County <TEXT>,  County name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].),\n  (District <TEXT>,  District.),\n  (School <TEXT>,  School.),\n  (Street <TEXT>,  Street.),\n  (StreetAbr <TEXT>,  The abbreviated street address of the school, district, or administrative authority’s physical location..),\n  (City <TEXT>,  City. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].),\n  (Zip <TEXT>,  Zip. Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].),\n  (State <TEXT>,  State. Value examples: [None, 'CA'].),\n  (MailStreet <TEXT>,  MailStreet.),\n  (MailStrAbr <TEXT>,  mailing street address.),\n  (MailCity <TEXT>,  mailing city. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].),\n  (MailZip <TEXT>,  mailing zip. Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].),\n  (MailState <TEXT>,  mailing state. Value examples: [None, 'CA'].),\n  (Phone <TEXT>,  Phone. Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].),\n  (Ext <TEXT>,  The phone number extension of the school, district, or administrative authority.. Value examples: [None, '200', '201', '111', '352', '221', '203'].),\n  (Website <TEXT>,  The website address of the school, district, or administrative authority..),\n  (OpenDate <DATE>,  The date the school opened.. Value examples: [None, '1980-07-01'].),\n  (ClosedDate <DATE>,  The date the school closed.. Value examples: [None, '1989-06-30'].),\n  (Charter <INTEGER>,  This field identifies a charter school.. Value examples: [None, 0, 1].),\n  (CharterNum <TEXT>,  The charter school number,. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1826', '1710'].),\n  (FundingType <TEXT>,  Indicates the charter school funding type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (DOC <TEXT>,  District Ownership Code. Value examples: ['54', '52', '00', '56', '98', '02'].),\n  (DOCType <TEXT>,  The District Ownership Code Type is the text description of the DOC category.. Value examples: ['Unified School District', 'Elementary School District', 'County Office of Education (COE)', 'High School District', 'Regional Occupation Center/Program (ROC/P)', 'State Board of Education'].),\n  (SOC <TEXT>,  The School Ownership Code is a numeric code used to identify the type of school.. Value examples: [None, '60', '66', '62', '68', '09', '69'].),\n  (SOCType <TEXT>,  The School Ownership Code Type is the text description of the type of school.. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Special Education Schools (Public)', 'District Community Day Schools'].),\n  (EdOpsCode <TEXT>,  The Education Option Code is a short text description of the type of education offered.. Value examples: [None, 'TRAD', 'CON', 'COMMDAY', 'ALTSOC', 'SPEC', 'COMM'].),\n  (EdOpsName <TEXT>,  Educational Option Name. Value examples: [None, 'Traditional', 'Continuation School', 'Community Day School', 'Alternative School of Choice', 'Special Education School', 'County Community School'].),\n  (EILCode <TEXT>,  The Educational Instruction Level Code is a short text description of the institution's type relative to the grade range served.. Value examples: [None, 'ELEM', 'HS', 'UG', 'INTMIDJR', 'ELEMHIGH', 'A'].),\n  (EILName <TEXT>,  The Educational Instruction Level Name is the long text description of the institution’s type relative to the grade range served.. Value examples: [None, 'Elementary', 'High School', 'Ungraded', 'Intermediate/Middle/Junior High', 'Elementary-High Combination', 'Adult'].),\n  (GSoffered <TEXT>,  The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.. Value examples: [None, 'K-5', '9-12', 'K-6', 'K-8', '6-8', 'K-12'].),\n  (GSserved <TEXT>,  It is the lowest grade and the highest grade of student enrollment as reported in the most recent certified CALPADS Fall 1 data collection. Only K–12 enrollment is reported through CALPADS. This field may differ from the grade span offered.. Value examples: [None, 'K-5', 'K-6', '9-12', 'K-8', '6-8', '7-8'].),\n  (Virtual <TEXT>,  This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.. Value examples: [None, 'N', 'P', 'F'].),\n  (Magnet <INTEGER>,  This field identifies whether a school is a magnet school and/or provides a magnet program.. Value examples: [None, 0, 1].),\n  (Latitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the equator measured north to south..),\n  (Longitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the prime meridian (Greenwich, England) measured from west to east..),\n  (AdmFName1 <TEXT>,  administrator's first name 1. Value examples: [None, 'David', 'Michael', 'John', 'Jennifer', 'Lisa', 'Robert'].),\n  (AdmLName1 <TEXT>,  administrator's last name 1.),\n  (AdmEmail1 <TEXT>,  administrator's email address 1.),\n  (AdmFName2 <TEXT>,  administrator's first name 2. Value examples: [None, 'Steve', 'Delphine', 'Tim', 'Michael', 'Lisa', 'Jeff'].),\n  (AdmLName2 <TEXT>,  administrator's last name 2. Value examples: [None, 'Sherman', 'Jones', 'Wilson', 'Petersen', 'Landry', 'Hambright'].),\n  (AdmEmail2 <TEXT>,  administrator's email address 2.),\n  (AdmFName3 <TEXT>,  administrator's first name 3. Value examples: [None, 'Mark', 'Eric', 'Vickie', 'Tracie', 'Shawn', 'Sarah'].),\n  (AdmLName3 <TEXT>,  administrator's last name 3. Value examples: [None, 'Zerpoli', 'Yount', 'Woodruff', 'Wood', 'Wolk', 'Spotts'].),\n  (AdmEmail3 <TEXT>,  administrator's email address 3.),\n  (LastUpdate <DATE>,  Last Update. Value examples: ['2015-06-18'].)\n]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Question】\nAmong the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.\n【Evidence】\nMagnet schools or offer a magnet program means that Magnet = 1\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 60, "cur_total_response_tokens": 60}
{"idx": 6, "db_id": "california_schools", "query": "Among the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.", "evidence": "Magnet schools or offer a magnet program means that Magnet = 1", "difficulty": "simple", "ground_truth": "SELECT T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Magnet = 1 AND T1.NumTstTakr > 500", "send_to": "Decomposer", "response": "\n你好\n", "input_prompt": "[Instruction]\nGiven a 【query】, you need to understanding the intent of Query, and then deceompose it into Targets and Conditions. Then you need to combine Targets and Conditions into Subquerys step by step. \nFor the case where Conditions is NULL, consider Targets as the final Subquery directly. \nFor the case where Conditions are not NULL, combine Targets and the first Condition to get the first Subquery, then combine this Subquery and the next Condition into a new Subquery until all Conditions are used (which means the content of the last Subquery and the original Query is the same).\n\n[Requirements]\n-Try not to overlap Targets and Conditions.\n-Make sure the decomposed Target and Condition can cover all of the information in Query.\n-Don't change any information (specific value) in Query!\n-Mark each Subquery with ## in front of it.\n\nHere are some examples:\n==========\n\n【Query】\nShow the stadium name and the number of concerts in each stadium. Please also list the year the stadium was built. \n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the stadium name, the year the stadium built and the number of concerts in each stadium\nConditions: NULL\n\nSubqueries:\n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the stadium name, the year the stadium built and the number of concerts in each stadium\n==========\n\n【Query】\nWhat is the qualification rate for the H-11 products produced in 2023/11/2?\n【Evidence】\nqualification rate = `Numqualified(H-11)` / `production(H-11)`\n\n【Decomposition】\nTargets: List the qualification rate for the H-11 Products\nConditions:\n1. produced in 2023/11/2 --Condition_1\n\nSubqueries:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the qualification rate for the H-11 Products produced in 2023/11/2\n\n==========\n\n【Query】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n\n【Decomposition】\nTargets: List the race of institutions\nConditions: \n1. in Alabama --Condition_1\n2. number of students greater than the 90% of average number of students of all institutions --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the race of institution in Alabama\n2. Conbine the first Subquery and Conditon_2 to get the seconed Subquery.\n##Subquery: List the race of institutions in Alabama with number of number of students greater than the 90% of average number of students of all institutions\n\n==========\n\n【Query】\nWhich president got a higher approval rating, Joseph Biden or Donald Trump?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\nConditions: \nNULL\n\nSubqueries: \n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\n\n==========\n\n【Query】\nFor movie id 1269, how many users, who was a paying subscriber and was eligible for trial when he rated the movie, gave the movie a rating score of less than or equal to 2?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the number of users\nConditions:\n1. was a paying subscriber --Condition_1\n2. was eligible for trial --Condition_2\n3. for movie id 1269, gave the movie a rating score of less than or equal to 2 --Condition3\n\nSubquerys:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the number of users who was a paying subscriber\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial\n3. Combine the second Subquery and Condition_3 to get the third Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial and gave the movie whose id is 1269 a rating score of less than or equal to 2\n\n==========\n\nHere is a new query need to be decomposed:\n\n【Query】\nAmong the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.\n【Evidence】\nMagnet schools or offer a magnet program means that Magnet = 1\n\n【Decomposition】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 70, "cur_total_response_tokens": 70}
{"idx": 6, "db_id": "california_schools", "query": "Among the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.", "evidence": "Magnet schools or offer a magnet program means that Magnet = 1", "difficulty": "simple", "ground_truth": "SELECT T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Magnet = 1 AND T1.NumTstTakr > 500", "send_to": "Generator", "response": "\n你好\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】and a 【Question】, you need to use valid SQLite and understand the database and knowledge so that you can generate a good SQL for the 【Question】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# stadium: [Stadium_ID (INTEGER), Location (TEXT), Name (TEXT)]\n# concert: [concert_ID (INTEGER), concert_Name (TEXT), Stadium_ID (INTEGER)]\n【Primary keys】\nstadium.`Stadium_ID` | concert.`concert_ID`\n【Foreign keys】\nconcert.`Stadium_ID` = stadium.`Stadium_ID`\n【Detailed descriptions of tables and columns】\nstadium.`Stadium_ID`: The column 'Stadium_ID' in Table <stadium> has column descriptions of \"stadium id\". Value examples: [1, 2, 3, 4, 5, 6].\nstadium.`Name`:  The column 'Name' in Table <stadium> has column descriptions of \"name of stadium\". Value examples: [\"Stark's Park\", 'Somerset Park', 'Recreation Park', 'Hampden Park', 'Glebe Park', 'Gayfield Park'].\nstadium.`Location`: The column 'Location' in Table <stadium> has column descriptions of \"location of stadium\". Value examples: ['Stirling Albion', 'Raith Rovers', \"Queen's Park\", 'Peterhead', 'East Fife', 'Brechin City'].\nconcert.`concert_ID`: The column 'concert_ID' in Table <concert> has column descriptions of \"concert id\". Value examples: [1, 2, 3, 4, 5, 6].\nconcert.`concert_Name`: The column 'concert_Name' in Table <concert> has column descriptions of \"concert name\". Value examples: ['Week 1', 'Week 2', 'Super bootcamp', 'Home Visits', 'Auditions'].\nconcert.`Stadium_ID`: The column 'Stadium_ID' in Table <concert> has column descriptions of \"stadium id\". Value examples: [2, 9, 7, 10, 1].\n【Evidence】\nNULL\n【Question】\nShow the stadium name and the number of concerts in each stadium.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: Show the stadium name and the number of concerts in each stadium.\nTargets for `SELECT`: the stadium name and the number of concerts\nhints from 【Evidence】:NULL\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the stadium name refers to stadium.`Name`, the number of concerts refers to COUNT(concert.`concert_ID`), each stadium refers to stadium.`Stadium_ID`\nConnection of tables: include tables <stadium> and <concert>, get connected keys from 【Foreign keys】: concert.`Stadium_ID` = stadium.`Stadium_ID`\nFinal SQL:\n```sql\nSELECT T1.`Name`, COUNT(T2.concert_ID) AS num_concerts\n  FROM stadium AS T1\n  JOIN concert AS T2\n  ON T1.`Stadium_ID` = T2.`Stadium_ID`\n  GROUP BY T1.`Stadium_ID`\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); name of the car refers to car_name\n【Question】\nWhat is the fastest car made by Japan?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ncountry.`country` = 'Japan'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: What is the fastest car made by Japan?\nTargets for `SELECT`: the name of the fastest car\nhints from 【Evidence】: the fastest refers to max(horsepower); name of the car refers to car_name\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: car refers to data.`car_name`, the fastest refers to MAX(data.`horsepower`), Japan refers to country.`country`\nConnection of tables: includes tables <data> and <country>, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`car_name` \n  FROM data AS T1 \n  INNER JOIN production AS T2 \n  ON T1.`ID` = T2.`ID` \n  INNER JOIN country AS T3 \n  ON T3.`origin` = T2.`country` \n  WHERE T3.`country` = 'Japan' \n  ORDER BY T1.`horsepower` DESC LIMIT 1\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`chronname`: The column 'chronname' in Table <institution_details> has column descriptions of \"Institution name\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \n【Evidence】\nnumber of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the chronname of institutions with number of students greater than the 90% of average number of students of all institutions?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: List the chroname of institutions with number of students greater than the 90% of average number of students of all institutions?\nTargets for `SELECT`: the chroname of institutions\nhints from 【Evidence】: number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the chronname of institutions refers to institution_details.`chronname`, number of students refers to institution_details.`student_count`\nConnection of tables: include only one table <institution_details>, no connection\nFinal SQL:\n```sql\nSELECT DISTINCT `chroname`\n  FROM institution_details\n  WHERE `student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details\n  ) \n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\n\n【Evidence】\nMagnet schools or offer a magnet program means that Magnet = 1\n【Question】\nAmong the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 80, "cur_total_response_tokens": 80}
{"idx": 6, "db_id": "california_schools", "query": "Among the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.", "evidence": "Magnet schools or offer a magnet program means that Magnet = 1", "difficulty": "simple", "ground_truth": "SELECT T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Magnet = 1 AND T1.NumTstTakr > 500", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nMagnet schools or offer a magnet program means that Magnet = 1\n【Query】\n-- Among the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 90, "cur_total_response_tokens": 90}
{"idx": 6, "db_id": "california_schools", "query": "Among the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.", "evidence": "Magnet schools or offer a magnet program means that Magnet = 1", "difficulty": "simple", "ground_truth": "SELECT T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Magnet = 1 AND T1.NumTstTakr > 500", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nMagnet schools or offer a magnet program means that Magnet = 1\n【Query】\n-- Among the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 100, "cur_total_response_tokens": 100}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Soft_Schema_Linker", "response": "\n你好\n", "input_prompt": "As an experienced and professional database administrator, your task is to analyze a user question and a database schema to provide relevant information. The database schema consists of table descriptions, each containing multiple column descriptions. Your goal is to extract the entities from question and identify the relevant tables and columns based on these entities and the evidence provided.\n\n[Instruction]:\n1. Extract the mentioned entities from the user question. Make sure all of the entities are extracted. \n2. For each entity, keep at least 3 related columns.\n4. Your output should include entity extraction, analysis and related database schema.\n5. The related database schema should be in JSON format.\n6. Each column's information in provided 【Schema】 is in this format: (column, description. Value examples<optional>)\n\n[Requirements]:\n1. Sort the related columns in each list corresponding to each entity in descending order of relevance.\n2. The chosen columns should be in this format: <table.column>.\n3. Make sure each chosen list is not empty. The value [] will be punished. \n4.【Matched values】 may contain redundant or useless information in addition to the correct matching values, so you need to select the useful information in conjunction with the specific column names and descriptions.\n5. An entity may not have a corresponding evidence, which requires you to find the relevant columns yourself through your understanding of the database schema.\n\nHere is a typical example:\n\n==========\n【DB_ID】 banking_system\n【Schema】\n# Table: account\n[\n  (account_id <INTEGER>, the id of the account. Value examples: [11382, 11362, 2, 1, 2367].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (frequency <TEXT>, frequency of the acount. Value examples: ['POPLATEK MESICNE', 'POPLATEK TYDNE', 'POPLATEK PO OBRATU'].),\n  (date <DATE>, the creation date of the account. Value examples: ['1997-12-29', '1997-12-28'].)\n]\n# Table: client\n[\n  (client_id <INTEGER>, the unique number. Value examples: [13998, 13971, 2, 1, 2839].),\n  (gender <TEXT>, gender. Value examples: ['M', 'F']. And F：female . M：male ),\n  (birth_date <DATE>, birth date. Value examples: ['1987-09-27', '1986-08-13'].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (first_name <TEXT>, first_name.),\n  (last_name <TEXT>, last_name.)\n]\n# Table: loan\n[\n  (loan_id <INTEGER>, the id number identifying the loan data. Value examples: [4959, 4960, 4961].),\n  (account_id <INTEGER>, the id number identifying the account. Value examples: [10, 80, 55, 43].),\n  (date <DATE>, the date when the loan is approved. Value examples: ['1998-07-12', '1998-04-19'].),\n  (amount <INTEGER>, the id number identifying the loan data. Value examples: [1567, 7877, 9988].),\n  (duration <INTEGER>, the id number identifying the loan data. Value examples: [60, 48, 24, 12, 36].),\n  (payments <INTEGER>, the id number identifying the loan data. Value examples: [3456, 8972, 9845].),\n  (status <TEXT>, the id number identifying the loan data. Value examples: ['C', 'A', 'D', 'B'].)\n]\n# Table: district\n[\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76].),\n  (A2 <REAL>, area in square kilometers. Value examples: [50.5, 48.9].),\n  (A4 <INTEGER>, number of inhabitants. Value examples: [95907, 95616].),\n  (A5 <INTEGER>, number of households. Value examples: [35678, 34892].),\n  (A6 <REAL>, literacy rate. Value examples: [95.6, 92.3, 89.7].),\n  (A7 <INTEGER>, number of entrepreneurs. Value examples: [1234, 1456].),\n  (A8 <INTEGERt>, number of cities. Value examples: [5, 4].),\n  (A9 <INTEGER>, number of schools. Value examples: [15, 12, 10].),\n  (A10 <INTEGER>, number of hospitals. Value examples: [8, 6, 4].),\n  (A11 <REAL>, average salary. Value examples: [12541.5, 11277].),\n  (A12 <REAL>, poverty rate. Value examples: [12.4, 9.8].),\n  (A13 <REAL>, unemployment rate. Value examples: [8.2, 7.9].),\n  (A15 <INTEGER>, number of crimes. Value examples: [256, 189].)\n]\n【Primary keys】\naccount.`account_id` | client.`client_id` | loan.`loan_id` | district.`district_id`\n【Foreign keys】\nclient.`district_id` = district.`district_id`\n【Question】\nWhat is the gender of the youngest client who opened account in the lowest average salary branch and when did this client open the account? Please list their full name.\n【Evidence】\nLater birthdate refers to younger age; A11 refers to average salary; Full name refers to first_name, last_name\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\nThe entities extracted from the 【Question】 are: \n1. gender; \n2. youngest client; \n3. account; \n4. lowest average salary branch; \n5. when did this client open the account; \n6. full name\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. gender --no related evidence **the columns about gender are related**\n2. youngest client  --Later birthdate refers to younger age; **the columns about birth date of client and the id of client are related**\n3. account --no related evidence **the columns about account or account ids are related**\n4. lowest average salary branch  --A11 refers to average salary **the columns about average salary and branch are related**\n5. when did this client open the account --no related evidence **the columns about time or date of the account are related**\n6. full name  --Full name refers to first_name, last_name **the columns about first_name, last_name of the client are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"gender\": [\"client.gender\",\"client.client_id\",\"loan.status\"],\n  \"youngest client\": [\"client.birth_date\",\"client.client_id\",\"account.date\",\"loan.date\"],\n  \"account\": [\"account.account_id\",\"loan.account_id\",\"account.date\"],\n  \"lowest average salary branch\": [\"district.A11\",\"district.district_id\",\"district.A13\"],\n  \"when did this client open the account\": [\"account.date\",\"loan.date\",\"client.birth_date\"],\n  \"full name\": [\"client.first_name\",\"client.last_name\",\"client.client_id\"]\n}\n```\nQuestion Solved.\n\n==========\n\nHere is a new example, please start answering:\n\n【DB_ID】 california_schools\n【Schema】\n# Table: frpm\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (Academic Year <TEXT>,  Academic Year. Value examples: ['2014-2015'].),\n  (County Code <TEXT>,  County Code. Value examples: ['19', '37', '30', '36', '33', '43'].),\n  (District Code <INTEGER>,  District Code.),\n  (School Code <TEXT>,  School Code. Value examples: ['0000000', '9010745', '6121081', '6121073', '6121016', '6120968'].),\n  (County Name <TEXT>,  County Name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].),\n  (District Name <TEXT>,  District Name.),\n  (School Name <TEXT>,  School Name.),\n  (District Type <TEXT>,  District Type. Value examples: ['Unified School District', 'Elementary School District', 'High School District', 'County Office of Education (COE)', 'State Board of Education', 'Statewide Benefit Charter'].),\n  (School Type <TEXT>,  School Type. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].),\n  (Educational Option Type <TEXT>,  Educational Option Type. Value examples: [None, 'Traditional', 'Continuation School', 'Alternative School of Choice', 'Community Day School', 'Special Education School', 'County Community School'].),\n  (NSLP Provision Status <TEXT>,  NSLP Provision Status. Value examples: [None, 'Provision 2', 'Breakfast Provision 2', 'CEP', 'Multiple Provision Types', 'Provision 1', 'Lunch Provision 2'].),\n  (Charter School (Y/N) <INTEGER>,  Charter School (Y/N). Value examples: [None, 0, 1].),\n  (Charter School Number <TEXT>,  Charter School Number. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1700', '1696'].),\n  (Charter Funding Type <TEXT>,  Charter Funding Type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (IRC <INTEGER>,  IRC. Value examples: [None, 0, 1].),\n  (Low Grade <TEXT>,  Low Grade. Value examples: ['K', '9', '6', '7', 'P', '5'].),\n  (High Grade <TEXT>,  High Grade. Value examples: ['12', '5', '8', '6', '3', '4'].),\n  (Enrollment (K-12) <REAL>,  Enrollment (K-12).),\n  (Free Meal Count (K-12) <REAL>,  Free Meal Count (K-12).),\n  (Percent (%) Eligible Free (K-12) <REAL>,  Percent (%) Eligible Free (K-12).),\n  (FRPM Count (K-12) <REAL>,  Free or Reduced Price Meal Count (K-12).),\n  (Percent (%) Eligible FRPM (K-12) <REAL>,  Percent (%) Eligible FRPM (K-12).),\n  (Enrollment (Ages 5-17) <REAL>,  Enrollment (Ages 5-17).),\n  (Free Meal Count (Ages 5-17) <REAL>,  Free Meal Count (Ages 5-17).),\n  (Percent (%) Eligible Free (Ages 5-17) <REAL>,  Percent (%) Eligible Free (Ages 5-17).),\n  (FRPM Count (Ages 5-17) <REAL>,  FRPM Count (Ages 5-17).),\n  (Percent (%) Eligible FRPM (Ages 5-17) <REAL>,  Percent (%) Eligible FRPM (Ages 5-17).),\n  (2013-14 CALPADS Fall 1 Certification Status <INTEGER>,  2013-14 CALPADS Fall 1 Certification Status. Value examples: [1].)\n]\n# Table: satscores\n[\n  (cds <TEXT>,  California Department Schools.),\n  (rtype <TEXT>,  rtype. Value examples: ['S', 'D'].),\n  (sname <TEXT>,  school name. Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].),\n  (dname <TEXT>,  district segment. Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].),\n  (cname <TEXT>,  county name. Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].),\n  (enroll12 <INTEGER>,  enrollment (1st-12nd grade).),\n  (NumTstTakr <INTEGER>,  Number of Test Takers in this school.),\n  (AvgScrRead <INTEGER>,  average scores in Reading.),\n  (AvgScrMath <INTEGER>,  average scores in Math.),\n  (AvgScrWrite <INTEGER>,  average scores in writing.),\n  (NumGE1500 <INTEGER>,  Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500.)\n]\n# Table: schools\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (NCESDist <TEXT>,  This field represents the 7-digit National Center for Educational Statistics (NCES) school district identification number. The first 2 digits identify the state and the last 5 digits identify the school district. Combined, they make a unique 7-digit ID for each school district.. Value examples: [None, '0622710', '0634320', '0628050', '0634410', '0614550', '0633840'].),\n  (NCESSchool <TEXT>,  This field represents the 5-digit NCES school identification number. The NCESSchool combined with the NCESDist form a unique 12-digit ID for each school.. Value examples: [None, '12271', '13785', '13747', '12909', '12311', '12003'].),\n  (StatusType <TEXT>,  This field identifies the status of the district.. Value examples: ['Active', 'Closed', 'Merged', 'Pending'].),\n  (County <TEXT>,  County name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].),\n  (District <TEXT>,  District.),\n  (School <TEXT>,  School.),\n  (Street <TEXT>,  Street.),\n  (StreetAbr <TEXT>,  The abbreviated street address of the school, district, or administrative authority’s physical location..),\n  (City <TEXT>,  City. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].),\n  (Zip <TEXT>,  Zip. Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].),\n  (State <TEXT>,  State. Value examples: [None, 'CA'].),\n  (MailStreet <TEXT>,  MailStreet.),\n  (MailStrAbr <TEXT>,  mailing street address.),\n  (MailCity <TEXT>,  mailing city. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].),\n  (MailZip <TEXT>,  mailing zip. Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].),\n  (MailState <TEXT>,  mailing state. Value examples: [None, 'CA'].),\n  (Phone <TEXT>,  Phone. Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].),\n  (Ext <TEXT>,  The phone number extension of the school, district, or administrative authority.. Value examples: [None, '200', '201', '111', '352', '221', '203'].),\n  (Website <TEXT>,  The website address of the school, district, or administrative authority..),\n  (OpenDate <DATE>,  The date the school opened.. Value examples: [None, '1980-07-01'].),\n  (ClosedDate <DATE>,  The date the school closed.. Value examples: [None, '1989-06-30'].),\n  (Charter <INTEGER>,  This field identifies a charter school.. Value examples: [None, 0, 1].),\n  (CharterNum <TEXT>,  The charter school number,. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1826', '1710'].),\n  (FundingType <TEXT>,  Indicates the charter school funding type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (DOC <TEXT>,  District Ownership Code. Value examples: ['54', '52', '00', '56', '98', '02'].),\n  (DOCType <TEXT>,  The District Ownership Code Type is the text description of the DOC category.. Value examples: ['Unified School District', 'Elementary School District', 'County Office of Education (COE)', 'High School District', 'Regional Occupation Center/Program (ROC/P)', 'State Board of Education'].),\n  (SOC <TEXT>,  The School Ownership Code is a numeric code used to identify the type of school.. Value examples: [None, '60', '66', '62', '68', '09', '69'].),\n  (SOCType <TEXT>,  The School Ownership Code Type is the text description of the type of school.. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Special Education Schools (Public)', 'District Community Day Schools'].),\n  (EdOpsCode <TEXT>,  The Education Option Code is a short text description of the type of education offered.. Value examples: [None, 'TRAD', 'CON', 'COMMDAY', 'ALTSOC', 'SPEC', 'COMM'].),\n  (EdOpsName <TEXT>,  Educational Option Name. Value examples: [None, 'Traditional', 'Continuation School', 'Community Day School', 'Alternative School of Choice', 'Special Education School', 'County Community School'].),\n  (EILCode <TEXT>,  The Educational Instruction Level Code is a short text description of the institution's type relative to the grade range served.. Value examples: [None, 'ELEM', 'HS', 'UG', 'INTMIDJR', 'ELEMHIGH', 'A'].),\n  (EILName <TEXT>,  The Educational Instruction Level Name is the long text description of the institution’s type relative to the grade range served.. Value examples: [None, 'Elementary', 'High School', 'Ungraded', 'Intermediate/Middle/Junior High', 'Elementary-High Combination', 'Adult'].),\n  (GSoffered <TEXT>,  The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.. Value examples: [None, 'K-5', '9-12', 'K-6', 'K-8', '6-8', 'K-12'].),\n  (GSserved <TEXT>,  It is the lowest grade and the highest grade of student enrollment as reported in the most recent certified CALPADS Fall 1 data collection. Only K–12 enrollment is reported through CALPADS. This field may differ from the grade span offered.. Value examples: [None, 'K-5', 'K-6', '9-12', 'K-8', '6-8', '7-8'].),\n  (Virtual <TEXT>,  This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.. Value examples: [None, 'N', 'P', 'F'].),\n  (Magnet <INTEGER>,  This field identifies whether a school is a magnet school and/or provides a magnet program.. Value examples: [None, 0, 1].),\n  (Latitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the equator measured north to south..),\n  (Longitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the prime meridian (Greenwich, England) measured from west to east..),\n  (AdmFName1 <TEXT>,  administrator's first name 1. Value examples: [None, 'David', 'Michael', 'John', 'Jennifer', 'Lisa', 'Robert'].),\n  (AdmLName1 <TEXT>,  administrator's last name 1.),\n  (AdmEmail1 <TEXT>,  administrator's email address 1.),\n  (AdmFName2 <TEXT>,  administrator's first name 2. Value examples: [None, 'Steve', 'Delphine', 'Tim', 'Michael', 'Lisa', 'Jeff'].),\n  (AdmLName2 <TEXT>,  administrator's last name 2. Value examples: [None, 'Sherman', 'Jones', 'Wilson', 'Petersen', 'Landry', 'Hambright'].),\n  (AdmEmail2 <TEXT>,  administrator's email address 2.),\n  (AdmFName3 <TEXT>,  administrator's first name 3. Value examples: [None, 'Mark', 'Eric', 'Vickie', 'Tracie', 'Shawn', 'Sarah'].),\n  (AdmLName3 <TEXT>,  administrator's last name 3. Value examples: [None, 'Zerpoli', 'Yount', 'Woodruff', 'Wood', 'Wolk', 'Spotts'].),\n  (AdmEmail3 <TEXT>,  administrator's email address 3.),\n  (LastUpdate <DATE>,  Last Update. Value examples: ['2015-06-18'].)\n]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Question】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 10, "cur_total_response_tokens": 10}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Decomposer", "response": "\n你好\n", "input_prompt": "[Instruction]\nGiven a 【query】, you need to understanding the intent of Query, and then deceompose it into Targets and Conditions. Then you need to combine Targets and Conditions into Subquerys step by step. \nFor the case where Conditions is NULL, consider Targets as the final Subquery directly. \nFor the case where Conditions are not NULL, combine Targets and the first Condition to get the first Subquery, then combine this Subquery and the next Condition into a new Subquery until all Conditions are used (which means the content of the last Subquery and the original Query is the same).\n\n[Requirements]\n-Try not to overlap Targets and Conditions.\n-Make sure the decomposed Target and Condition can cover all of the information in Query.\n-Don't change any information (specific value) in Query!\n-Mark each Subquery with ## in front of it.\n\nHere are some examples:\n==========\n\n【Query】\nShow the stadium name and the number of concerts in each stadium. Please also list the year the stadium was built. \n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the stadium name, the year the stadium built and the number of concerts in each stadium\nConditions: NULL\n\nSubqueries:\n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the stadium name, the year the stadium built and the number of concerts in each stadium\n==========\n\n【Query】\nWhat is the qualification rate for the H-11 products produced in 2023/11/2?\n【Evidence】\nqualification rate = `Numqualified(H-11)` / `production(H-11)`\n\n【Decomposition】\nTargets: List the qualification rate for the H-11 Products\nConditions:\n1. produced in 2023/11/2 --Condition_1\n\nSubqueries:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the qualification rate for the H-11 Products produced in 2023/11/2\n\n==========\n\n【Query】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n\n【Decomposition】\nTargets: List the race of institutions\nConditions: \n1. in Alabama --Condition_1\n2. number of students greater than the 90% of average number of students of all institutions --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the race of institution in Alabama\n2. Conbine the first Subquery and Conditon_2 to get the seconed Subquery.\n##Subquery: List the race of institutions in Alabama with number of number of students greater than the 90% of average number of students of all institutions\n\n==========\n\n【Query】\nWhich president got a higher approval rating, Joseph Biden or Donald Trump?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\nConditions: \nNULL\n\nSubqueries: \n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\n\n==========\n\n【Query】\nFor movie id 1269, how many users, who was a paying subscriber and was eligible for trial when he rated the movie, gave the movie a rating score of less than or equal to 2?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the number of users\nConditions:\n1. was a paying subscriber --Condition_1\n2. was eligible for trial --Condition_2\n3. for movie id 1269, gave the movie a rating score of less than or equal to 2 --Condition3\n\nSubquerys:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the number of users who was a paying subscriber\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial\n3. Combine the second Subquery and Condition_3 to get the third Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial and gave the movie whose id is 1269 a rating score of less than or equal to 2\n\n==========\n\nHere is a new query need to be decomposed:\n\n【Query】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n\n【Decomposition】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 20, "cur_total_response_tokens": 20}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Generator", "response": "\n你好\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】and a 【Question】, you need to use valid SQLite and understand the database and knowledge so that you can generate a good SQL for the 【Question】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# stadium: [Stadium_ID (INTEGER), Location (TEXT), Name (TEXT)]\n# concert: [concert_ID (INTEGER), concert_Name (TEXT), Stadium_ID (INTEGER)]\n【Primary keys】\nstadium.`Stadium_ID` | concert.`concert_ID`\n【Foreign keys】\nconcert.`Stadium_ID` = stadium.`Stadium_ID`\n【Detailed descriptions of tables and columns】\nstadium.`Stadium_ID`: The column 'Stadium_ID' in Table <stadium> has column descriptions of \"stadium id\". Value examples: [1, 2, 3, 4, 5, 6].\nstadium.`Name`:  The column 'Name' in Table <stadium> has column descriptions of \"name of stadium\". Value examples: [\"Stark's Park\", 'Somerset Park', 'Recreation Park', 'Hampden Park', 'Glebe Park', 'Gayfield Park'].\nstadium.`Location`: The column 'Location' in Table <stadium> has column descriptions of \"location of stadium\". Value examples: ['Stirling Albion', 'Raith Rovers', \"Queen's Park\", 'Peterhead', 'East Fife', 'Brechin City'].\nconcert.`concert_ID`: The column 'concert_ID' in Table <concert> has column descriptions of \"concert id\". Value examples: [1, 2, 3, 4, 5, 6].\nconcert.`concert_Name`: The column 'concert_Name' in Table <concert> has column descriptions of \"concert name\". Value examples: ['Week 1', 'Week 2', 'Super bootcamp', 'Home Visits', 'Auditions'].\nconcert.`Stadium_ID`: The column 'Stadium_ID' in Table <concert> has column descriptions of \"stadium id\". Value examples: [2, 9, 7, 10, 1].\n【Evidence】\nNULL\n【Question】\nShow the stadium name and the number of concerts in each stadium.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: Show the stadium name and the number of concerts in each stadium.\nTargets for `SELECT`: the stadium name and the number of concerts\nhints from 【Evidence】:NULL\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the stadium name refers to stadium.`Name`, the number of concerts refers to COUNT(concert.`concert_ID`), each stadium refers to stadium.`Stadium_ID`\nConnection of tables: include tables <stadium> and <concert>, get connected keys from 【Foreign keys】: concert.`Stadium_ID` = stadium.`Stadium_ID`\nFinal SQL:\n```sql\nSELECT T1.`Name`, COUNT(T2.concert_ID) AS num_concerts\n  FROM stadium AS T1\n  JOIN concert AS T2\n  ON T1.`Stadium_ID` = T2.`Stadium_ID`\n  GROUP BY T1.`Stadium_ID`\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); name of the car refers to car_name\n【Question】\nWhat is the fastest car made by Japan?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ncountry.`country` = 'Japan'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: What is the fastest car made by Japan?\nTargets for `SELECT`: the name of the fastest car\nhints from 【Evidence】: the fastest refers to max(horsepower); name of the car refers to car_name\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: car refers to data.`car_name`, the fastest refers to MAX(data.`horsepower`), Japan refers to country.`country`\nConnection of tables: includes tables <data> and <country>, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`car_name` \n  FROM data AS T1 \n  INNER JOIN production AS T2 \n  ON T1.`ID` = T2.`ID` \n  INNER JOIN country AS T3 \n  ON T3.`origin` = T2.`country` \n  WHERE T3.`country` = 'Japan' \n  ORDER BY T1.`horsepower` DESC LIMIT 1\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`chronname`: The column 'chronname' in Table <institution_details> has column descriptions of \"Institution name\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \n【Evidence】\nnumber of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the chronname of institutions with number of students greater than the 90% of average number of students of all institutions?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: List the chroname of institutions with number of students greater than the 90% of average number of students of all institutions?\nTargets for `SELECT`: the chroname of institutions\nhints from 【Evidence】: number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the chronname of institutions refers to institution_details.`chronname`, number of students refers to institution_details.`student_count`\nConnection of tables: include only one table <institution_details>, no connection\nFinal SQL:\n```sql\nSELECT DISTINCT `chroname`\n  FROM institution_details\n  WHERE `student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details\n  ) \n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Question】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 30, "cur_total_response_tokens": 30}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Query】\n-- How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 40, "cur_total_response_tokens": 40}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Query】\n-- How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 50, "cur_total_response_tokens": 50}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Soft_Schema_Linker", "response": "\n你好\n", "input_prompt": "As an experienced and professional database administrator, your task is to analyze a user question and a database schema to provide relevant information. The database schema consists of table descriptions, each containing multiple column descriptions. Your goal is to extract the entities from question and identify the relevant tables and columns based on these entities and the evidence provided.\n\n[Instruction]:\n1. Extract the mentioned entities from the user question. Make sure all of the entities are extracted. \n2. For each entity, keep at least 3 related columns.\n4. Your output should include entity extraction, analysis and related database schema.\n5. The related database schema should be in JSON format.\n6. Each column's information in provided 【Schema】 is in this format: (column, description. Value examples<optional>)\n\n[Requirements]:\n1. Sort the related columns in each list corresponding to each entity in descending order of relevance.\n2. The chosen columns should be in this format: <table.column>.\n3. Make sure each chosen list is not empty. The value [] will be punished. \n4.【Matched values】 may contain redundant or useless information in addition to the correct matching values, so you need to select the useful information in conjunction with the specific column names and descriptions.\n5. An entity may not have a corresponding evidence, which requires you to find the relevant columns yourself through your understanding of the database schema.\n\nHere is a typical example:\n\n==========\n【DB_ID】 banking_system\n【Schema】\n# Table: account\n[\n  (account_id <INTEGER>, the id of the account. Value examples: [11382, 11362, 2, 1, 2367].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (frequency <TEXT>, frequency of the acount. Value examples: ['POPLATEK MESICNE', 'POPLATEK TYDNE', 'POPLATEK PO OBRATU'].),\n  (date <DATE>, the creation date of the account. Value examples: ['1997-12-29', '1997-12-28'].)\n]\n# Table: client\n[\n  (client_id <INTEGER>, the unique number. Value examples: [13998, 13971, 2, 1, 2839].),\n  (gender <TEXT>, gender. Value examples: ['M', 'F']. And F：female . M：male ),\n  (birth_date <DATE>, birth date. Value examples: ['1987-09-27', '1986-08-13'].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (first_name <TEXT>, first_name.),\n  (last_name <TEXT>, last_name.)\n]\n# Table: loan\n[\n  (loan_id <INTEGER>, the id number identifying the loan data. Value examples: [4959, 4960, 4961].),\n  (account_id <INTEGER>, the id number identifying the account. Value examples: [10, 80, 55, 43].),\n  (date <DATE>, the date when the loan is approved. Value examples: ['1998-07-12', '1998-04-19'].),\n  (amount <INTEGER>, the id number identifying the loan data. Value examples: [1567, 7877, 9988].),\n  (duration <INTEGER>, the id number identifying the loan data. Value examples: [60, 48, 24, 12, 36].),\n  (payments <INTEGER>, the id number identifying the loan data. Value examples: [3456, 8972, 9845].),\n  (status <TEXT>, the id number identifying the loan data. Value examples: ['C', 'A', 'D', 'B'].)\n]\n# Table: district\n[\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76].),\n  (A2 <REAL>, area in square kilometers. Value examples: [50.5, 48.9].),\n  (A4 <INTEGER>, number of inhabitants. Value examples: [95907, 95616].),\n  (A5 <INTEGER>, number of households. Value examples: [35678, 34892].),\n  (A6 <REAL>, literacy rate. Value examples: [95.6, 92.3, 89.7].),\n  (A7 <INTEGER>, number of entrepreneurs. Value examples: [1234, 1456].),\n  (A8 <INTEGERt>, number of cities. Value examples: [5, 4].),\n  (A9 <INTEGER>, number of schools. Value examples: [15, 12, 10].),\n  (A10 <INTEGER>, number of hospitals. Value examples: [8, 6, 4].),\n  (A11 <REAL>, average salary. Value examples: [12541.5, 11277].),\n  (A12 <REAL>, poverty rate. Value examples: [12.4, 9.8].),\n  (A13 <REAL>, unemployment rate. Value examples: [8.2, 7.9].),\n  (A15 <INTEGER>, number of crimes. Value examples: [256, 189].)\n]\n【Primary keys】\naccount.`account_id` | client.`client_id` | loan.`loan_id` | district.`district_id`\n【Foreign keys】\nclient.`district_id` = district.`district_id`\n【Question】\nWhat is the gender of the youngest client who opened account in the lowest average salary branch and when did this client open the account? Please list their full name.\n【Evidence】\nLater birthdate refers to younger age; A11 refers to average salary; Full name refers to first_name, last_name\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\nThe entities extracted from the 【Question】 are: \n1. gender; \n2. youngest client; \n3. account; \n4. lowest average salary branch; \n5. when did this client open the account; \n6. full name\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. gender --no related evidence **the columns about gender are related**\n2. youngest client  --Later birthdate refers to younger age; **the columns about birth date of client and the id of client are related**\n3. account --no related evidence **the columns about account or account ids are related**\n4. lowest average salary branch  --A11 refers to average salary **the columns about average salary and branch are related**\n5. when did this client open the account --no related evidence **the columns about time or date of the account are related**\n6. full name  --Full name refers to first_name, last_name **the columns about first_name, last_name of the client are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"gender\": [\"client.gender\",\"client.client_id\",\"loan.status\"],\n  \"youngest client\": [\"client.birth_date\",\"client.client_id\",\"account.date\",\"loan.date\"],\n  \"account\": [\"account.account_id\",\"loan.account_id\",\"account.date\"],\n  \"lowest average salary branch\": [\"district.A11\",\"district.district_id\",\"district.A13\"],\n  \"when did this client open the account\": [\"account.date\",\"loan.date\",\"client.birth_date\"],\n  \"full name\": [\"client.first_name\",\"client.last_name\",\"client.client_id\"]\n}\n```\nQuestion Solved.\n\n==========\n\nHere is a new example, please start answering:\n\n【DB_ID】 california_schools\n【Schema】\n# Table: frpm\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (Academic Year <TEXT>,  Academic Year. Value examples: ['2014-2015'].),\n  (County Code <TEXT>,  County Code. Value examples: ['19', '37', '30', '36', '33', '43'].),\n  (District Code <INTEGER>,  District Code.),\n  (School Code <TEXT>,  School Code. Value examples: ['0000000', '9010745', '6121081', '6121073', '6121016', '6120968'].),\n  (County Name <TEXT>,  County Name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].),\n  (District Name <TEXT>,  District Name.),\n  (School Name <TEXT>,  School Name.),\n  (District Type <TEXT>,  District Type. Value examples: ['Unified School District', 'Elementary School District', 'High School District', 'County Office of Education (COE)', 'State Board of Education', 'Statewide Benefit Charter'].),\n  (School Type <TEXT>,  School Type. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].),\n  (Educational Option Type <TEXT>,  Educational Option Type. Value examples: [None, 'Traditional', 'Continuation School', 'Alternative School of Choice', 'Community Day School', 'Special Education School', 'County Community School'].),\n  (NSLP Provision Status <TEXT>,  NSLP Provision Status. Value examples: [None, 'Provision 2', 'Breakfast Provision 2', 'CEP', 'Multiple Provision Types', 'Provision 1', 'Lunch Provision 2'].),\n  (Charter School (Y/N) <INTEGER>,  Charter School (Y/N). Value examples: [None, 0, 1].),\n  (Charter School Number <TEXT>,  Charter School Number. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1700', '1696'].),\n  (Charter Funding Type <TEXT>,  Charter Funding Type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (IRC <INTEGER>,  IRC. Value examples: [None, 0, 1].),\n  (Low Grade <TEXT>,  Low Grade. Value examples: ['K', '9', '6', '7', 'P', '5'].),\n  (High Grade <TEXT>,  High Grade. Value examples: ['12', '5', '8', '6', '3', '4'].),\n  (Enrollment (K-12) <REAL>,  Enrollment (K-12).),\n  (Free Meal Count (K-12) <REAL>,  Free Meal Count (K-12).),\n  (Percent (%) Eligible Free (K-12) <REAL>,  Percent (%) Eligible Free (K-12).),\n  (FRPM Count (K-12) <REAL>,  Free or Reduced Price Meal Count (K-12).),\n  (Percent (%) Eligible FRPM (K-12) <REAL>,  Percent (%) Eligible FRPM (K-12).),\n  (Enrollment (Ages 5-17) <REAL>,  Enrollment (Ages 5-17).),\n  (Free Meal Count (Ages 5-17) <REAL>,  Free Meal Count (Ages 5-17).),\n  (Percent (%) Eligible Free (Ages 5-17) <REAL>,  Percent (%) Eligible Free (Ages 5-17).),\n  (FRPM Count (Ages 5-17) <REAL>,  FRPM Count (Ages 5-17).),\n  (Percent (%) Eligible FRPM (Ages 5-17) <REAL>,  Percent (%) Eligible FRPM (Ages 5-17).),\n  (2013-14 CALPADS Fall 1 Certification Status <INTEGER>,  2013-14 CALPADS Fall 1 Certification Status. Value examples: [1].)\n]\n# Table: satscores\n[\n  (cds <TEXT>,  California Department Schools.),\n  (rtype <TEXT>,  rtype. Value examples: ['S', 'D'].),\n  (sname <TEXT>,  school name. Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].),\n  (dname <TEXT>,  district segment. Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].),\n  (cname <TEXT>,  county name. Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].),\n  (enroll12 <INTEGER>,  enrollment (1st-12nd grade).),\n  (NumTstTakr <INTEGER>,  Number of Test Takers in this school.),\n  (AvgScrRead <INTEGER>,  average scores in Reading.),\n  (AvgScrMath <INTEGER>,  average scores in Math.),\n  (AvgScrWrite <INTEGER>,  average scores in writing.),\n  (NumGE1500 <INTEGER>,  Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500.)\n]\n# Table: schools\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (NCESDist <TEXT>,  This field represents the 7-digit National Center for Educational Statistics (NCES) school district identification number. The first 2 digits identify the state and the last 5 digits identify the school district. Combined, they make a unique 7-digit ID for each school district.. Value examples: [None, '0622710', '0634320', '0628050', '0634410', '0614550', '0633840'].),\n  (NCESSchool <TEXT>,  This field represents the 5-digit NCES school identification number. The NCESSchool combined with the NCESDist form a unique 12-digit ID for each school.. Value examples: [None, '12271', '13785', '13747', '12909', '12311', '12003'].),\n  (StatusType <TEXT>,  This field identifies the status of the district.. Value examples: ['Active', 'Closed', 'Merged', 'Pending'].),\n  (County <TEXT>,  County name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].),\n  (District <TEXT>,  District.),\n  (School <TEXT>,  School.),\n  (Street <TEXT>,  Street.),\n  (StreetAbr <TEXT>,  The abbreviated street address of the school, district, or administrative authority’s physical location..),\n  (City <TEXT>,  City. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].),\n  (Zip <TEXT>,  Zip. Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].),\n  (State <TEXT>,  State. Value examples: [None, 'CA'].),\n  (MailStreet <TEXT>,  MailStreet.),\n  (MailStrAbr <TEXT>,  mailing street address.),\n  (MailCity <TEXT>,  mailing city. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].),\n  (MailZip <TEXT>,  mailing zip. Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].),\n  (MailState <TEXT>,  mailing state. Value examples: [None, 'CA'].),\n  (Phone <TEXT>,  Phone. Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].),\n  (Ext <TEXT>,  The phone number extension of the school, district, or administrative authority.. Value examples: [None, '200', '201', '111', '352', '221', '203'].),\n  (Website <TEXT>,  The website address of the school, district, or administrative authority..),\n  (OpenDate <DATE>,  The date the school opened.. Value examples: [None, '1980-07-01'].),\n  (ClosedDate <DATE>,  The date the school closed.. Value examples: [None, '1989-06-30'].),\n  (Charter <INTEGER>,  This field identifies a charter school.. Value examples: [None, 0, 1].),\n  (CharterNum <TEXT>,  The charter school number,. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1826', '1710'].),\n  (FundingType <TEXT>,  Indicates the charter school funding type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (DOC <TEXT>,  District Ownership Code. Value examples: ['54', '52', '00', '56', '98', '02'].),\n  (DOCType <TEXT>,  The District Ownership Code Type is the text description of the DOC category.. Value examples: ['Unified School District', 'Elementary School District', 'County Office of Education (COE)', 'High School District', 'Regional Occupation Center/Program (ROC/P)', 'State Board of Education'].),\n  (SOC <TEXT>,  The School Ownership Code is a numeric code used to identify the type of school.. Value examples: [None, '60', '66', '62', '68', '09', '69'].),\n  (SOCType <TEXT>,  The School Ownership Code Type is the text description of the type of school.. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Special Education Schools (Public)', 'District Community Day Schools'].),\n  (EdOpsCode <TEXT>,  The Education Option Code is a short text description of the type of education offered.. Value examples: [None, 'TRAD', 'CON', 'COMMDAY', 'ALTSOC', 'SPEC', 'COMM'].),\n  (EdOpsName <TEXT>,  Educational Option Name. Value examples: [None, 'Traditional', 'Continuation School', 'Community Day School', 'Alternative School of Choice', 'Special Education School', 'County Community School'].),\n  (EILCode <TEXT>,  The Educational Instruction Level Code is a short text description of the institution's type relative to the grade range served.. Value examples: [None, 'ELEM', 'HS', 'UG', 'INTMIDJR', 'ELEMHIGH', 'A'].),\n  (EILName <TEXT>,  The Educational Instruction Level Name is the long text description of the institution’s type relative to the grade range served.. Value examples: [None, 'Elementary', 'High School', 'Ungraded', 'Intermediate/Middle/Junior High', 'Elementary-High Combination', 'Adult'].),\n  (GSoffered <TEXT>,  The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.. Value examples: [None, 'K-5', '9-12', 'K-6', 'K-8', '6-8', 'K-12'].),\n  (GSserved <TEXT>,  It is the lowest grade and the highest grade of student enrollment as reported in the most recent certified CALPADS Fall 1 data collection. Only K–12 enrollment is reported through CALPADS. This field may differ from the grade span offered.. Value examples: [None, 'K-5', 'K-6', '9-12', 'K-8', '6-8', '7-8'].),\n  (Virtual <TEXT>,  This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.. Value examples: [None, 'N', 'P', 'F'].),\n  (Magnet <INTEGER>,  This field identifies whether a school is a magnet school and/or provides a magnet program.. Value examples: [None, 0, 1].),\n  (Latitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the equator measured north to south..),\n  (Longitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the prime meridian (Greenwich, England) measured from west to east..),\n  (AdmFName1 <TEXT>,  administrator's first name 1. Value examples: [None, 'David', 'Michael', 'John', 'Jennifer', 'Lisa', 'Robert'].),\n  (AdmLName1 <TEXT>,  administrator's last name 1.),\n  (AdmEmail1 <TEXT>,  administrator's email address 1.),\n  (AdmFName2 <TEXT>,  administrator's first name 2. Value examples: [None, 'Steve', 'Delphine', 'Tim', 'Michael', 'Lisa', 'Jeff'].),\n  (AdmLName2 <TEXT>,  administrator's last name 2. Value examples: [None, 'Sherman', 'Jones', 'Wilson', 'Petersen', 'Landry', 'Hambright'].),\n  (AdmEmail2 <TEXT>,  administrator's email address 2.),\n  (AdmFName3 <TEXT>,  administrator's first name 3. Value examples: [None, 'Mark', 'Eric', 'Vickie', 'Tracie', 'Shawn', 'Sarah'].),\n  (AdmLName3 <TEXT>,  administrator's last name 3. Value examples: [None, 'Zerpoli', 'Yount', 'Woodruff', 'Wood', 'Wolk', 'Spotts'].),\n  (AdmEmail3 <TEXT>,  administrator's email address 3.),\n  (LastUpdate <DATE>,  Last Update. Value examples: ['2015-06-18'].)\n]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Question】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 10, "cur_total_response_tokens": 10}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Decomposer", "response": "\n你好\n", "input_prompt": "[Instruction]\nGiven a 【query】, you need to understanding the intent of Query, and then deceompose it into Targets and Conditions. Then you need to combine Targets and Conditions into Subquerys step by step. \nFor the case where Conditions is NULL, consider Targets as the final Subquery directly. \nFor the case where Conditions are not NULL, combine Targets and the first Condition to get the first Subquery, then combine this Subquery and the next Condition into a new Subquery until all Conditions are used (which means the content of the last Subquery and the original Query is the same).\n\n[Requirements]\n-Try not to overlap Targets and Conditions.\n-Make sure the decomposed Target and Condition can cover all of the information in Query.\n-Don't change any information (specific value) in Query!\n-Mark each Subquery with ## in front of it.\n\nHere are some examples:\n==========\n\n【Query】\nShow the stadium name and the number of concerts in each stadium. Please also list the year the stadium was built. \n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the stadium name, the year the stadium built and the number of concerts in each stadium\nConditions: NULL\n\nSubqueries:\n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the stadium name, the year the stadium built and the number of concerts in each stadium\n==========\n\n【Query】\nWhat is the qualification rate for the H-11 products produced in 2023/11/2?\n【Evidence】\nqualification rate = `Numqualified(H-11)` / `production(H-11)`\n\n【Decomposition】\nTargets: List the qualification rate for the H-11 Products\nConditions:\n1. produced in 2023/11/2 --Condition_1\n\nSubqueries:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the qualification rate for the H-11 Products produced in 2023/11/2\n\n==========\n\n【Query】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n\n【Decomposition】\nTargets: List the race of institutions\nConditions: \n1. in Alabama --Condition_1\n2. number of students greater than the 90% of average number of students of all institutions --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the race of institution in Alabama\n2. Conbine the first Subquery and Conditon_2 to get the seconed Subquery.\n##Subquery: List the race of institutions in Alabama with number of number of students greater than the 90% of average number of students of all institutions\n\n==========\n\n【Query】\nWhich president got a higher approval rating, Joseph Biden or Donald Trump?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\nConditions: \nNULL\n\nSubqueries: \n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\n\n==========\n\n【Query】\nFor movie id 1269, how many users, who was a paying subscriber and was eligible for trial when he rated the movie, gave the movie a rating score of less than or equal to 2?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the number of users\nConditions:\n1. was a paying subscriber --Condition_1\n2. was eligible for trial --Condition_2\n3. for movie id 1269, gave the movie a rating score of less than or equal to 2 --Condition3\n\nSubquerys:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the number of users who was a paying subscriber\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial\n3. Combine the second Subquery and Condition_3 to get the third Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial and gave the movie whose id is 1269 a rating score of less than or equal to 2\n\n==========\n\nHere is a new query need to be decomposed:\n\n【Query】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n\n【Decomposition】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 20, "cur_total_response_tokens": 20}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Generator", "response": "\n你好\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】and a 【Question】, you need to use valid SQLite and understand the database and knowledge so that you can generate a good SQL for the 【Question】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# stadium: [Stadium_ID (INTEGER), Location (TEXT), Name (TEXT)]\n# concert: [concert_ID (INTEGER), concert_Name (TEXT), Stadium_ID (INTEGER)]\n【Primary keys】\nstadium.`Stadium_ID` | concert.`concert_ID`\n【Foreign keys】\nconcert.`Stadium_ID` = stadium.`Stadium_ID`\n【Detailed descriptions of tables and columns】\nstadium.`Stadium_ID`: The column 'Stadium_ID' in Table <stadium> has column descriptions of \"stadium id\". Value examples: [1, 2, 3, 4, 5, 6].\nstadium.`Name`:  The column 'Name' in Table <stadium> has column descriptions of \"name of stadium\". Value examples: [\"Stark's Park\", 'Somerset Park', 'Recreation Park', 'Hampden Park', 'Glebe Park', 'Gayfield Park'].\nstadium.`Location`: The column 'Location' in Table <stadium> has column descriptions of \"location of stadium\". Value examples: ['Stirling Albion', 'Raith Rovers', \"Queen's Park\", 'Peterhead', 'East Fife', 'Brechin City'].\nconcert.`concert_ID`: The column 'concert_ID' in Table <concert> has column descriptions of \"concert id\". Value examples: [1, 2, 3, 4, 5, 6].\nconcert.`concert_Name`: The column 'concert_Name' in Table <concert> has column descriptions of \"concert name\". Value examples: ['Week 1', 'Week 2', 'Super bootcamp', 'Home Visits', 'Auditions'].\nconcert.`Stadium_ID`: The column 'Stadium_ID' in Table <concert> has column descriptions of \"stadium id\". Value examples: [2, 9, 7, 10, 1].\n【Evidence】\nNULL\n【Question】\nShow the stadium name and the number of concerts in each stadium.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: Show the stadium name and the number of concerts in each stadium.\nTargets for `SELECT`: the stadium name and the number of concerts\nhints from 【Evidence】:NULL\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the stadium name refers to stadium.`Name`, the number of concerts refers to COUNT(concert.`concert_ID`), each stadium refers to stadium.`Stadium_ID`\nConnection of tables: include tables <stadium> and <concert>, get connected keys from 【Foreign keys】: concert.`Stadium_ID` = stadium.`Stadium_ID`\nFinal SQL:\n```sql\nSELECT T1.`Name`, COUNT(T2.concert_ID) AS num_concerts\n  FROM stadium AS T1\n  JOIN concert AS T2\n  ON T1.`Stadium_ID` = T2.`Stadium_ID`\n  GROUP BY T1.`Stadium_ID`\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); name of the car refers to car_name\n【Question】\nWhat is the fastest car made by Japan?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ncountry.`country` = 'Japan'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: What is the fastest car made by Japan?\nTargets for `SELECT`: the name of the fastest car\nhints from 【Evidence】: the fastest refers to max(horsepower); name of the car refers to car_name\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: car refers to data.`car_name`, the fastest refers to MAX(data.`horsepower`), Japan refers to country.`country`\nConnection of tables: includes tables <data> and <country>, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`car_name` \n  FROM data AS T1 \n  INNER JOIN production AS T2 \n  ON T1.`ID` = T2.`ID` \n  INNER JOIN country AS T3 \n  ON T3.`origin` = T2.`country` \n  WHERE T3.`country` = 'Japan' \n  ORDER BY T1.`horsepower` DESC LIMIT 1\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`chronname`: The column 'chronname' in Table <institution_details> has column descriptions of \"Institution name\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \n【Evidence】\nnumber of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the chronname of institutions with number of students greater than the 90% of average number of students of all institutions?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: List the chroname of institutions with number of students greater than the 90% of average number of students of all institutions?\nTargets for `SELECT`: the chroname of institutions\nhints from 【Evidence】: number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the chronname of institutions refers to institution_details.`chronname`, number of students refers to institution_details.`student_count`\nConnection of tables: include only one table <institution_details>, no connection\nFinal SQL:\n```sql\nSELECT DISTINCT `chroname`\n  FROM institution_details\n  WHERE `student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details\n  ) \n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Question】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 30, "cur_total_response_tokens": 30}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Query】\n-- How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 40, "cur_total_response_tokens": 40}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Query】\n-- How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 50, "cur_total_response_tokens": 50}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Soft_Schema_Linker", "response": "\n你好\n", "input_prompt": "As an experienced and professional database administrator, your task is to analyze a user question and a database schema to provide relevant information. The database schema consists of table descriptions, each containing multiple column descriptions. Your goal is to extract the entities from question and identify the relevant tables and columns based on these entities and the evidence provided.\n\n[Instruction]:\n1. Extract the mentioned entities from the user question. Make sure all of the entities are extracted. \n2. For each entity, keep at least 3 related columns.\n4. Your output should include entity extraction, analysis and related database schema.\n5. The related database schema should be in JSON format.\n6. Each column's information in provided 【Schema】 is in this format: (column, description. Value examples<optional>)\n\n[Requirements]:\n1. Sort the related columns in each list corresponding to each entity in descending order of relevance.\n2. The chosen columns should be in this format: <table.column>.\n3. Make sure each chosen list is not empty. The value [] will be punished. \n4.【Matched values】 may contain redundant or useless information in addition to the correct matching values, so you need to select the useful information in conjunction with the specific column names and descriptions.\n5. An entity may not have a corresponding evidence, which requires you to find the relevant columns yourself through your understanding of the database schema.\n\nHere is a typical example:\n\n==========\n【DB_ID】 banking_system\n【Schema】\n# Table: account\n[\n  (account_id <INTEGER>, the id of the account. Value examples: [11382, 11362, 2, 1, 2367].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (frequency <TEXT>, frequency of the acount. Value examples: ['POPLATEK MESICNE', 'POPLATEK TYDNE', 'POPLATEK PO OBRATU'].),\n  (date <DATE>, the creation date of the account. Value examples: ['1997-12-29', '1997-12-28'].)\n]\n# Table: client\n[\n  (client_id <INTEGER>, the unique number. Value examples: [13998, 13971, 2, 1, 2839].),\n  (gender <TEXT>, gender. Value examples: ['M', 'F']. And F：female . M：male ),\n  (birth_date <DATE>, birth date. Value examples: ['1987-09-27', '1986-08-13'].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (first_name <TEXT>, first_name.),\n  (last_name <TEXT>, last_name.)\n]\n# Table: loan\n[\n  (loan_id <INTEGER>, the id number identifying the loan data. Value examples: [4959, 4960, 4961].),\n  (account_id <INTEGER>, the id number identifying the account. Value examples: [10, 80, 55, 43].),\n  (date <DATE>, the date when the loan is approved. Value examples: ['1998-07-12', '1998-04-19'].),\n  (amount <INTEGER>, the id number identifying the loan data. Value examples: [1567, 7877, 9988].),\n  (duration <INTEGER>, the id number identifying the loan data. Value examples: [60, 48, 24, 12, 36].),\n  (payments <INTEGER>, the id number identifying the loan data. Value examples: [3456, 8972, 9845].),\n  (status <TEXT>, the id number identifying the loan data. Value examples: ['C', 'A', 'D', 'B'].)\n]\n# Table: district\n[\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76].),\n  (A2 <REAL>, area in square kilometers. Value examples: [50.5, 48.9].),\n  (A4 <INTEGER>, number of inhabitants. Value examples: [95907, 95616].),\n  (A5 <INTEGER>, number of households. Value examples: [35678, 34892].),\n  (A6 <REAL>, literacy rate. Value examples: [95.6, 92.3, 89.7].),\n  (A7 <INTEGER>, number of entrepreneurs. Value examples: [1234, 1456].),\n  (A8 <INTEGERt>, number of cities. Value examples: [5, 4].),\n  (A9 <INTEGER>, number of schools. Value examples: [15, 12, 10].),\n  (A10 <INTEGER>, number of hospitals. Value examples: [8, 6, 4].),\n  (A11 <REAL>, average salary. Value examples: [12541.5, 11277].),\n  (A12 <REAL>, poverty rate. Value examples: [12.4, 9.8].),\n  (A13 <REAL>, unemployment rate. Value examples: [8.2, 7.9].),\n  (A15 <INTEGER>, number of crimes. Value examples: [256, 189].)\n]\n【Primary keys】\naccount.`account_id` | client.`client_id` | loan.`loan_id` | district.`district_id`\n【Foreign keys】\nclient.`district_id` = district.`district_id`\n【Question】\nWhat is the gender of the youngest client who opened account in the lowest average salary branch and when did this client open the account? Please list their full name.\n【Evidence】\nLater birthdate refers to younger age; A11 refers to average salary; Full name refers to first_name, last_name\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\nThe entities extracted from the 【Question】 are: \n1. gender; \n2. youngest client; \n3. account; \n4. lowest average salary branch; \n5. when did this client open the account; \n6. full name\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. gender --no related evidence **the columns about gender are related**\n2. youngest client  --Later birthdate refers to younger age; **the columns about birth date of client and the id of client are related**\n3. account --no related evidence **the columns about account or account ids are related**\n4. lowest average salary branch  --A11 refers to average salary **the columns about average salary and branch are related**\n5. when did this client open the account --no related evidence **the columns about time or date of the account are related**\n6. full name  --Full name refers to first_name, last_name **the columns about first_name, last_name of the client are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"gender\": [\"client.gender\",\"client.client_id\",\"loan.status\"],\n  \"youngest client\": [\"client.birth_date\",\"client.client_id\",\"account.date\",\"loan.date\"],\n  \"account\": [\"account.account_id\",\"loan.account_id\",\"account.date\"],\n  \"lowest average salary branch\": [\"district.A11\",\"district.district_id\",\"district.A13\"],\n  \"when did this client open the account\": [\"account.date\",\"loan.date\",\"client.birth_date\"],\n  \"full name\": [\"client.first_name\",\"client.last_name\",\"client.client_id\"]\n}\n```\nQuestion Solved.\n\n==========\n\nHere is a new example, please start answering:\n\n【DB_ID】 california_schools\n【Schema】\n# Table: frpm\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (Academic Year <TEXT>,  Academic Year. Value examples: ['2014-2015'].),\n  (County Code <TEXT>,  County Code. Value examples: ['19', '37', '30', '36', '33', '43'].),\n  (District Code <INTEGER>,  District Code.),\n  (School Code <TEXT>,  School Code. Value examples: ['0000000', '9010745', '6121081', '6121073', '6121016', '6120968'].),\n  (County Name <TEXT>,  County Name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].),\n  (District Name <TEXT>,  District Name.),\n  (School Name <TEXT>,  School Name.),\n  (District Type <TEXT>,  District Type. Value examples: ['Unified School District', 'Elementary School District', 'High School District', 'County Office of Education (COE)', 'State Board of Education', 'Statewide Benefit Charter'].),\n  (School Type <TEXT>,  School Type. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].),\n  (Educational Option Type <TEXT>,  Educational Option Type. Value examples: [None, 'Traditional', 'Continuation School', 'Alternative School of Choice', 'Community Day School', 'Special Education School', 'County Community School'].),\n  (NSLP Provision Status <TEXT>,  NSLP Provision Status. Value examples: [None, 'Provision 2', 'Breakfast Provision 2', 'CEP', 'Multiple Provision Types', 'Provision 1', 'Lunch Provision 2'].),\n  (Charter School (Y/N) <INTEGER>,  Charter School (Y/N). Value examples: [None, 0, 1].),\n  (Charter School Number <TEXT>,  Charter School Number. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1700', '1696'].),\n  (Charter Funding Type <TEXT>,  Charter Funding Type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (IRC <INTEGER>,  IRC. Value examples: [None, 0, 1].),\n  (Low Grade <TEXT>,  Low Grade. Value examples: ['K', '9', '6', '7', 'P', '5'].),\n  (High Grade <TEXT>,  High Grade. Value examples: ['12', '5', '8', '6', '3', '4'].),\n  (Enrollment (K-12) <REAL>,  Enrollment (K-12).),\n  (Free Meal Count (K-12) <REAL>,  Free Meal Count (K-12).),\n  (Percent (%) Eligible Free (K-12) <REAL>,  Percent (%) Eligible Free (K-12).),\n  (FRPM Count (K-12) <REAL>,  Free or Reduced Price Meal Count (K-12).),\n  (Percent (%) Eligible FRPM (K-12) <REAL>,  Percent (%) Eligible FRPM (K-12).),\n  (Enrollment (Ages 5-17) <REAL>,  Enrollment (Ages 5-17).),\n  (Free Meal Count (Ages 5-17) <REAL>,  Free Meal Count (Ages 5-17).),\n  (Percent (%) Eligible Free (Ages 5-17) <REAL>,  Percent (%) Eligible Free (Ages 5-17).),\n  (FRPM Count (Ages 5-17) <REAL>,  FRPM Count (Ages 5-17).),\n  (Percent (%) Eligible FRPM (Ages 5-17) <REAL>,  Percent (%) Eligible FRPM (Ages 5-17).),\n  (2013-14 CALPADS Fall 1 Certification Status <INTEGER>,  2013-14 CALPADS Fall 1 Certification Status. Value examples: [1].)\n]\n# Table: satscores\n[\n  (cds <TEXT>,  California Department Schools.),\n  (rtype <TEXT>,  rtype. Value examples: ['S', 'D'].),\n  (sname <TEXT>,  school name. Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].),\n  (dname <TEXT>,  district segment. Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].),\n  (cname <TEXT>,  county name. Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].),\n  (enroll12 <INTEGER>,  enrollment (1st-12nd grade).),\n  (NumTstTakr <INTEGER>,  Number of Test Takers in this school.),\n  (AvgScrRead <INTEGER>,  average scores in Reading.),\n  (AvgScrMath <INTEGER>,  average scores in Math.),\n  (AvgScrWrite <INTEGER>,  average scores in writing.),\n  (NumGE1500 <INTEGER>,  Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500.)\n]\n# Table: schools\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (NCESDist <TEXT>,  This field represents the 7-digit National Center for Educational Statistics (NCES) school district identification number. The first 2 digits identify the state and the last 5 digits identify the school district. Combined, they make a unique 7-digit ID for each school district.. Value examples: [None, '0622710', '0634320', '0628050', '0634410', '0614550', '0633840'].),\n  (NCESSchool <TEXT>,  This field represents the 5-digit NCES school identification number. The NCESSchool combined with the NCESDist form a unique 12-digit ID for each school.. Value examples: [None, '12271', '13785', '13747', '12909', '12311', '12003'].),\n  (StatusType <TEXT>,  This field identifies the status of the district.. Value examples: ['Active', 'Closed', 'Merged', 'Pending'].),\n  (County <TEXT>,  County name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].),\n  (District <TEXT>,  District.),\n  (School <TEXT>,  School.),\n  (Street <TEXT>,  Street.),\n  (StreetAbr <TEXT>,  The abbreviated street address of the school, district, or administrative authority’s physical location..),\n  (City <TEXT>,  City. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].),\n  (Zip <TEXT>,  Zip. Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].),\n  (State <TEXT>,  State. Value examples: [None, 'CA'].),\n  (MailStreet <TEXT>,  MailStreet.),\n  (MailStrAbr <TEXT>,  mailing street address.),\n  (MailCity <TEXT>,  mailing city. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].),\n  (MailZip <TEXT>,  mailing zip. Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].),\n  (MailState <TEXT>,  mailing state. Value examples: [None, 'CA'].),\n  (Phone <TEXT>,  Phone. Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].),\n  (Ext <TEXT>,  The phone number extension of the school, district, or administrative authority.. Value examples: [None, '200', '201', '111', '352', '221', '203'].),\n  (Website <TEXT>,  The website address of the school, district, or administrative authority..),\n  (OpenDate <DATE>,  The date the school opened.. Value examples: [None, '1980-07-01'].),\n  (ClosedDate <DATE>,  The date the school closed.. Value examples: [None, '1989-06-30'].),\n  (Charter <INTEGER>,  This field identifies a charter school.. Value examples: [None, 0, 1].),\n  (CharterNum <TEXT>,  The charter school number,. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1826', '1710'].),\n  (FundingType <TEXT>,  Indicates the charter school funding type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (DOC <TEXT>,  District Ownership Code. Value examples: ['54', '52', '00', '56', '98', '02'].),\n  (DOCType <TEXT>,  The District Ownership Code Type is the text description of the DOC category.. Value examples: ['Unified School District', 'Elementary School District', 'County Office of Education (COE)', 'High School District', 'Regional Occupation Center/Program (ROC/P)', 'State Board of Education'].),\n  (SOC <TEXT>,  The School Ownership Code is a numeric code used to identify the type of school.. Value examples: [None, '60', '66', '62', '68', '09', '69'].),\n  (SOCType <TEXT>,  The School Ownership Code Type is the text description of the type of school.. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Special Education Schools (Public)', 'District Community Day Schools'].),\n  (EdOpsCode <TEXT>,  The Education Option Code is a short text description of the type of education offered.. Value examples: [None, 'TRAD', 'CON', 'COMMDAY', 'ALTSOC', 'SPEC', 'COMM'].),\n  (EdOpsName <TEXT>,  Educational Option Name. Value examples: [None, 'Traditional', 'Continuation School', 'Community Day School', 'Alternative School of Choice', 'Special Education School', 'County Community School'].),\n  (EILCode <TEXT>,  The Educational Instruction Level Code is a short text description of the institution's type relative to the grade range served.. Value examples: [None, 'ELEM', 'HS', 'UG', 'INTMIDJR', 'ELEMHIGH', 'A'].),\n  (EILName <TEXT>,  The Educational Instruction Level Name is the long text description of the institution’s type relative to the grade range served.. Value examples: [None, 'Elementary', 'High School', 'Ungraded', 'Intermediate/Middle/Junior High', 'Elementary-High Combination', 'Adult'].),\n  (GSoffered <TEXT>,  The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.. Value examples: [None, 'K-5', '9-12', 'K-6', 'K-8', '6-8', 'K-12'].),\n  (GSserved <TEXT>,  It is the lowest grade and the highest grade of student enrollment as reported in the most recent certified CALPADS Fall 1 data collection. Only K–12 enrollment is reported through CALPADS. This field may differ from the grade span offered.. Value examples: [None, 'K-5', 'K-6', '9-12', 'K-8', '6-8', '7-8'].),\n  (Virtual <TEXT>,  This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.. Value examples: [None, 'N', 'P', 'F'].),\n  (Magnet <INTEGER>,  This field identifies whether a school is a magnet school and/or provides a magnet program.. Value examples: [None, 0, 1].),\n  (Latitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the equator measured north to south..),\n  (Longitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the prime meridian (Greenwich, England) measured from west to east..),\n  (AdmFName1 <TEXT>,  administrator's first name 1. Value examples: [None, 'David', 'Michael', 'John', 'Jennifer', 'Lisa', 'Robert'].),\n  (AdmLName1 <TEXT>,  administrator's last name 1.),\n  (AdmEmail1 <TEXT>,  administrator's email address 1.),\n  (AdmFName2 <TEXT>,  administrator's first name 2. Value examples: [None, 'Steve', 'Delphine', 'Tim', 'Michael', 'Lisa', 'Jeff'].),\n  (AdmLName2 <TEXT>,  administrator's last name 2. Value examples: [None, 'Sherman', 'Jones', 'Wilson', 'Petersen', 'Landry', 'Hambright'].),\n  (AdmEmail2 <TEXT>,  administrator's email address 2.),\n  (AdmFName3 <TEXT>,  administrator's first name 3. Value examples: [None, 'Mark', 'Eric', 'Vickie', 'Tracie', 'Shawn', 'Sarah'].),\n  (AdmLName3 <TEXT>,  administrator's last name 3. Value examples: [None, 'Zerpoli', 'Yount', 'Woodruff', 'Wood', 'Wolk', 'Spotts'].),\n  (AdmEmail3 <TEXT>,  administrator's email address 3.),\n  (LastUpdate <DATE>,  Last Update. Value examples: ['2015-06-18'].)\n]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Question】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 10, "cur_total_response_tokens": 10}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Decomposer", "response": "\n你好\n", "input_prompt": "[Instruction]\nGiven a 【query】, you need to understanding the intent of Query, and then deceompose it into Targets and Conditions. Then you need to combine Targets and Conditions into Subquerys step by step. \nFor the case where Conditions is NULL, consider Targets as the final Subquery directly. \nFor the case where Conditions are not NULL, combine Targets and the first Condition to get the first Subquery, then combine this Subquery and the next Condition into a new Subquery until all Conditions are used (which means the content of the last Subquery and the original Query is the same).\n\n[Requirements]\n-Try not to overlap Targets and Conditions.\n-Make sure the decomposed Target and Condition can cover all of the information in Query.\n-Don't change any information (specific value) in Query!\n-Mark each Subquery with ## in front of it.\n\nHere are some examples:\n==========\n\n【Query】\nShow the stadium name and the number of concerts in each stadium. Please also list the year the stadium was built. \n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the stadium name, the year the stadium built and the number of concerts in each stadium\nConditions: NULL\n\nSubqueries:\n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the stadium name, the year the stadium built and the number of concerts in each stadium\n==========\n\n【Query】\nWhat is the qualification rate for the H-11 products produced in 2023/11/2?\n【Evidence】\nqualification rate = `Numqualified(H-11)` / `production(H-11)`\n\n【Decomposition】\nTargets: List the qualification rate for the H-11 Products\nConditions:\n1. produced in 2023/11/2 --Condition_1\n\nSubqueries:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the qualification rate for the H-11 Products produced in 2023/11/2\n\n==========\n\n【Query】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n\n【Decomposition】\nTargets: List the race of institutions\nConditions: \n1. in Alabama --Condition_1\n2. number of students greater than the 90% of average number of students of all institutions --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the race of institution in Alabama\n2. Conbine the first Subquery and Conditon_2 to get the seconed Subquery.\n##Subquery: List the race of institutions in Alabama with number of number of students greater than the 90% of average number of students of all institutions\n\n==========\n\n【Query】\nWhich president got a higher approval rating, Joseph Biden or Donald Trump?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\nConditions: \nNULL\n\nSubqueries: \n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\n\n==========\n\n【Query】\nFor movie id 1269, how many users, who was a paying subscriber and was eligible for trial when he rated the movie, gave the movie a rating score of less than or equal to 2?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the number of users\nConditions:\n1. was a paying subscriber --Condition_1\n2. was eligible for trial --Condition_2\n3. for movie id 1269, gave the movie a rating score of less than or equal to 2 --Condition3\n\nSubquerys:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the number of users who was a paying subscriber\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial\n3. Combine the second Subquery and Condition_3 to get the third Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial and gave the movie whose id is 1269 a rating score of less than or equal to 2\n\n==========\n\nHere is a new query need to be decomposed:\n\n【Query】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n\n【Decomposition】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 20, "cur_total_response_tokens": 20}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Generator", "response": "\n你好\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】and a 【Question】, you need to use valid SQLite and understand the database and knowledge so that you can generate a good SQL for the 【Question】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# stadium: [Stadium_ID (INTEGER), Location (TEXT), Name (TEXT)]\n# concert: [concert_ID (INTEGER), concert_Name (TEXT), Stadium_ID (INTEGER)]\n【Primary keys】\nstadium.`Stadium_ID` | concert.`concert_ID`\n【Foreign keys】\nconcert.`Stadium_ID` = stadium.`Stadium_ID`\n【Detailed descriptions of tables and columns】\nstadium.`Stadium_ID`: The column 'Stadium_ID' in Table <stadium> has column descriptions of \"stadium id\". Value examples: [1, 2, 3, 4, 5, 6].\nstadium.`Name`:  The column 'Name' in Table <stadium> has column descriptions of \"name of stadium\". Value examples: [\"Stark's Park\", 'Somerset Park', 'Recreation Park', 'Hampden Park', 'Glebe Park', 'Gayfield Park'].\nstadium.`Location`: The column 'Location' in Table <stadium> has column descriptions of \"location of stadium\". Value examples: ['Stirling Albion', 'Raith Rovers', \"Queen's Park\", 'Peterhead', 'East Fife', 'Brechin City'].\nconcert.`concert_ID`: The column 'concert_ID' in Table <concert> has column descriptions of \"concert id\". Value examples: [1, 2, 3, 4, 5, 6].\nconcert.`concert_Name`: The column 'concert_Name' in Table <concert> has column descriptions of \"concert name\". Value examples: ['Week 1', 'Week 2', 'Super bootcamp', 'Home Visits', 'Auditions'].\nconcert.`Stadium_ID`: The column 'Stadium_ID' in Table <concert> has column descriptions of \"stadium id\". Value examples: [2, 9, 7, 10, 1].\n【Evidence】\nNULL\n【Question】\nShow the stadium name and the number of concerts in each stadium.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: Show the stadium name and the number of concerts in each stadium.\nTargets for `SELECT`: the stadium name and the number of concerts\nhints from 【Evidence】:NULL\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the stadium name refers to stadium.`Name`, the number of concerts refers to COUNT(concert.`concert_ID`), each stadium refers to stadium.`Stadium_ID`\nConnection of tables: include tables <stadium> and <concert>, get connected keys from 【Foreign keys】: concert.`Stadium_ID` = stadium.`Stadium_ID`\nFinal SQL:\n```sql\nSELECT T1.`Name`, COUNT(T2.concert_ID) AS num_concerts\n  FROM stadium AS T1\n  JOIN concert AS T2\n  ON T1.`Stadium_ID` = T2.`Stadium_ID`\n  GROUP BY T1.`Stadium_ID`\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); name of the car refers to car_name\n【Question】\nWhat is the fastest car made by Japan?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ncountry.`country` = 'Japan'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: What is the fastest car made by Japan?\nTargets for `SELECT`: the name of the fastest car\nhints from 【Evidence】: the fastest refers to max(horsepower); name of the car refers to car_name\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: car refers to data.`car_name`, the fastest refers to MAX(data.`horsepower`), Japan refers to country.`country`\nConnection of tables: includes tables <data> and <country>, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`car_name` \n  FROM data AS T1 \n  INNER JOIN production AS T2 \n  ON T1.`ID` = T2.`ID` \n  INNER JOIN country AS T3 \n  ON T3.`origin` = T2.`country` \n  WHERE T3.`country` = 'Japan' \n  ORDER BY T1.`horsepower` DESC LIMIT 1\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`chronname`: The column 'chronname' in Table <institution_details> has column descriptions of \"Institution name\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \n【Evidence】\nnumber of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the chronname of institutions with number of students greater than the 90% of average number of students of all institutions?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: List the chroname of institutions with number of students greater than the 90% of average number of students of all institutions?\nTargets for `SELECT`: the chroname of institutions\nhints from 【Evidence】: number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the chronname of institutions refers to institution_details.`chronname`, number of students refers to institution_details.`student_count`\nConnection of tables: include only one table <institution_details>, no connection\nFinal SQL:\n```sql\nSELECT DISTINCT `chroname`\n  FROM institution_details\n  WHERE `student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details\n  ) \n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Question】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 30, "cur_total_response_tokens": 30}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Query】\n-- How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 40, "cur_total_response_tokens": 40}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Query】\n-- How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 50, "cur_total_response_tokens": 50}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Soft_Schema_Linker", "response": "\n你好\n", "input_prompt": "As an experienced and professional database administrator, your task is to analyze a user question and a database schema to provide relevant information. The database schema consists of table descriptions, each containing multiple column descriptions. Your goal is to extract the entities from question and identify the relevant tables and columns based on these entities and the evidence provided.\n\n[Instruction]:\n1. Extract the mentioned entities from the user question. Make sure all of the entities are extracted. \n2. For each entity, keep at least 3 related columns.\n4. Your output should include entity extraction, analysis and related database schema.\n5. The related database schema should be in JSON format.\n6. Each column's information in provided 【Schema】 is in this format: (column, description. Value examples<optional>)\n\n[Requirements]:\n1. Sort the related columns in each list corresponding to each entity in descending order of relevance.\n2. The chosen columns should be in this format: <table.column>.\n3. Make sure each chosen list is not empty. The value [] will be punished. \n4.【Matched values】 may contain redundant or useless information in addition to the correct matching values, so you need to select the useful information in conjunction with the specific column names and descriptions.\n5. An entity may not have a corresponding evidence, which requires you to find the relevant columns yourself through your understanding of the database schema.\n\nHere is a typical example:\n\n==========\n【DB_ID】 banking_system\n【Schema】\n# Table: account\n[\n  (account_id <INTEGER>, the id of the account. Value examples: [11382, 11362, 2, 1, 2367].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (frequency <TEXT>, frequency of the acount. Value examples: ['POPLATEK MESICNE', 'POPLATEK TYDNE', 'POPLATEK PO OBRATU'].),\n  (date <DATE>, the creation date of the account. Value examples: ['1997-12-29', '1997-12-28'].)\n]\n# Table: client\n[\n  (client_id <INTEGER>, the unique number. Value examples: [13998, 13971, 2, 1, 2839].),\n  (gender <TEXT>, gender. Value examples: ['M', 'F']. And F：female . M：male ),\n  (birth_date <DATE>, birth date. Value examples: ['1987-09-27', '1986-08-13'].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (first_name <TEXT>, first_name.),\n  (last_name <TEXT>, last_name.)\n]\n# Table: loan\n[\n  (loan_id <INTEGER>, the id number identifying the loan data. Value examples: [4959, 4960, 4961].),\n  (account_id <INTEGER>, the id number identifying the account. Value examples: [10, 80, 55, 43].),\n  (date <DATE>, the date when the loan is approved. Value examples: ['1998-07-12', '1998-04-19'].),\n  (amount <INTEGER>, the id number identifying the loan data. Value examples: [1567, 7877, 9988].),\n  (duration <INTEGER>, the id number identifying the loan data. Value examples: [60, 48, 24, 12, 36].),\n  (payments <INTEGER>, the id number identifying the loan data. Value examples: [3456, 8972, 9845].),\n  (status <TEXT>, the id number identifying the loan data. Value examples: ['C', 'A', 'D', 'B'].)\n]\n# Table: district\n[\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76].),\n  (A2 <REAL>, area in square kilometers. Value examples: [50.5, 48.9].),\n  (A4 <INTEGER>, number of inhabitants. Value examples: [95907, 95616].),\n  (A5 <INTEGER>, number of households. Value examples: [35678, 34892].),\n  (A6 <REAL>, literacy rate. Value examples: [95.6, 92.3, 89.7].),\n  (A7 <INTEGER>, number of entrepreneurs. Value examples: [1234, 1456].),\n  (A8 <INTEGERt>, number of cities. Value examples: [5, 4].),\n  (A9 <INTEGER>, number of schools. Value examples: [15, 12, 10].),\n  (A10 <INTEGER>, number of hospitals. Value examples: [8, 6, 4].),\n  (A11 <REAL>, average salary. Value examples: [12541.5, 11277].),\n  (A12 <REAL>, poverty rate. Value examples: [12.4, 9.8].),\n  (A13 <REAL>, unemployment rate. Value examples: [8.2, 7.9].),\n  (A15 <INTEGER>, number of crimes. Value examples: [256, 189].)\n]\n【Primary keys】\naccount.`account_id` | client.`client_id` | loan.`loan_id` | district.`district_id`\n【Foreign keys】\nclient.`district_id` = district.`district_id`\n【Question】\nWhat is the gender of the youngest client who opened account in the lowest average salary branch and when did this client open the account? Please list their full name.\n【Evidence】\nLater birthdate refers to younger age; A11 refers to average salary; Full name refers to first_name, last_name\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\nThe entities extracted from the 【Question】 are: \n1. gender; \n2. youngest client; \n3. account; \n4. lowest average salary branch; \n5. when did this client open the account; \n6. full name\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. gender --no related evidence **the columns about gender are related**\n2. youngest client  --Later birthdate refers to younger age; **the columns about birth date of client and the id of client are related**\n3. account --no related evidence **the columns about account or account ids are related**\n4. lowest average salary branch  --A11 refers to average salary **the columns about average salary and branch are related**\n5. when did this client open the account --no related evidence **the columns about time or date of the account are related**\n6. full name  --Full name refers to first_name, last_name **the columns about first_name, last_name of the client are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"gender\": [\"client.gender\",\"client.client_id\",\"loan.status\"],\n  \"youngest client\": [\"client.birth_date\",\"client.client_id\",\"account.date\",\"loan.date\"],\n  \"account\": [\"account.account_id\",\"loan.account_id\",\"account.date\"],\n  \"lowest average salary branch\": [\"district.A11\",\"district.district_id\",\"district.A13\"],\n  \"when did this client open the account\": [\"account.date\",\"loan.date\",\"client.birth_date\"],\n  \"full name\": [\"client.first_name\",\"client.last_name\",\"client.client_id\"]\n}\n```\nQuestion Solved.\n\n==========\n\nHere is a new example, please start answering:\n\n【DB_ID】 california_schools\n【Schema】\n# Table: frpm\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (Academic Year <TEXT>,  Academic Year. Value examples: ['2014-2015'].),\n  (County Code <TEXT>,  County Code. Value examples: ['19', '37', '30', '36', '33', '43'].),\n  (District Code <INTEGER>,  District Code.),\n  (School Code <TEXT>,  School Code. Value examples: ['0000000', '9010745', '6121081', '6121073', '6121016', '6120968'].),\n  (County Name <TEXT>,  County Name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].),\n  (District Name <TEXT>,  District Name.),\n  (School Name <TEXT>,  School Name.),\n  (District Type <TEXT>,  District Type. Value examples: ['Unified School District', 'Elementary School District', 'High School District', 'County Office of Education (COE)', 'State Board of Education', 'Statewide Benefit Charter'].),\n  (School Type <TEXT>,  School Type. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].),\n  (Educational Option Type <TEXT>,  Educational Option Type. Value examples: [None, 'Traditional', 'Continuation School', 'Alternative School of Choice', 'Community Day School', 'Special Education School', 'County Community School'].),\n  (NSLP Provision Status <TEXT>,  NSLP Provision Status. Value examples: [None, 'Provision 2', 'Breakfast Provision 2', 'CEP', 'Multiple Provision Types', 'Provision 1', 'Lunch Provision 2'].),\n  (Charter School (Y/N) <INTEGER>,  Charter School (Y/N). Value examples: [None, 0, 1].),\n  (Charter School Number <TEXT>,  Charter School Number. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1700', '1696'].),\n  (Charter Funding Type <TEXT>,  Charter Funding Type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (IRC <INTEGER>,  IRC. Value examples: [None, 0, 1].),\n  (Low Grade <TEXT>,  Low Grade. Value examples: ['K', '9', '6', '7', 'P', '5'].),\n  (High Grade <TEXT>,  High Grade. Value examples: ['12', '5', '8', '6', '3', '4'].),\n  (Enrollment (K-12) <REAL>,  Enrollment (K-12).),\n  (Free Meal Count (K-12) <REAL>,  Free Meal Count (K-12).),\n  (Percent (%) Eligible Free (K-12) <REAL>,  Percent (%) Eligible Free (K-12).),\n  (FRPM Count (K-12) <REAL>,  Free or Reduced Price Meal Count (K-12).),\n  (Percent (%) Eligible FRPM (K-12) <REAL>,  Percent (%) Eligible FRPM (K-12).),\n  (Enrollment (Ages 5-17) <REAL>,  Enrollment (Ages 5-17).),\n  (Free Meal Count (Ages 5-17) <REAL>,  Free Meal Count (Ages 5-17).),\n  (Percent (%) Eligible Free (Ages 5-17) <REAL>,  Percent (%) Eligible Free (Ages 5-17).),\n  (FRPM Count (Ages 5-17) <REAL>,  FRPM Count (Ages 5-17).),\n  (Percent (%) Eligible FRPM (Ages 5-17) <REAL>,  Percent (%) Eligible FRPM (Ages 5-17).),\n  (2013-14 CALPADS Fall 1 Certification Status <INTEGER>,  2013-14 CALPADS Fall 1 Certification Status. Value examples: [1].)\n]\n# Table: satscores\n[\n  (cds <TEXT>,  California Department Schools.),\n  (rtype <TEXT>,  rtype. Value examples: ['S', 'D'].),\n  (sname <TEXT>,  school name. Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].),\n  (dname <TEXT>,  district segment. Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].),\n  (cname <TEXT>,  county name. Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].),\n  (enroll12 <INTEGER>,  enrollment (1st-12nd grade).),\n  (NumTstTakr <INTEGER>,  Number of Test Takers in this school.),\n  (AvgScrRead <INTEGER>,  average scores in Reading.),\n  (AvgScrMath <INTEGER>,  average scores in Math.),\n  (AvgScrWrite <INTEGER>,  average scores in writing.),\n  (NumGE1500 <INTEGER>,  Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500.)\n]\n# Table: schools\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (NCESDist <TEXT>,  This field represents the 7-digit National Center for Educational Statistics (NCES) school district identification number. The first 2 digits identify the state and the last 5 digits identify the school district. Combined, they make a unique 7-digit ID for each school district.. Value examples: [None, '0622710', '0634320', '0628050', '0634410', '0614550', '0633840'].),\n  (NCESSchool <TEXT>,  This field represents the 5-digit NCES school identification number. The NCESSchool combined with the NCESDist form a unique 12-digit ID for each school.. Value examples: [None, '12271', '13785', '13747', '12909', '12311', '12003'].),\n  (StatusType <TEXT>,  This field identifies the status of the district.. Value examples: ['Active', 'Closed', 'Merged', 'Pending'].),\n  (County <TEXT>,  County name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].),\n  (District <TEXT>,  District.),\n  (School <TEXT>,  School.),\n  (Street <TEXT>,  Street.),\n  (StreetAbr <TEXT>,  The abbreviated street address of the school, district, or administrative authority’s physical location..),\n  (City <TEXT>,  City. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].),\n  (Zip <TEXT>,  Zip. Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].),\n  (State <TEXT>,  State. Value examples: [None, 'CA'].),\n  (MailStreet <TEXT>,  MailStreet.),\n  (MailStrAbr <TEXT>,  mailing street address.),\n  (MailCity <TEXT>,  mailing city. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].),\n  (MailZip <TEXT>,  mailing zip. Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].),\n  (MailState <TEXT>,  mailing state. Value examples: [None, 'CA'].),\n  (Phone <TEXT>,  Phone. Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].),\n  (Ext <TEXT>,  The phone number extension of the school, district, or administrative authority.. Value examples: [None, '200', '201', '111', '352', '221', '203'].),\n  (Website <TEXT>,  The website address of the school, district, or administrative authority..),\n  (OpenDate <DATE>,  The date the school opened.. Value examples: [None, '1980-07-01'].),\n  (ClosedDate <DATE>,  The date the school closed.. Value examples: [None, '1989-06-30'].),\n  (Charter <INTEGER>,  This field identifies a charter school.. Value examples: [None, 0, 1].),\n  (CharterNum <TEXT>,  The charter school number,. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1826', '1710'].),\n  (FundingType <TEXT>,  Indicates the charter school funding type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (DOC <TEXT>,  District Ownership Code. Value examples: ['54', '52', '00', '56', '98', '02'].),\n  (DOCType <TEXT>,  The District Ownership Code Type is the text description of the DOC category.. Value examples: ['Unified School District', 'Elementary School District', 'County Office of Education (COE)', 'High School District', 'Regional Occupation Center/Program (ROC/P)', 'State Board of Education'].),\n  (SOC <TEXT>,  The School Ownership Code is a numeric code used to identify the type of school.. Value examples: [None, '60', '66', '62', '68', '09', '69'].),\n  (SOCType <TEXT>,  The School Ownership Code Type is the text description of the type of school.. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Special Education Schools (Public)', 'District Community Day Schools'].),\n  (EdOpsCode <TEXT>,  The Education Option Code is a short text description of the type of education offered.. Value examples: [None, 'TRAD', 'CON', 'COMMDAY', 'ALTSOC', 'SPEC', 'COMM'].),\n  (EdOpsName <TEXT>,  Educational Option Name. Value examples: [None, 'Traditional', 'Continuation School', 'Community Day School', 'Alternative School of Choice', 'Special Education School', 'County Community School'].),\n  (EILCode <TEXT>,  The Educational Instruction Level Code is a short text description of the institution's type relative to the grade range served.. Value examples: [None, 'ELEM', 'HS', 'UG', 'INTMIDJR', 'ELEMHIGH', 'A'].),\n  (EILName <TEXT>,  The Educational Instruction Level Name is the long text description of the institution’s type relative to the grade range served.. Value examples: [None, 'Elementary', 'High School', 'Ungraded', 'Intermediate/Middle/Junior High', 'Elementary-High Combination', 'Adult'].),\n  (GSoffered <TEXT>,  The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.. Value examples: [None, 'K-5', '9-12', 'K-6', 'K-8', '6-8', 'K-12'].),\n  (GSserved <TEXT>,  It is the lowest grade and the highest grade of student enrollment as reported in the most recent certified CALPADS Fall 1 data collection. Only K–12 enrollment is reported through CALPADS. This field may differ from the grade span offered.. Value examples: [None, 'K-5', 'K-6', '9-12', 'K-8', '6-8', '7-8'].),\n  (Virtual <TEXT>,  This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.. Value examples: [None, 'N', 'P', 'F'].),\n  (Magnet <INTEGER>,  This field identifies whether a school is a magnet school and/or provides a magnet program.. Value examples: [None, 0, 1].),\n  (Latitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the equator measured north to south..),\n  (Longitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the prime meridian (Greenwich, England) measured from west to east..),\n  (AdmFName1 <TEXT>,  administrator's first name 1. Value examples: [None, 'David', 'Michael', 'John', 'Jennifer', 'Lisa', 'Robert'].),\n  (AdmLName1 <TEXT>,  administrator's last name 1.),\n  (AdmEmail1 <TEXT>,  administrator's email address 1.),\n  (AdmFName2 <TEXT>,  administrator's first name 2. Value examples: [None, 'Steve', 'Delphine', 'Tim', 'Michael', 'Lisa', 'Jeff'].),\n  (AdmLName2 <TEXT>,  administrator's last name 2. Value examples: [None, 'Sherman', 'Jones', 'Wilson', 'Petersen', 'Landry', 'Hambright'].),\n  (AdmEmail2 <TEXT>,  administrator's email address 2.),\n  (AdmFName3 <TEXT>,  administrator's first name 3. Value examples: [None, 'Mark', 'Eric', 'Vickie', 'Tracie', 'Shawn', 'Sarah'].),\n  (AdmLName3 <TEXT>,  administrator's last name 3. Value examples: [None, 'Zerpoli', 'Yount', 'Woodruff', 'Wood', 'Wolk', 'Spotts'].),\n  (AdmEmail3 <TEXT>,  administrator's email address 3.),\n  (LastUpdate <DATE>,  Last Update. Value examples: ['2015-06-18'].)\n]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Question】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 10, "cur_total_response_tokens": 10}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Decomposer", "response": "\n你好\n", "input_prompt": "[Instruction]\nGiven a 【query】, you need to understanding the intent of Query, and then deceompose it into Targets and Conditions. Then you need to combine Targets and Conditions into Subquerys step by step. \nFor the case where Conditions is NULL, consider Targets as the final Subquery directly. \nFor the case where Conditions are not NULL, combine Targets and the first Condition to get the first Subquery, then combine this Subquery and the next Condition into a new Subquery until all Conditions are used (which means the content of the last Subquery and the original Query is the same).\n\n[Requirements]\n-Try not to overlap Targets and Conditions.\n-Make sure the decomposed Target and Condition can cover all of the information in Query.\n-Don't change any information (specific value) in Query!\n-Mark each Subquery with ## in front of it.\n\nHere are some examples:\n==========\n\n【Query】\nShow the stadium name and the number of concerts in each stadium. Please also list the year the stadium was built. \n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the stadium name, the year the stadium built and the number of concerts in each stadium\nConditions: NULL\n\nSubqueries:\n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the stadium name, the year the stadium built and the number of concerts in each stadium\n==========\n\n【Query】\nWhat is the qualification rate for the H-11 products produced in 2023/11/2?\n【Evidence】\nqualification rate = `Numqualified(H-11)` / `production(H-11)`\n\n【Decomposition】\nTargets: List the qualification rate for the H-11 Products\nConditions:\n1. produced in 2023/11/2 --Condition_1\n\nSubqueries:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the qualification rate for the H-11 Products produced in 2023/11/2\n\n==========\n\n【Query】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n\n【Decomposition】\nTargets: List the race of institutions\nConditions: \n1. in Alabama --Condition_1\n2. number of students greater than the 90% of average number of students of all institutions --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the race of institution in Alabama\n2. Conbine the first Subquery and Conditon_2 to get the seconed Subquery.\n##Subquery: List the race of institutions in Alabama with number of number of students greater than the 90% of average number of students of all institutions\n\n==========\n\n【Query】\nWhich president got a higher approval rating, Joseph Biden or Donald Trump?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\nConditions: \nNULL\n\nSubqueries: \n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\n\n==========\n\n【Query】\nFor movie id 1269, how many users, who was a paying subscriber and was eligible for trial when he rated the movie, gave the movie a rating score of less than or equal to 2?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the number of users\nConditions:\n1. was a paying subscriber --Condition_1\n2. was eligible for trial --Condition_2\n3. for movie id 1269, gave the movie a rating score of less than or equal to 2 --Condition3\n\nSubquerys:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the number of users who was a paying subscriber\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial\n3. Combine the second Subquery and Condition_3 to get the third Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial and gave the movie whose id is 1269 a rating score of less than or equal to 2\n\n==========\n\nHere is a new query need to be decomposed:\n\n【Query】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n\n【Decomposition】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 20, "cur_total_response_tokens": 20}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Generator", "response": "\n你好\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】and a 【Question】, you need to use valid SQLite and understand the database and knowledge so that you can generate a good SQL for the 【Question】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# stadium: [Stadium_ID (INTEGER), Location (TEXT), Name (TEXT)]\n# concert: [concert_ID (INTEGER), concert_Name (TEXT), Stadium_ID (INTEGER)]\n【Primary keys】\nstadium.`Stadium_ID` | concert.`concert_ID`\n【Foreign keys】\nconcert.`Stadium_ID` = stadium.`Stadium_ID`\n【Detailed descriptions of tables and columns】\nstadium.`Stadium_ID`: The column 'Stadium_ID' in Table <stadium> has column descriptions of \"stadium id\". Value examples: [1, 2, 3, 4, 5, 6].\nstadium.`Name`:  The column 'Name' in Table <stadium> has column descriptions of \"name of stadium\". Value examples: [\"Stark's Park\", 'Somerset Park', 'Recreation Park', 'Hampden Park', 'Glebe Park', 'Gayfield Park'].\nstadium.`Location`: The column 'Location' in Table <stadium> has column descriptions of \"location of stadium\". Value examples: ['Stirling Albion', 'Raith Rovers', \"Queen's Park\", 'Peterhead', 'East Fife', 'Brechin City'].\nconcert.`concert_ID`: The column 'concert_ID' in Table <concert> has column descriptions of \"concert id\". Value examples: [1, 2, 3, 4, 5, 6].\nconcert.`concert_Name`: The column 'concert_Name' in Table <concert> has column descriptions of \"concert name\". Value examples: ['Week 1', 'Week 2', 'Super bootcamp', 'Home Visits', 'Auditions'].\nconcert.`Stadium_ID`: The column 'Stadium_ID' in Table <concert> has column descriptions of \"stadium id\". Value examples: [2, 9, 7, 10, 1].\n【Evidence】\nNULL\n【Question】\nShow the stadium name and the number of concerts in each stadium.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: Show the stadium name and the number of concerts in each stadium.\nTargets for `SELECT`: the stadium name and the number of concerts\nhints from 【Evidence】:NULL\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the stadium name refers to stadium.`Name`, the number of concerts refers to COUNT(concert.`concert_ID`), each stadium refers to stadium.`Stadium_ID`\nConnection of tables: include tables <stadium> and <concert>, get connected keys from 【Foreign keys】: concert.`Stadium_ID` = stadium.`Stadium_ID`\nFinal SQL:\n```sql\nSELECT T1.`Name`, COUNT(T2.concert_ID) AS num_concerts\n  FROM stadium AS T1\n  JOIN concert AS T2\n  ON T1.`Stadium_ID` = T2.`Stadium_ID`\n  GROUP BY T1.`Stadium_ID`\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); name of the car refers to car_name\n【Question】\nWhat is the fastest car made by Japan?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ncountry.`country` = 'Japan'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: What is the fastest car made by Japan?\nTargets for `SELECT`: the name of the fastest car\nhints from 【Evidence】: the fastest refers to max(horsepower); name of the car refers to car_name\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: car refers to data.`car_name`, the fastest refers to MAX(data.`horsepower`), Japan refers to country.`country`\nConnection of tables: includes tables <data> and <country>, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`car_name` \n  FROM data AS T1 \n  INNER JOIN production AS T2 \n  ON T1.`ID` = T2.`ID` \n  INNER JOIN country AS T3 \n  ON T3.`origin` = T2.`country` \n  WHERE T3.`country` = 'Japan' \n  ORDER BY T1.`horsepower` DESC LIMIT 1\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`chronname`: The column 'chronname' in Table <institution_details> has column descriptions of \"Institution name\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \n【Evidence】\nnumber of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the chronname of institutions with number of students greater than the 90% of average number of students of all institutions?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: List the chroname of institutions with number of students greater than the 90% of average number of students of all institutions?\nTargets for `SELECT`: the chroname of institutions\nhints from 【Evidence】: number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the chronname of institutions refers to institution_details.`chronname`, number of students refers to institution_details.`student_count`\nConnection of tables: include only one table <institution_details>, no connection\nFinal SQL:\n```sql\nSELECT DISTINCT `chroname`\n  FROM institution_details\n  WHERE `student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details\n  ) \n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Question】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 30, "cur_total_response_tokens": 30}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Query】\n-- How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 40, "cur_total_response_tokens": 40}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Query】\n-- How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 50, "cur_total_response_tokens": 50}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Soft_Schema_Linker", "response": "\n你好\n", "input_prompt": "As an experienced and professional database administrator, your task is to analyze a user question and a database schema to provide relevant information. The database schema consists of table descriptions, each containing multiple column descriptions. Your goal is to extract the entities from question and identify the relevant tables and columns based on these entities and the evidence provided.\n\n[Instruction]:\n1. Extract the mentioned entities from the user question. Make sure all of the entities are extracted. \n2. For each entity, keep at least 3 related columns.\n4. Your output should include entity extraction, analysis and related database schema.\n5. The related database schema should be in JSON format.\n6. Each column's information in provided 【Schema】 is in this format: (column, description. Value examples<optional>)\n\n[Requirements]:\n1. Sort the related columns in each list corresponding to each entity in descending order of relevance.\n2. The chosen columns should be in this format: <table.column>.\n3. Make sure each chosen list is not empty. The value [] will be punished. \n4.【Matched values】 may contain redundant or useless information in addition to the correct matching values, so you need to select the useful information in conjunction with the specific column names and descriptions.\n5. An entity may not have a corresponding evidence, which requires you to find the relevant columns yourself through your understanding of the database schema.\n\nHere is a typical example:\n\n==========\n【DB_ID】 banking_system\n【Schema】\n# Table: account\n[\n  (account_id <INTEGER>, the id of the account. Value examples: [11382, 11362, 2, 1, 2367].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (frequency <TEXT>, frequency of the acount. Value examples: ['POPLATEK MESICNE', 'POPLATEK TYDNE', 'POPLATEK PO OBRATU'].),\n  (date <DATE>, the creation date of the account. Value examples: ['1997-12-29', '1997-12-28'].)\n]\n# Table: client\n[\n  (client_id <INTEGER>, the unique number. Value examples: [13998, 13971, 2, 1, 2839].),\n  (gender <TEXT>, gender. Value examples: ['M', 'F']. And F：female . M：male ),\n  (birth_date <DATE>, birth date. Value examples: ['1987-09-27', '1986-08-13'].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (first_name <TEXT>, first_name.),\n  (last_name <TEXT>, last_name.)\n]\n# Table: loan\n[\n  (loan_id <INTEGER>, the id number identifying the loan data. Value examples: [4959, 4960, 4961].),\n  (account_id <INTEGER>, the id number identifying the account. Value examples: [10, 80, 55, 43].),\n  (date <DATE>, the date when the loan is approved. Value examples: ['1998-07-12', '1998-04-19'].),\n  (amount <INTEGER>, the id number identifying the loan data. Value examples: [1567, 7877, 9988].),\n  (duration <INTEGER>, the id number identifying the loan data. Value examples: [60, 48, 24, 12, 36].),\n  (payments <INTEGER>, the id number identifying the loan data. Value examples: [3456, 8972, 9845].),\n  (status <TEXT>, the id number identifying the loan data. Value examples: ['C', 'A', 'D', 'B'].)\n]\n# Table: district\n[\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76].),\n  (A2 <REAL>, area in square kilometers. Value examples: [50.5, 48.9].),\n  (A4 <INTEGER>, number of inhabitants. Value examples: [95907, 95616].),\n  (A5 <INTEGER>, number of households. Value examples: [35678, 34892].),\n  (A6 <REAL>, literacy rate. Value examples: [95.6, 92.3, 89.7].),\n  (A7 <INTEGER>, number of entrepreneurs. Value examples: [1234, 1456].),\n  (A8 <INTEGERt>, number of cities. Value examples: [5, 4].),\n  (A9 <INTEGER>, number of schools. Value examples: [15, 12, 10].),\n  (A10 <INTEGER>, number of hospitals. Value examples: [8, 6, 4].),\n  (A11 <REAL>, average salary. Value examples: [12541.5, 11277].),\n  (A12 <REAL>, poverty rate. Value examples: [12.4, 9.8].),\n  (A13 <REAL>, unemployment rate. Value examples: [8.2, 7.9].),\n  (A15 <INTEGER>, number of crimes. Value examples: [256, 189].)\n]\n【Primary keys】\naccount.`account_id` | client.`client_id` | loan.`loan_id` | district.`district_id`\n【Foreign keys】\nclient.`district_id` = district.`district_id`\n【Question】\nWhat is the gender of the youngest client who opened account in the lowest average salary branch and when did this client open the account? Please list their full name.\n【Evidence】\nLater birthdate refers to younger age; A11 refers to average salary; Full name refers to first_name, last_name\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\nThe entities extracted from the 【Question】 are: \n1. gender; \n2. youngest client; \n3. account; \n4. lowest average salary branch; \n5. when did this client open the account; \n6. full name\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. gender --no related evidence **the columns about gender are related**\n2. youngest client  --Later birthdate refers to younger age; **the columns about birth date of client and the id of client are related**\n3. account --no related evidence **the columns about account or account ids are related**\n4. lowest average salary branch  --A11 refers to average salary **the columns about average salary and branch are related**\n5. when did this client open the account --no related evidence **the columns about time or date of the account are related**\n6. full name  --Full name refers to first_name, last_name **the columns about first_name, last_name of the client are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"gender\": [\"client.gender\",\"client.client_id\",\"loan.status\"],\n  \"youngest client\": [\"client.birth_date\",\"client.client_id\",\"account.date\",\"loan.date\"],\n  \"account\": [\"account.account_id\",\"loan.account_id\",\"account.date\"],\n  \"lowest average salary branch\": [\"district.A11\",\"district.district_id\",\"district.A13\"],\n  \"when did this client open the account\": [\"account.date\",\"loan.date\",\"client.birth_date\"],\n  \"full name\": [\"client.first_name\",\"client.last_name\",\"client.client_id\"]\n}\n```\nQuestion Solved.\n\n==========\n\nHere is a new example, please start answering:\n\n【DB_ID】 california_schools\n【Schema】\n# Table: frpm\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (Academic Year <TEXT>,  Academic Year. Value examples: ['2014-2015'].),\n  (County Code <TEXT>,  County Code. Value examples: ['19', '37', '30', '36', '33', '43'].),\n  (District Code <INTEGER>,  District Code.),\n  (School Code <TEXT>,  School Code. Value examples: ['0000000', '9010745', '6121081', '6121073', '6121016', '6120968'].),\n  (County Name <TEXT>,  County Name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].),\n  (District Name <TEXT>,  District Name.),\n  (School Name <TEXT>,  School Name.),\n  (District Type <TEXT>,  District Type. Value examples: ['Unified School District', 'Elementary School District', 'High School District', 'County Office of Education (COE)', 'State Board of Education', 'Statewide Benefit Charter'].),\n  (School Type <TEXT>,  School Type. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].),\n  (Educational Option Type <TEXT>,  Educational Option Type. Value examples: [None, 'Traditional', 'Continuation School', 'Alternative School of Choice', 'Community Day School', 'Special Education School', 'County Community School'].),\n  (NSLP Provision Status <TEXT>,  NSLP Provision Status. Value examples: [None, 'Provision 2', 'Breakfast Provision 2', 'CEP', 'Multiple Provision Types', 'Provision 1', 'Lunch Provision 2'].),\n  (Charter School (Y/N) <INTEGER>,  Charter School (Y/N). Value examples: [None, 0, 1].),\n  (Charter School Number <TEXT>,  Charter School Number. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1700', '1696'].),\n  (Charter Funding Type <TEXT>,  Charter Funding Type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (IRC <INTEGER>,  IRC. Value examples: [None, 0, 1].),\n  (Low Grade <TEXT>,  Low Grade. Value examples: ['K', '9', '6', '7', 'P', '5'].),\n  (High Grade <TEXT>,  High Grade. Value examples: ['12', '5', '8', '6', '3', '4'].),\n  (Enrollment (K-12) <REAL>,  Enrollment (K-12).),\n  (Free Meal Count (K-12) <REAL>,  Free Meal Count (K-12).),\n  (Percent (%) Eligible Free (K-12) <REAL>,  Percent (%) Eligible Free (K-12).),\n  (FRPM Count (K-12) <REAL>,  Free or Reduced Price Meal Count (K-12).),\n  (Percent (%) Eligible FRPM (K-12) <REAL>,  Percent (%) Eligible FRPM (K-12).),\n  (Enrollment (Ages 5-17) <REAL>,  Enrollment (Ages 5-17).),\n  (Free Meal Count (Ages 5-17) <REAL>,  Free Meal Count (Ages 5-17).),\n  (Percent (%) Eligible Free (Ages 5-17) <REAL>,  Percent (%) Eligible Free (Ages 5-17).),\n  (FRPM Count (Ages 5-17) <REAL>,  FRPM Count (Ages 5-17).),\n  (Percent (%) Eligible FRPM (Ages 5-17) <REAL>,  Percent (%) Eligible FRPM (Ages 5-17).),\n  (2013-14 CALPADS Fall 1 Certification Status <INTEGER>,  2013-14 CALPADS Fall 1 Certification Status. Value examples: [1].)\n]\n# Table: satscores\n[\n  (cds <TEXT>,  California Department Schools.),\n  (rtype <TEXT>,  rtype. Value examples: ['S', 'D'].),\n  (sname <TEXT>,  school name. Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].),\n  (dname <TEXT>,  district segment. Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].),\n  (cname <TEXT>,  county name. Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].),\n  (enroll12 <INTEGER>,  enrollment (1st-12nd grade).),\n  (NumTstTakr <INTEGER>,  Number of Test Takers in this school.),\n  (AvgScrRead <INTEGER>,  average scores in Reading.),\n  (AvgScrMath <INTEGER>,  average scores in Math.),\n  (AvgScrWrite <INTEGER>,  average scores in writing.),\n  (NumGE1500 <INTEGER>,  Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500.)\n]\n# Table: schools\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (NCESDist <TEXT>,  This field represents the 7-digit National Center for Educational Statistics (NCES) school district identification number. The first 2 digits identify the state and the last 5 digits identify the school district. Combined, they make a unique 7-digit ID for each school district.. Value examples: [None, '0622710', '0634320', '0628050', '0634410', '0614550', '0633840'].),\n  (NCESSchool <TEXT>,  This field represents the 5-digit NCES school identification number. The NCESSchool combined with the NCESDist form a unique 12-digit ID for each school.. Value examples: [None, '12271', '13785', '13747', '12909', '12311', '12003'].),\n  (StatusType <TEXT>,  This field identifies the status of the district.. Value examples: ['Active', 'Closed', 'Merged', 'Pending'].),\n  (County <TEXT>,  County name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].),\n  (District <TEXT>,  District.),\n  (School <TEXT>,  School.),\n  (Street <TEXT>,  Street.),\n  (StreetAbr <TEXT>,  The abbreviated street address of the school, district, or administrative authority’s physical location..),\n  (City <TEXT>,  City. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].),\n  (Zip <TEXT>,  Zip. Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].),\n  (State <TEXT>,  State. Value examples: [None, 'CA'].),\n  (MailStreet <TEXT>,  MailStreet.),\n  (MailStrAbr <TEXT>,  mailing street address.),\n  (MailCity <TEXT>,  mailing city. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].),\n  (MailZip <TEXT>,  mailing zip. Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].),\n  (MailState <TEXT>,  mailing state. Value examples: [None, 'CA'].),\n  (Phone <TEXT>,  Phone. Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].),\n  (Ext <TEXT>,  The phone number extension of the school, district, or administrative authority.. Value examples: [None, '200', '201', '111', '352', '221', '203'].),\n  (Website <TEXT>,  The website address of the school, district, or administrative authority..),\n  (OpenDate <DATE>,  The date the school opened.. Value examples: [None, '1980-07-01'].),\n  (ClosedDate <DATE>,  The date the school closed.. Value examples: [None, '1989-06-30'].),\n  (Charter <INTEGER>,  This field identifies a charter school.. Value examples: [None, 0, 1].),\n  (CharterNum <TEXT>,  The charter school number,. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1826', '1710'].),\n  (FundingType <TEXT>,  Indicates the charter school funding type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (DOC <TEXT>,  District Ownership Code. Value examples: ['54', '52', '00', '56', '98', '02'].),\n  (DOCType <TEXT>,  The District Ownership Code Type is the text description of the DOC category.. Value examples: ['Unified School District', 'Elementary School District', 'County Office of Education (COE)', 'High School District', 'Regional Occupation Center/Program (ROC/P)', 'State Board of Education'].),\n  (SOC <TEXT>,  The School Ownership Code is a numeric code used to identify the type of school.. Value examples: [None, '60', '66', '62', '68', '09', '69'].),\n  (SOCType <TEXT>,  The School Ownership Code Type is the text description of the type of school.. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Special Education Schools (Public)', 'District Community Day Schools'].),\n  (EdOpsCode <TEXT>,  The Education Option Code is a short text description of the type of education offered.. Value examples: [None, 'TRAD', 'CON', 'COMMDAY', 'ALTSOC', 'SPEC', 'COMM'].),\n  (EdOpsName <TEXT>,  Educational Option Name. Value examples: [None, 'Traditional', 'Continuation School', 'Community Day School', 'Alternative School of Choice', 'Special Education School', 'County Community School'].),\n  (EILCode <TEXT>,  The Educational Instruction Level Code is a short text description of the institution's type relative to the grade range served.. Value examples: [None, 'ELEM', 'HS', 'UG', 'INTMIDJR', 'ELEMHIGH', 'A'].),\n  (EILName <TEXT>,  The Educational Instruction Level Name is the long text description of the institution’s type relative to the grade range served.. Value examples: [None, 'Elementary', 'High School', 'Ungraded', 'Intermediate/Middle/Junior High', 'Elementary-High Combination', 'Adult'].),\n  (GSoffered <TEXT>,  The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.. Value examples: [None, 'K-5', '9-12', 'K-6', 'K-8', '6-8', 'K-12'].),\n  (GSserved <TEXT>,  It is the lowest grade and the highest grade of student enrollment as reported in the most recent certified CALPADS Fall 1 data collection. Only K–12 enrollment is reported through CALPADS. This field may differ from the grade span offered.. Value examples: [None, 'K-5', 'K-6', '9-12', 'K-8', '6-8', '7-8'].),\n  (Virtual <TEXT>,  This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.. Value examples: [None, 'N', 'P', 'F'].),\n  (Magnet <INTEGER>,  This field identifies whether a school is a magnet school and/or provides a magnet program.. Value examples: [None, 0, 1].),\n  (Latitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the equator measured north to south..),\n  (Longitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the prime meridian (Greenwich, England) measured from west to east..),\n  (AdmFName1 <TEXT>,  administrator's first name 1. Value examples: [None, 'David', 'Michael', 'John', 'Jennifer', 'Lisa', 'Robert'].),\n  (AdmLName1 <TEXT>,  administrator's last name 1.),\n  (AdmEmail1 <TEXT>,  administrator's email address 1.),\n  (AdmFName2 <TEXT>,  administrator's first name 2. Value examples: [None, 'Steve', 'Delphine', 'Tim', 'Michael', 'Lisa', 'Jeff'].),\n  (AdmLName2 <TEXT>,  administrator's last name 2. Value examples: [None, 'Sherman', 'Jones', 'Wilson', 'Petersen', 'Landry', 'Hambright'].),\n  (AdmEmail2 <TEXT>,  administrator's email address 2.),\n  (AdmFName3 <TEXT>,  administrator's first name 3. Value examples: [None, 'Mark', 'Eric', 'Vickie', 'Tracie', 'Shawn', 'Sarah'].),\n  (AdmLName3 <TEXT>,  administrator's last name 3. Value examples: [None, 'Zerpoli', 'Yount', 'Woodruff', 'Wood', 'Wolk', 'Spotts'].),\n  (AdmEmail3 <TEXT>,  administrator's email address 3.),\n  (LastUpdate <DATE>,  Last Update. Value examples: ['2015-06-18'].)\n]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Question】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 10, "cur_total_response_tokens": 10}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Decomposer", "response": "\n你好\n", "input_prompt": "[Instruction]\nGiven a 【query】, you need to understanding the intent of Query, and then deceompose it into Targets and Conditions. Then you need to combine Targets and Conditions into Subquerys step by step. \nFor the case where Conditions is NULL, consider Targets as the final Subquery directly. \nFor the case where Conditions are not NULL, combine Targets and the first Condition to get the first Subquery, then combine this Subquery and the next Condition into a new Subquery until all Conditions are used (which means the content of the last Subquery and the original Query is the same).\n\n[Requirements]\n-Try not to overlap Targets and Conditions.\n-Make sure the decomposed Target and Condition can cover all of the information in Query.\n-Don't change any information (specific value) in Query!\n-Mark each Subquery with ## in front of it.\n\nHere are some examples:\n==========\n\n【Query】\nShow the stadium name and the number of concerts in each stadium. Please also list the year the stadium was built. \n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the stadium name, the year the stadium built and the number of concerts in each stadium\nConditions: NULL\n\nSubqueries:\n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the stadium name, the year the stadium built and the number of concerts in each stadium\n==========\n\n【Query】\nWhat is the qualification rate for the H-11 products produced in 2023/11/2?\n【Evidence】\nqualification rate = `Numqualified(H-11)` / `production(H-11)`\n\n【Decomposition】\nTargets: List the qualification rate for the H-11 Products\nConditions:\n1. produced in 2023/11/2 --Condition_1\n\nSubqueries:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the qualification rate for the H-11 Products produced in 2023/11/2\n\n==========\n\n【Query】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n\n【Decomposition】\nTargets: List the race of institutions\nConditions: \n1. in Alabama --Condition_1\n2. number of students greater than the 90% of average number of students of all institutions --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the race of institution in Alabama\n2. Conbine the first Subquery and Conditon_2 to get the seconed Subquery.\n##Subquery: List the race of institutions in Alabama with number of number of students greater than the 90% of average number of students of all institutions\n\n==========\n\n【Query】\nWhich president got a higher approval rating, Joseph Biden or Donald Trump?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\nConditions: \nNULL\n\nSubqueries: \n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\n\n==========\n\n【Query】\nFor movie id 1269, how many users, who was a paying subscriber and was eligible for trial when he rated the movie, gave the movie a rating score of less than or equal to 2?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the number of users\nConditions:\n1. was a paying subscriber --Condition_1\n2. was eligible for trial --Condition_2\n3. for movie id 1269, gave the movie a rating score of less than or equal to 2 --Condition3\n\nSubquerys:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the number of users who was a paying subscriber\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial\n3. Combine the second Subquery and Condition_3 to get the third Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial and gave the movie whose id is 1269 a rating score of less than or equal to 2\n\n==========\n\nHere is a new query need to be decomposed:\n\n【Query】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n\n【Decomposition】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 20, "cur_total_response_tokens": 20}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Generator", "response": "\n你好\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】and a 【Question】, you need to use valid SQLite and understand the database and knowledge so that you can generate a good SQL for the 【Question】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# stadium: [Stadium_ID (INTEGER), Location (TEXT), Name (TEXT)]\n# concert: [concert_ID (INTEGER), concert_Name (TEXT), Stadium_ID (INTEGER)]\n【Primary keys】\nstadium.`Stadium_ID` | concert.`concert_ID`\n【Foreign keys】\nconcert.`Stadium_ID` = stadium.`Stadium_ID`\n【Detailed descriptions of tables and columns】\nstadium.`Stadium_ID`: The column 'Stadium_ID' in Table <stadium> has column descriptions of \"stadium id\". Value examples: [1, 2, 3, 4, 5, 6].\nstadium.`Name`:  The column 'Name' in Table <stadium> has column descriptions of \"name of stadium\". Value examples: [\"Stark's Park\", 'Somerset Park', 'Recreation Park', 'Hampden Park', 'Glebe Park', 'Gayfield Park'].\nstadium.`Location`: The column 'Location' in Table <stadium> has column descriptions of \"location of stadium\". Value examples: ['Stirling Albion', 'Raith Rovers', \"Queen's Park\", 'Peterhead', 'East Fife', 'Brechin City'].\nconcert.`concert_ID`: The column 'concert_ID' in Table <concert> has column descriptions of \"concert id\". Value examples: [1, 2, 3, 4, 5, 6].\nconcert.`concert_Name`: The column 'concert_Name' in Table <concert> has column descriptions of \"concert name\". Value examples: ['Week 1', 'Week 2', 'Super bootcamp', 'Home Visits', 'Auditions'].\nconcert.`Stadium_ID`: The column 'Stadium_ID' in Table <concert> has column descriptions of \"stadium id\". Value examples: [2, 9, 7, 10, 1].\n【Evidence】\nNULL\n【Question】\nShow the stadium name and the number of concerts in each stadium.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: Show the stadium name and the number of concerts in each stadium.\nTargets for `SELECT`: the stadium name and the number of concerts\nhints from 【Evidence】:NULL\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the stadium name refers to stadium.`Name`, the number of concerts refers to COUNT(concert.`concert_ID`), each stadium refers to stadium.`Stadium_ID`\nConnection of tables: include tables <stadium> and <concert>, get connected keys from 【Foreign keys】: concert.`Stadium_ID` = stadium.`Stadium_ID`\nFinal SQL:\n```sql\nSELECT T1.`Name`, COUNT(T2.concert_ID) AS num_concerts\n  FROM stadium AS T1\n  JOIN concert AS T2\n  ON T1.`Stadium_ID` = T2.`Stadium_ID`\n  GROUP BY T1.`Stadium_ID`\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); name of the car refers to car_name\n【Question】\nWhat is the fastest car made by Japan?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ncountry.`country` = 'Japan'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: What is the fastest car made by Japan?\nTargets for `SELECT`: the name of the fastest car\nhints from 【Evidence】: the fastest refers to max(horsepower); name of the car refers to car_name\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: car refers to data.`car_name`, the fastest refers to MAX(data.`horsepower`), Japan refers to country.`country`\nConnection of tables: includes tables <data> and <country>, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`car_name` \n  FROM data AS T1 \n  INNER JOIN production AS T2 \n  ON T1.`ID` = T2.`ID` \n  INNER JOIN country AS T3 \n  ON T3.`origin` = T2.`country` \n  WHERE T3.`country` = 'Japan' \n  ORDER BY T1.`horsepower` DESC LIMIT 1\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`chronname`: The column 'chronname' in Table <institution_details> has column descriptions of \"Institution name\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \n【Evidence】\nnumber of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the chronname of institutions with number of students greater than the 90% of average number of students of all institutions?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: List the chroname of institutions with number of students greater than the 90% of average number of students of all institutions?\nTargets for `SELECT`: the chroname of institutions\nhints from 【Evidence】: number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the chronname of institutions refers to institution_details.`chronname`, number of students refers to institution_details.`student_count`\nConnection of tables: include only one table <institution_details>, no connection\nFinal SQL:\n```sql\nSELECT DISTINCT `chroname`\n  FROM institution_details\n  WHERE `student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details\n  ) \n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Question】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 30, "cur_total_response_tokens": 30}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Query】\n-- How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 40, "cur_total_response_tokens": 40}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Query】\n-- How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 50, "cur_total_response_tokens": 50}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Soft_Schema_Linker", "response": "\n你好\n", "input_prompt": "As an experienced and professional database administrator, your task is to analyze a user question and a database schema to provide relevant information. The database schema consists of table descriptions, each containing multiple column descriptions. Your goal is to extract the entities from question and identify the relevant tables and columns based on these entities and the evidence provided.\n\n[Instruction]:\n1. Extract the mentioned entities from the user question. Make sure all of the entities are extracted. \n2. For each entity, keep at least 3 related columns.\n4. Your output should include entity extraction, analysis and related database schema.\n5. The related database schema should be in JSON format.\n6. Each column's information in provided 【Schema】 is in this format: (column, description. Value examples<optional>)\n\n[Requirements]:\n1. Sort the related columns in each list corresponding to each entity in descending order of relevance.\n2. The chosen columns should be in this format: <table.column>.\n3. Make sure each chosen list is not empty. The value [] will be punished. \n4.【Matched values】 may contain redundant or useless information in addition to the correct matching values, so you need to select the useful information in conjunction with the specific column names and descriptions.\n5. An entity may not have a corresponding evidence, which requires you to find the relevant columns yourself through your understanding of the database schema.\n\nHere is a typical example:\n\n==========\n【DB_ID】 banking_system\n【Schema】\n# Table: account\n[\n  (account_id <INTEGER>, the id of the account. Value examples: [11382, 11362, 2, 1, 2367].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (frequency <TEXT>, frequency of the acount. Value examples: ['POPLATEK MESICNE', 'POPLATEK TYDNE', 'POPLATEK PO OBRATU'].),\n  (date <DATE>, the creation date of the account. Value examples: ['1997-12-29', '1997-12-28'].)\n]\n# Table: client\n[\n  (client_id <INTEGER>, the unique number. Value examples: [13998, 13971, 2, 1, 2839].),\n  (gender <TEXT>, gender. Value examples: ['M', 'F']. And F：female . M：male ),\n  (birth_date <DATE>, birth date. Value examples: ['1987-09-27', '1986-08-13'].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (first_name <TEXT>, first_name.),\n  (last_name <TEXT>, last_name.)\n]\n# Table: loan\n[\n  (loan_id <INTEGER>, the id number identifying the loan data. Value examples: [4959, 4960, 4961].),\n  (account_id <INTEGER>, the id number identifying the account. Value examples: [10, 80, 55, 43].),\n  (date <DATE>, the date when the loan is approved. Value examples: ['1998-07-12', '1998-04-19'].),\n  (amount <INTEGER>, the id number identifying the loan data. Value examples: [1567, 7877, 9988].),\n  (duration <INTEGER>, the id number identifying the loan data. Value examples: [60, 48, 24, 12, 36].),\n  (payments <INTEGER>, the id number identifying the loan data. Value examples: [3456, 8972, 9845].),\n  (status <TEXT>, the id number identifying the loan data. Value examples: ['C', 'A', 'D', 'B'].)\n]\n# Table: district\n[\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76].),\n  (A2 <REAL>, area in square kilometers. Value examples: [50.5, 48.9].),\n  (A4 <INTEGER>, number of inhabitants. Value examples: [95907, 95616].),\n  (A5 <INTEGER>, number of households. Value examples: [35678, 34892].),\n  (A6 <REAL>, literacy rate. Value examples: [95.6, 92.3, 89.7].),\n  (A7 <INTEGER>, number of entrepreneurs. Value examples: [1234, 1456].),\n  (A8 <INTEGERt>, number of cities. Value examples: [5, 4].),\n  (A9 <INTEGER>, number of schools. Value examples: [15, 12, 10].),\n  (A10 <INTEGER>, number of hospitals. Value examples: [8, 6, 4].),\n  (A11 <REAL>, average salary. Value examples: [12541.5, 11277].),\n  (A12 <REAL>, poverty rate. Value examples: [12.4, 9.8].),\n  (A13 <REAL>, unemployment rate. Value examples: [8.2, 7.9].),\n  (A15 <INTEGER>, number of crimes. Value examples: [256, 189].)\n]\n【Primary keys】\naccount.`account_id` | client.`client_id` | loan.`loan_id` | district.`district_id`\n【Foreign keys】\nclient.`district_id` = district.`district_id`\n【Question】\nWhat is the gender of the youngest client who opened account in the lowest average salary branch and when did this client open the account? Please list their full name.\n【Evidence】\nLater birthdate refers to younger age; A11 refers to average salary; Full name refers to first_name, last_name\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\nThe entities extracted from the 【Question】 are: \n1. gender; \n2. youngest client; \n3. account; \n4. lowest average salary branch; \n5. when did this client open the account; \n6. full name\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. gender --no related evidence **the columns about gender are related**\n2. youngest client  --Later birthdate refers to younger age; **the columns about birth date of client and the id of client are related**\n3. account --no related evidence **the columns about account or account ids are related**\n4. lowest average salary branch  --A11 refers to average salary **the columns about average salary and branch are related**\n5. when did this client open the account --no related evidence **the columns about time or date of the account are related**\n6. full name  --Full name refers to first_name, last_name **the columns about first_name, last_name of the client are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"gender\": [\"client.gender\",\"client.client_id\",\"loan.status\"],\n  \"youngest client\": [\"client.birth_date\",\"client.client_id\",\"account.date\",\"loan.date\"],\n  \"account\": [\"account.account_id\",\"loan.account_id\",\"account.date\"],\n  \"lowest average salary branch\": [\"district.A11\",\"district.district_id\",\"district.A13\"],\n  \"when did this client open the account\": [\"account.date\",\"loan.date\",\"client.birth_date\"],\n  \"full name\": [\"client.first_name\",\"client.last_name\",\"client.client_id\"]\n}\n```\nQuestion Solved.\n\n==========\n\nHere is a new example, please start answering:\n\n【DB_ID】 california_schools\n【Schema】\n# Table: frpm\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (Academic Year <TEXT>,  Academic Year. Value examples: ['2014-2015'].),\n  (County Code <TEXT>,  County Code. Value examples: ['19', '37', '30', '36', '33', '43'].),\n  (District Code <INTEGER>,  District Code.),\n  (School Code <TEXT>,  School Code. Value examples: ['0000000', '9010745', '6121081', '6121073', '6121016', '6120968'].),\n  (County Name <TEXT>,  County Name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].),\n  (District Name <TEXT>,  District Name.),\n  (School Name <TEXT>,  School Name.),\n  (District Type <TEXT>,  District Type. Value examples: ['Unified School District', 'Elementary School District', 'High School District', 'County Office of Education (COE)', 'State Board of Education', 'Statewide Benefit Charter'].),\n  (School Type <TEXT>,  School Type. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].),\n  (Educational Option Type <TEXT>,  Educational Option Type. Value examples: [None, 'Traditional', 'Continuation School', 'Alternative School of Choice', 'Community Day School', 'Special Education School', 'County Community School'].),\n  (NSLP Provision Status <TEXT>,  NSLP Provision Status. Value examples: [None, 'Provision 2', 'Breakfast Provision 2', 'CEP', 'Multiple Provision Types', 'Provision 1', 'Lunch Provision 2'].),\n  (Charter School (Y/N) <INTEGER>,  Charter School (Y/N). Value examples: [None, 0, 1].),\n  (Charter School Number <TEXT>,  Charter School Number. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1700', '1696'].),\n  (Charter Funding Type <TEXT>,  Charter Funding Type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (IRC <INTEGER>,  IRC. Value examples: [None, 0, 1].),\n  (Low Grade <TEXT>,  Low Grade. Value examples: ['K', '9', '6', '7', 'P', '5'].),\n  (High Grade <TEXT>,  High Grade. Value examples: ['12', '5', '8', '6', '3', '4'].),\n  (Enrollment (K-12) <REAL>,  Enrollment (K-12).),\n  (Free Meal Count (K-12) <REAL>,  Free Meal Count (K-12).),\n  (Percent (%) Eligible Free (K-12) <REAL>,  Percent (%) Eligible Free (K-12).),\n  (FRPM Count (K-12) <REAL>,  Free or Reduced Price Meal Count (K-12).),\n  (Percent (%) Eligible FRPM (K-12) <REAL>,  Percent (%) Eligible FRPM (K-12).),\n  (Enrollment (Ages 5-17) <REAL>,  Enrollment (Ages 5-17).),\n  (Free Meal Count (Ages 5-17) <REAL>,  Free Meal Count (Ages 5-17).),\n  (Percent (%) Eligible Free (Ages 5-17) <REAL>,  Percent (%) Eligible Free (Ages 5-17).),\n  (FRPM Count (Ages 5-17) <REAL>,  FRPM Count (Ages 5-17).),\n  (Percent (%) Eligible FRPM (Ages 5-17) <REAL>,  Percent (%) Eligible FRPM (Ages 5-17).),\n  (2013-14 CALPADS Fall 1 Certification Status <INTEGER>,  2013-14 CALPADS Fall 1 Certification Status. Value examples: [1].)\n]\n# Table: satscores\n[\n  (cds <TEXT>,  California Department Schools.),\n  (rtype <TEXT>,  rtype. Value examples: ['S', 'D'].),\n  (sname <TEXT>,  school name. Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].),\n  (dname <TEXT>,  district segment. Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].),\n  (cname <TEXT>,  county name. Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].),\n  (enroll12 <INTEGER>,  enrollment (1st-12nd grade).),\n  (NumTstTakr <INTEGER>,  Number of Test Takers in this school.),\n  (AvgScrRead <INTEGER>,  average scores in Reading.),\n  (AvgScrMath <INTEGER>,  average scores in Math.),\n  (AvgScrWrite <INTEGER>,  average scores in writing.),\n  (NumGE1500 <INTEGER>,  Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500.)\n]\n# Table: schools\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (NCESDist <TEXT>,  This field represents the 7-digit National Center for Educational Statistics (NCES) school district identification number. The first 2 digits identify the state and the last 5 digits identify the school district. Combined, they make a unique 7-digit ID for each school district.. Value examples: [None, '0622710', '0634320', '0628050', '0634410', '0614550', '0633840'].),\n  (NCESSchool <TEXT>,  This field represents the 5-digit NCES school identification number. The NCESSchool combined with the NCESDist form a unique 12-digit ID for each school.. Value examples: [None, '12271', '13785', '13747', '12909', '12311', '12003'].),\n  (StatusType <TEXT>,  This field identifies the status of the district.. Value examples: ['Active', 'Closed', 'Merged', 'Pending'].),\n  (County <TEXT>,  County name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].),\n  (District <TEXT>,  District.),\n  (School <TEXT>,  School.),\n  (Street <TEXT>,  Street.),\n  (StreetAbr <TEXT>,  The abbreviated street address of the school, district, or administrative authority’s physical location..),\n  (City <TEXT>,  City. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].),\n  (Zip <TEXT>,  Zip. Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].),\n  (State <TEXT>,  State. Value examples: [None, 'CA'].),\n  (MailStreet <TEXT>,  MailStreet.),\n  (MailStrAbr <TEXT>,  mailing street address.),\n  (MailCity <TEXT>,  mailing city. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].),\n  (MailZip <TEXT>,  mailing zip. Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].),\n  (MailState <TEXT>,  mailing state. Value examples: [None, 'CA'].),\n  (Phone <TEXT>,  Phone. Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].),\n  (Ext <TEXT>,  The phone number extension of the school, district, or administrative authority.. Value examples: [None, '200', '201', '111', '352', '221', '203'].),\n  (Website <TEXT>,  The website address of the school, district, or administrative authority..),\n  (OpenDate <DATE>,  The date the school opened.. Value examples: [None, '1980-07-01'].),\n  (ClosedDate <DATE>,  The date the school closed.. Value examples: [None, '1989-06-30'].),\n  (Charter <INTEGER>,  This field identifies a charter school.. Value examples: [None, 0, 1].),\n  (CharterNum <TEXT>,  The charter school number,. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1826', '1710'].),\n  (FundingType <TEXT>,  Indicates the charter school funding type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (DOC <TEXT>,  District Ownership Code. Value examples: ['54', '52', '00', '56', '98', '02'].),\n  (DOCType <TEXT>,  The District Ownership Code Type is the text description of the DOC category.. Value examples: ['Unified School District', 'Elementary School District', 'County Office of Education (COE)', 'High School District', 'Regional Occupation Center/Program (ROC/P)', 'State Board of Education'].),\n  (SOC <TEXT>,  The School Ownership Code is a numeric code used to identify the type of school.. Value examples: [None, '60', '66', '62', '68', '09', '69'].),\n  (SOCType <TEXT>,  The School Ownership Code Type is the text description of the type of school.. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Special Education Schools (Public)', 'District Community Day Schools'].),\n  (EdOpsCode <TEXT>,  The Education Option Code is a short text description of the type of education offered.. Value examples: [None, 'TRAD', 'CON', 'COMMDAY', 'ALTSOC', 'SPEC', 'COMM'].),\n  (EdOpsName <TEXT>,  Educational Option Name. Value examples: [None, 'Traditional', 'Continuation School', 'Community Day School', 'Alternative School of Choice', 'Special Education School', 'County Community School'].),\n  (EILCode <TEXT>,  The Educational Instruction Level Code is a short text description of the institution's type relative to the grade range served.. Value examples: [None, 'ELEM', 'HS', 'UG', 'INTMIDJR', 'ELEMHIGH', 'A'].),\n  (EILName <TEXT>,  The Educational Instruction Level Name is the long text description of the institution’s type relative to the grade range served.. Value examples: [None, 'Elementary', 'High School', 'Ungraded', 'Intermediate/Middle/Junior High', 'Elementary-High Combination', 'Adult'].),\n  (GSoffered <TEXT>,  The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.. Value examples: [None, 'K-5', '9-12', 'K-6', 'K-8', '6-8', 'K-12'].),\n  (GSserved <TEXT>,  It is the lowest grade and the highest grade of student enrollment as reported in the most recent certified CALPADS Fall 1 data collection. Only K–12 enrollment is reported through CALPADS. This field may differ from the grade span offered.. Value examples: [None, 'K-5', 'K-6', '9-12', 'K-8', '6-8', '7-8'].),\n  (Virtual <TEXT>,  This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.. Value examples: [None, 'N', 'P', 'F'].),\n  (Magnet <INTEGER>,  This field identifies whether a school is a magnet school and/or provides a magnet program.. Value examples: [None, 0, 1].),\n  (Latitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the equator measured north to south..),\n  (Longitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the prime meridian (Greenwich, England) measured from west to east..),\n  (AdmFName1 <TEXT>,  administrator's first name 1. Value examples: [None, 'David', 'Michael', 'John', 'Jennifer', 'Lisa', 'Robert'].),\n  (AdmLName1 <TEXT>,  administrator's last name 1.),\n  (AdmEmail1 <TEXT>,  administrator's email address 1.),\n  (AdmFName2 <TEXT>,  administrator's first name 2. Value examples: [None, 'Steve', 'Delphine', 'Tim', 'Michael', 'Lisa', 'Jeff'].),\n  (AdmLName2 <TEXT>,  administrator's last name 2. Value examples: [None, 'Sherman', 'Jones', 'Wilson', 'Petersen', 'Landry', 'Hambright'].),\n  (AdmEmail2 <TEXT>,  administrator's email address 2.),\n  (AdmFName3 <TEXT>,  administrator's first name 3. Value examples: [None, 'Mark', 'Eric', 'Vickie', 'Tracie', 'Shawn', 'Sarah'].),\n  (AdmLName3 <TEXT>,  administrator's last name 3. Value examples: [None, 'Zerpoli', 'Yount', 'Woodruff', 'Wood', 'Wolk', 'Spotts'].),\n  (AdmEmail3 <TEXT>,  administrator's email address 3.),\n  (LastUpdate <DATE>,  Last Update. Value examples: ['2015-06-18'].)\n]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Question】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 10, "cur_total_response_tokens": 10}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Decomposer", "response": "\n你好\n", "input_prompt": "[Instruction]\nGiven a 【query】, you need to understanding the intent of Query, and then deceompose it into Targets and Conditions. Then you need to combine Targets and Conditions into Subquerys step by step. \nFor the case where Conditions is NULL, consider Targets as the final Subquery directly. \nFor the case where Conditions are not NULL, combine Targets and the first Condition to get the first Subquery, then combine this Subquery and the next Condition into a new Subquery until all Conditions are used (which means the content of the last Subquery and the original Query is the same).\n\n[Requirements]\n-Try not to overlap Targets and Conditions.\n-Make sure the decomposed Target and Condition can cover all of the information in Query.\n-Don't change any information (specific value) in Query!\n-Mark each Subquery with ## in front of it.\n\nHere are some examples:\n==========\n\n【Query】\nShow the stadium name and the number of concerts in each stadium. Please also list the year the stadium was built. \n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the stadium name, the year the stadium built and the number of concerts in each stadium\nConditions: NULL\n\nSubqueries:\n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the stadium name, the year the stadium built and the number of concerts in each stadium\n==========\n\n【Query】\nWhat is the qualification rate for the H-11 products produced in 2023/11/2?\n【Evidence】\nqualification rate = `Numqualified(H-11)` / `production(H-11)`\n\n【Decomposition】\nTargets: List the qualification rate for the H-11 Products\nConditions:\n1. produced in 2023/11/2 --Condition_1\n\nSubqueries:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the qualification rate for the H-11 Products produced in 2023/11/2\n\n==========\n\n【Query】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n\n【Decomposition】\nTargets: List the race of institutions\nConditions: \n1. in Alabama --Condition_1\n2. number of students greater than the 90% of average number of students of all institutions --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the race of institution in Alabama\n2. Conbine the first Subquery and Conditon_2 to get the seconed Subquery.\n##Subquery: List the race of institutions in Alabama with number of number of students greater than the 90% of average number of students of all institutions\n\n==========\n\n【Query】\nWhich president got a higher approval rating, Joseph Biden or Donald Trump?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\nConditions: \nNULL\n\nSubqueries: \n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\n\n==========\n\n【Query】\nFor movie id 1269, how many users, who was a paying subscriber and was eligible for trial when he rated the movie, gave the movie a rating score of less than or equal to 2?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the number of users\nConditions:\n1. was a paying subscriber --Condition_1\n2. was eligible for trial --Condition_2\n3. for movie id 1269, gave the movie a rating score of less than or equal to 2 --Condition3\n\nSubquerys:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the number of users who was a paying subscriber\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial\n3. Combine the second Subquery and Condition_3 to get the third Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial and gave the movie whose id is 1269 a rating score of less than or equal to 2\n\n==========\n\nHere is a new query need to be decomposed:\n\n【Query】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n\n【Decomposition】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 20, "cur_total_response_tokens": 20}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Generator", "response": "\n你好\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】and a 【Question】, you need to use valid SQLite and understand the database and knowledge so that you can generate a good SQL for the 【Question】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# stadium: [Stadium_ID (INTEGER), Location (TEXT), Name (TEXT)]\n# concert: [concert_ID (INTEGER), concert_Name (TEXT), Stadium_ID (INTEGER)]\n【Primary keys】\nstadium.`Stadium_ID` | concert.`concert_ID`\n【Foreign keys】\nconcert.`Stadium_ID` = stadium.`Stadium_ID`\n【Detailed descriptions of tables and columns】\nstadium.`Stadium_ID`: The column 'Stadium_ID' in Table <stadium> has column descriptions of \"stadium id\". Value examples: [1, 2, 3, 4, 5, 6].\nstadium.`Name`:  The column 'Name' in Table <stadium> has column descriptions of \"name of stadium\". Value examples: [\"Stark's Park\", 'Somerset Park', 'Recreation Park', 'Hampden Park', 'Glebe Park', 'Gayfield Park'].\nstadium.`Location`: The column 'Location' in Table <stadium> has column descriptions of \"location of stadium\". Value examples: ['Stirling Albion', 'Raith Rovers', \"Queen's Park\", 'Peterhead', 'East Fife', 'Brechin City'].\nconcert.`concert_ID`: The column 'concert_ID' in Table <concert> has column descriptions of \"concert id\". Value examples: [1, 2, 3, 4, 5, 6].\nconcert.`concert_Name`: The column 'concert_Name' in Table <concert> has column descriptions of \"concert name\". Value examples: ['Week 1', 'Week 2', 'Super bootcamp', 'Home Visits', 'Auditions'].\nconcert.`Stadium_ID`: The column 'Stadium_ID' in Table <concert> has column descriptions of \"stadium id\". Value examples: [2, 9, 7, 10, 1].\n【Evidence】\nNULL\n【Question】\nShow the stadium name and the number of concerts in each stadium.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: Show the stadium name and the number of concerts in each stadium.\nTargets for `SELECT`: the stadium name and the number of concerts\nhints from 【Evidence】:NULL\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the stadium name refers to stadium.`Name`, the number of concerts refers to COUNT(concert.`concert_ID`), each stadium refers to stadium.`Stadium_ID`\nConnection of tables: include tables <stadium> and <concert>, get connected keys from 【Foreign keys】: concert.`Stadium_ID` = stadium.`Stadium_ID`\nFinal SQL:\n```sql\nSELECT T1.`Name`, COUNT(T2.concert_ID) AS num_concerts\n  FROM stadium AS T1\n  JOIN concert AS T2\n  ON T1.`Stadium_ID` = T2.`Stadium_ID`\n  GROUP BY T1.`Stadium_ID`\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); name of the car refers to car_name\n【Question】\nWhat is the fastest car made by Japan?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ncountry.`country` = 'Japan'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: What is the fastest car made by Japan?\nTargets for `SELECT`: the name of the fastest car\nhints from 【Evidence】: the fastest refers to max(horsepower); name of the car refers to car_name\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: car refers to data.`car_name`, the fastest refers to MAX(data.`horsepower`), Japan refers to country.`country`\nConnection of tables: includes tables <data> and <country>, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`car_name` \n  FROM data AS T1 \n  INNER JOIN production AS T2 \n  ON T1.`ID` = T2.`ID` \n  INNER JOIN country AS T3 \n  ON T3.`origin` = T2.`country` \n  WHERE T3.`country` = 'Japan' \n  ORDER BY T1.`horsepower` DESC LIMIT 1\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`chronname`: The column 'chronname' in Table <institution_details> has column descriptions of \"Institution name\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \n【Evidence】\nnumber of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the chronname of institutions with number of students greater than the 90% of average number of students of all institutions?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: List the chroname of institutions with number of students greater than the 90% of average number of students of all institutions?\nTargets for `SELECT`: the chroname of institutions\nhints from 【Evidence】: number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the chronname of institutions refers to institution_details.`chronname`, number of students refers to institution_details.`student_count`\nConnection of tables: include only one table <institution_details>, no connection\nFinal SQL:\n```sql\nSELECT DISTINCT `chroname`\n  FROM institution_details\n  WHERE `student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details\n  ) \n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Question】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 30, "cur_total_response_tokens": 30}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Query】\n-- How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 40, "cur_total_response_tokens": 40}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Query】\n-- How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 50, "cur_total_response_tokens": 50}
{"idx": 6, "db_id": "california_schools", "query": "Among the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.", "evidence": "Magnet schools or offer a magnet program means that Magnet = 1", "difficulty": "simple", "ground_truth": "SELECT T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Magnet = 1 AND T1.NumTstTakr > 500", "send_to": "Soft_Schema_Linker", "response": "\n你好\n", "input_prompt": "As an experienced and professional database administrator, your task is to analyze a user question and a database schema to provide relevant information. The database schema consists of table descriptions, each containing multiple column descriptions. Your goal is to extract the entities from question and identify the relevant tables and columns based on these entities and the evidence provided.\n\n[Instruction]:\n1. Extract the mentioned entities from the user question. Make sure all of the entities are extracted. \n2. For each entity, keep at least 3 related columns.\n4. Your output should include entity extraction, analysis and related database schema.\n5. The related database schema should be in JSON format.\n6. Each column's information in provided 【Schema】 is in this format: (column, description. Value examples<optional>)\n\n[Requirements]:\n1. Sort the related columns in each list corresponding to each entity in descending order of relevance.\n2. The chosen columns should be in this format: <table.column>.\n3. Make sure each chosen list is not empty. The value [] will be punished. \n4.【Matched values】 may contain redundant or useless information in addition to the correct matching values, so you need to select the useful information in conjunction with the specific column names and descriptions.\n5. An entity may not have a corresponding evidence, which requires you to find the relevant columns yourself through your understanding of the database schema.\n\nHere is a typical example:\n\n==========\n【DB_ID】 banking_system\n【Schema】\n# Table: account\n[\n  (account_id <INTEGER>, the id of the account. Value examples: [11382, 11362, 2, 1, 2367].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (frequency <TEXT>, frequency of the acount. Value examples: ['POPLATEK MESICNE', 'POPLATEK TYDNE', 'POPLATEK PO OBRATU'].),\n  (date <DATE>, the creation date of the account. Value examples: ['1997-12-29', '1997-12-28'].)\n]\n# Table: client\n[\n  (client_id <INTEGER>, the unique number. Value examples: [13998, 13971, 2, 1, 2839].),\n  (gender <TEXT>, gender. Value examples: ['M', 'F']. And F：female . M：male ),\n  (birth_date <DATE>, birth date. Value examples: ['1987-09-27', '1986-08-13'].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (first_name <TEXT>, first_name.),\n  (last_name <TEXT>, last_name.)\n]\n# Table: loan\n[\n  (loan_id <INTEGER>, the id number identifying the loan data. Value examples: [4959, 4960, 4961].),\n  (account_id <INTEGER>, the id number identifying the account. Value examples: [10, 80, 55, 43].),\n  (date <DATE>, the date when the loan is approved. Value examples: ['1998-07-12', '1998-04-19'].),\n  (amount <INTEGER>, the id number identifying the loan data. Value examples: [1567, 7877, 9988].),\n  (duration <INTEGER>, the id number identifying the loan data. Value examples: [60, 48, 24, 12, 36].),\n  (payments <INTEGER>, the id number identifying the loan data. Value examples: [3456, 8972, 9845].),\n  (status <TEXT>, the id number identifying the loan data. Value examples: ['C', 'A', 'D', 'B'].)\n]\n# Table: district\n[\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76].),\n  (A2 <REAL>, area in square kilometers. Value examples: [50.5, 48.9].),\n  (A4 <INTEGER>, number of inhabitants. Value examples: [95907, 95616].),\n  (A5 <INTEGER>, number of households. Value examples: [35678, 34892].),\n  (A6 <REAL>, literacy rate. Value examples: [95.6, 92.3, 89.7].),\n  (A7 <INTEGER>, number of entrepreneurs. Value examples: [1234, 1456].),\n  (A8 <INTEGERt>, number of cities. Value examples: [5, 4].),\n  (A9 <INTEGER>, number of schools. Value examples: [15, 12, 10].),\n  (A10 <INTEGER>, number of hospitals. Value examples: [8, 6, 4].),\n  (A11 <REAL>, average salary. Value examples: [12541.5, 11277].),\n  (A12 <REAL>, poverty rate. Value examples: [12.4, 9.8].),\n  (A13 <REAL>, unemployment rate. Value examples: [8.2, 7.9].),\n  (A15 <INTEGER>, number of crimes. Value examples: [256, 189].)\n]\n【Primary keys】\naccount.`account_id` | client.`client_id` | loan.`loan_id` | district.`district_id`\n【Foreign keys】\nclient.`district_id` = district.`district_id`\n【Question】\nWhat is the gender of the youngest client who opened account in the lowest average salary branch and when did this client open the account? Please list their full name.\n【Evidence】\nLater birthdate refers to younger age; A11 refers to average salary; Full name refers to first_name, last_name\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\nThe entities extracted from the 【Question】 are: \n1. gender; \n2. youngest client; \n3. account; \n4. lowest average salary branch; \n5. when did this client open the account; \n6. full name\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. gender --no related evidence **the columns about gender are related**\n2. youngest client  --Later birthdate refers to younger age; **the columns about birth date of client and the id of client are related**\n3. account --no related evidence **the columns about account or account ids are related**\n4. lowest average salary branch  --A11 refers to average salary **the columns about average salary and branch are related**\n5. when did this client open the account --no related evidence **the columns about time or date of the account are related**\n6. full name  --Full name refers to first_name, last_name **the columns about first_name, last_name of the client are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"gender\": [\"client.gender\",\"client.client_id\",\"loan.status\"],\n  \"youngest client\": [\"client.birth_date\",\"client.client_id\",\"account.date\",\"loan.date\"],\n  \"account\": [\"account.account_id\",\"loan.account_id\",\"account.date\"],\n  \"lowest average salary branch\": [\"district.A11\",\"district.district_id\",\"district.A13\"],\n  \"when did this client open the account\": [\"account.date\",\"loan.date\",\"client.birth_date\"],\n  \"full name\": [\"client.first_name\",\"client.last_name\",\"client.client_id\"]\n}\n```\nQuestion Solved.\n\n==========\n\nHere is a new example, please start answering:\n\n【DB_ID】 california_schools\n【Schema】\n# Table: frpm\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (Academic Year <TEXT>,  Academic Year. Value examples: ['2014-2015'].),\n  (County Code <TEXT>,  County Code. Value examples: ['19', '37', '30', '36', '33', '43'].),\n  (District Code <INTEGER>,  District Code.),\n  (School Code <TEXT>,  School Code. Value examples: ['0000000', '9010745', '6121081', '6121073', '6121016', '6120968'].),\n  (County Name <TEXT>,  County Name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].),\n  (District Name <TEXT>,  District Name.),\n  (School Name <TEXT>,  School Name.),\n  (District Type <TEXT>,  District Type. Value examples: ['Unified School District', 'Elementary School District', 'High School District', 'County Office of Education (COE)', 'State Board of Education', 'Statewide Benefit Charter'].),\n  (School Type <TEXT>,  School Type. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].),\n  (Educational Option Type <TEXT>,  Educational Option Type. Value examples: [None, 'Traditional', 'Continuation School', 'Alternative School of Choice', 'Community Day School', 'Special Education School', 'County Community School'].),\n  (NSLP Provision Status <TEXT>,  NSLP Provision Status. Value examples: [None, 'Provision 2', 'Breakfast Provision 2', 'CEP', 'Multiple Provision Types', 'Provision 1', 'Lunch Provision 2'].),\n  (Charter School (Y/N) <INTEGER>,  Charter School (Y/N). Value examples: [None, 0, 1].),\n  (Charter School Number <TEXT>,  Charter School Number. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1700', '1696'].),\n  (Charter Funding Type <TEXT>,  Charter Funding Type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (IRC <INTEGER>,  IRC. Value examples: [None, 0, 1].),\n  (Low Grade <TEXT>,  Low Grade. Value examples: ['K', '9', '6', '7', 'P', '5'].),\n  (High Grade <TEXT>,  High Grade. Value examples: ['12', '5', '8', '6', '3', '4'].),\n  (Enrollment (K-12) <REAL>,  Enrollment (K-12).),\n  (Free Meal Count (K-12) <REAL>,  Free Meal Count (K-12).),\n  (Percent (%) Eligible Free (K-12) <REAL>,  Percent (%) Eligible Free (K-12).),\n  (FRPM Count (K-12) <REAL>,  Free or Reduced Price Meal Count (K-12).),\n  (Percent (%) Eligible FRPM (K-12) <REAL>,  Percent (%) Eligible FRPM (K-12).),\n  (Enrollment (Ages 5-17) <REAL>,  Enrollment (Ages 5-17).),\n  (Free Meal Count (Ages 5-17) <REAL>,  Free Meal Count (Ages 5-17).),\n  (Percent (%) Eligible Free (Ages 5-17) <REAL>,  Percent (%) Eligible Free (Ages 5-17).),\n  (FRPM Count (Ages 5-17) <REAL>,  FRPM Count (Ages 5-17).),\n  (Percent (%) Eligible FRPM (Ages 5-17) <REAL>,  Percent (%) Eligible FRPM (Ages 5-17).),\n  (2013-14 CALPADS Fall 1 Certification Status <INTEGER>,  2013-14 CALPADS Fall 1 Certification Status. Value examples: [1].)\n]\n# Table: satscores\n[\n  (cds <TEXT>,  California Department Schools.),\n  (rtype <TEXT>,  rtype. Value examples: ['S', 'D'].),\n  (sname <TEXT>,  school name. Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].),\n  (dname <TEXT>,  district segment. Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].),\n  (cname <TEXT>,  county name. Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].),\n  (enroll12 <INTEGER>,  enrollment (1st-12nd grade).),\n  (NumTstTakr <INTEGER>,  Number of Test Takers in this school.),\n  (AvgScrRead <INTEGER>,  average scores in Reading.),\n  (AvgScrMath <INTEGER>,  average scores in Math.),\n  (AvgScrWrite <INTEGER>,  average scores in writing.),\n  (NumGE1500 <INTEGER>,  Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500.)\n]\n# Table: schools\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (NCESDist <TEXT>,  This field represents the 7-digit National Center for Educational Statistics (NCES) school district identification number. The first 2 digits identify the state and the last 5 digits identify the school district. Combined, they make a unique 7-digit ID for each school district.. Value examples: [None, '0622710', '0634320', '0628050', '0634410', '0614550', '0633840'].),\n  (NCESSchool <TEXT>,  This field represents the 5-digit NCES school identification number. The NCESSchool combined with the NCESDist form a unique 12-digit ID for each school.. Value examples: [None, '12271', '13785', '13747', '12909', '12311', '12003'].),\n  (StatusType <TEXT>,  This field identifies the status of the district.. Value examples: ['Active', 'Closed', 'Merged', 'Pending'].),\n  (County <TEXT>,  County name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].),\n  (District <TEXT>,  District.),\n  (School <TEXT>,  School.),\n  (Street <TEXT>,  Street.),\n  (StreetAbr <TEXT>,  The abbreviated street address of the school, district, or administrative authority’s physical location..),\n  (City <TEXT>,  City. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].),\n  (Zip <TEXT>,  Zip. Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].),\n  (State <TEXT>,  State. Value examples: [None, 'CA'].),\n  (MailStreet <TEXT>,  MailStreet.),\n  (MailStrAbr <TEXT>,  mailing street address.),\n  (MailCity <TEXT>,  mailing city. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].),\n  (MailZip <TEXT>,  mailing zip. Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].),\n  (MailState <TEXT>,  mailing state. Value examples: [None, 'CA'].),\n  (Phone <TEXT>,  Phone. Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].),\n  (Ext <TEXT>,  The phone number extension of the school, district, or administrative authority.. Value examples: [None, '200', '201', '111', '352', '221', '203'].),\n  (Website <TEXT>,  The website address of the school, district, or administrative authority..),\n  (OpenDate <DATE>,  The date the school opened.. Value examples: [None, '1980-07-01'].),\n  (ClosedDate <DATE>,  The date the school closed.. Value examples: [None, '1989-06-30'].),\n  (Charter <INTEGER>,  This field identifies a charter school.. Value examples: [None, 0, 1].),\n  (CharterNum <TEXT>,  The charter school number,. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1826', '1710'].),\n  (FundingType <TEXT>,  Indicates the charter school funding type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (DOC <TEXT>,  District Ownership Code. Value examples: ['54', '52', '00', '56', '98', '02'].),\n  (DOCType <TEXT>,  The District Ownership Code Type is the text description of the DOC category.. Value examples: ['Unified School District', 'Elementary School District', 'County Office of Education (COE)', 'High School District', 'Regional Occupation Center/Program (ROC/P)', 'State Board of Education'].),\n  (SOC <TEXT>,  The School Ownership Code is a numeric code used to identify the type of school.. Value examples: [None, '60', '66', '62', '68', '09', '69'].),\n  (SOCType <TEXT>,  The School Ownership Code Type is the text description of the type of school.. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Special Education Schools (Public)', 'District Community Day Schools'].),\n  (EdOpsCode <TEXT>,  The Education Option Code is a short text description of the type of education offered.. Value examples: [None, 'TRAD', 'CON', 'COMMDAY', 'ALTSOC', 'SPEC', 'COMM'].),\n  (EdOpsName <TEXT>,  Educational Option Name. Value examples: [None, 'Traditional', 'Continuation School', 'Community Day School', 'Alternative School of Choice', 'Special Education School', 'County Community School'].),\n  (EILCode <TEXT>,  The Educational Instruction Level Code is a short text description of the institution's type relative to the grade range served.. Value examples: [None, 'ELEM', 'HS', 'UG', 'INTMIDJR', 'ELEMHIGH', 'A'].),\n  (EILName <TEXT>,  The Educational Instruction Level Name is the long text description of the institution’s type relative to the grade range served.. Value examples: [None, 'Elementary', 'High School', 'Ungraded', 'Intermediate/Middle/Junior High', 'Elementary-High Combination', 'Adult'].),\n  (GSoffered <TEXT>,  The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.. Value examples: [None, 'K-5', '9-12', 'K-6', 'K-8', '6-8', 'K-12'].),\n  (GSserved <TEXT>,  It is the lowest grade and the highest grade of student enrollment as reported in the most recent certified CALPADS Fall 1 data collection. Only K–12 enrollment is reported through CALPADS. This field may differ from the grade span offered.. Value examples: [None, 'K-5', 'K-6', '9-12', 'K-8', '6-8', '7-8'].),\n  (Virtual <TEXT>,  This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.. Value examples: [None, 'N', 'P', 'F'].),\n  (Magnet <INTEGER>,  This field identifies whether a school is a magnet school and/or provides a magnet program.. Value examples: [None, 0, 1].),\n  (Latitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the equator measured north to south..),\n  (Longitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the prime meridian (Greenwich, England) measured from west to east..),\n  (AdmFName1 <TEXT>,  administrator's first name 1. Value examples: [None, 'David', 'Michael', 'John', 'Jennifer', 'Lisa', 'Robert'].),\n  (AdmLName1 <TEXT>,  administrator's last name 1.),\n  (AdmEmail1 <TEXT>,  administrator's email address 1.),\n  (AdmFName2 <TEXT>,  administrator's first name 2. Value examples: [None, 'Steve', 'Delphine', 'Tim', 'Michael', 'Lisa', 'Jeff'].),\n  (AdmLName2 <TEXT>,  administrator's last name 2. Value examples: [None, 'Sherman', 'Jones', 'Wilson', 'Petersen', 'Landry', 'Hambright'].),\n  (AdmEmail2 <TEXT>,  administrator's email address 2.),\n  (AdmFName3 <TEXT>,  administrator's first name 3. Value examples: [None, 'Mark', 'Eric', 'Vickie', 'Tracie', 'Shawn', 'Sarah'].),\n  (AdmLName3 <TEXT>,  administrator's last name 3. Value examples: [None, 'Zerpoli', 'Yount', 'Woodruff', 'Wood', 'Wolk', 'Spotts'].),\n  (AdmEmail3 <TEXT>,  administrator's email address 3.),\n  (LastUpdate <DATE>,  Last Update. Value examples: ['2015-06-18'].)\n]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Question】\nAmong the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.\n【Evidence】\nMagnet schools or offer a magnet program means that Magnet = 1\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 60, "cur_total_response_tokens": 60}
{"idx": 6, "db_id": "california_schools", "query": "Among the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.", "evidence": "Magnet schools or offer a magnet program means that Magnet = 1", "difficulty": "simple", "ground_truth": "SELECT T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Magnet = 1 AND T1.NumTstTakr > 500", "send_to": "Decomposer", "response": "\n你好\n", "input_prompt": "[Instruction]\nGiven a 【query】, you need to understanding the intent of Query, and then deceompose it into Targets and Conditions. Then you need to combine Targets and Conditions into Subquerys step by step. \nFor the case where Conditions is NULL, consider Targets as the final Subquery directly. \nFor the case where Conditions are not NULL, combine Targets and the first Condition to get the first Subquery, then combine this Subquery and the next Condition into a new Subquery until all Conditions are used (which means the content of the last Subquery and the original Query is the same).\n\n[Requirements]\n-Try not to overlap Targets and Conditions.\n-Make sure the decomposed Target and Condition can cover all of the information in Query.\n-Don't change any information (specific value) in Query!\n-Mark each Subquery with ## in front of it.\n\nHere are some examples:\n==========\n\n【Query】\nShow the stadium name and the number of concerts in each stadium. Please also list the year the stadium was built. \n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the stadium name, the year the stadium built and the number of concerts in each stadium\nConditions: NULL\n\nSubqueries:\n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the stadium name, the year the stadium built and the number of concerts in each stadium\n==========\n\n【Query】\nWhat is the qualification rate for the H-11 products produced in 2023/11/2?\n【Evidence】\nqualification rate = `Numqualified(H-11)` / `production(H-11)`\n\n【Decomposition】\nTargets: List the qualification rate for the H-11 Products\nConditions:\n1. produced in 2023/11/2 --Condition_1\n\nSubqueries:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the qualification rate for the H-11 Products produced in 2023/11/2\n\n==========\n\n【Query】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n\n【Decomposition】\nTargets: List the race of institutions\nConditions: \n1. in Alabama --Condition_1\n2. number of students greater than the 90% of average number of students of all institutions --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the race of institution in Alabama\n2. Conbine the first Subquery and Conditon_2 to get the seconed Subquery.\n##Subquery: List the race of institutions in Alabama with number of number of students greater than the 90% of average number of students of all institutions\n\n==========\n\n【Query】\nWhich president got a higher approval rating, Joseph Biden or Donald Trump?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\nConditions: \nNULL\n\nSubqueries: \n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\n\n==========\n\n【Query】\nFor movie id 1269, how many users, who was a paying subscriber and was eligible for trial when he rated the movie, gave the movie a rating score of less than or equal to 2?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the number of users\nConditions:\n1. was a paying subscriber --Condition_1\n2. was eligible for trial --Condition_2\n3. for movie id 1269, gave the movie a rating score of less than or equal to 2 --Condition3\n\nSubquerys:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the number of users who was a paying subscriber\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial\n3. Combine the second Subquery and Condition_3 to get the third Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial and gave the movie whose id is 1269 a rating score of less than or equal to 2\n\n==========\n\nHere is a new query need to be decomposed:\n\n【Query】\nAmong the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.\n【Evidence】\nMagnet schools or offer a magnet program means that Magnet = 1\n\n【Decomposition】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 70, "cur_total_response_tokens": 70}
{"idx": 6, "db_id": "california_schools", "query": "Among the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.", "evidence": "Magnet schools or offer a magnet program means that Magnet = 1", "difficulty": "simple", "ground_truth": "SELECT T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Magnet = 1 AND T1.NumTstTakr > 500", "send_to": "Generator", "response": "\n你好\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】and a 【Question】, you need to use valid SQLite and understand the database and knowledge so that you can generate a good SQL for the 【Question】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# stadium: [Stadium_ID (INTEGER), Location (TEXT), Name (TEXT)]\n# concert: [concert_ID (INTEGER), concert_Name (TEXT), Stadium_ID (INTEGER)]\n【Primary keys】\nstadium.`Stadium_ID` | concert.`concert_ID`\n【Foreign keys】\nconcert.`Stadium_ID` = stadium.`Stadium_ID`\n【Detailed descriptions of tables and columns】\nstadium.`Stadium_ID`: The column 'Stadium_ID' in Table <stadium> has column descriptions of \"stadium id\". Value examples: [1, 2, 3, 4, 5, 6].\nstadium.`Name`:  The column 'Name' in Table <stadium> has column descriptions of \"name of stadium\". Value examples: [\"Stark's Park\", 'Somerset Park', 'Recreation Park', 'Hampden Park', 'Glebe Park', 'Gayfield Park'].\nstadium.`Location`: The column 'Location' in Table <stadium> has column descriptions of \"location of stadium\". Value examples: ['Stirling Albion', 'Raith Rovers', \"Queen's Park\", 'Peterhead', 'East Fife', 'Brechin City'].\nconcert.`concert_ID`: The column 'concert_ID' in Table <concert> has column descriptions of \"concert id\". Value examples: [1, 2, 3, 4, 5, 6].\nconcert.`concert_Name`: The column 'concert_Name' in Table <concert> has column descriptions of \"concert name\". Value examples: ['Week 1', 'Week 2', 'Super bootcamp', 'Home Visits', 'Auditions'].\nconcert.`Stadium_ID`: The column 'Stadium_ID' in Table <concert> has column descriptions of \"stadium id\". Value examples: [2, 9, 7, 10, 1].\n【Evidence】\nNULL\n【Question】\nShow the stadium name and the number of concerts in each stadium.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: Show the stadium name and the number of concerts in each stadium.\nTargets for `SELECT`: the stadium name and the number of concerts\nhints from 【Evidence】:NULL\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the stadium name refers to stadium.`Name`, the number of concerts refers to COUNT(concert.`concert_ID`), each stadium refers to stadium.`Stadium_ID`\nConnection of tables: include tables <stadium> and <concert>, get connected keys from 【Foreign keys】: concert.`Stadium_ID` = stadium.`Stadium_ID`\nFinal SQL:\n```sql\nSELECT T1.`Name`, COUNT(T2.concert_ID) AS num_concerts\n  FROM stadium AS T1\n  JOIN concert AS T2\n  ON T1.`Stadium_ID` = T2.`Stadium_ID`\n  GROUP BY T1.`Stadium_ID`\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); name of the car refers to car_name\n【Question】\nWhat is the fastest car made by Japan?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ncountry.`country` = 'Japan'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: What is the fastest car made by Japan?\nTargets for `SELECT`: the name of the fastest car\nhints from 【Evidence】: the fastest refers to max(horsepower); name of the car refers to car_name\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: car refers to data.`car_name`, the fastest refers to MAX(data.`horsepower`), Japan refers to country.`country`\nConnection of tables: includes tables <data> and <country>, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`car_name` \n  FROM data AS T1 \n  INNER JOIN production AS T2 \n  ON T1.`ID` = T2.`ID` \n  INNER JOIN country AS T3 \n  ON T3.`origin` = T2.`country` \n  WHERE T3.`country` = 'Japan' \n  ORDER BY T1.`horsepower` DESC LIMIT 1\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`chronname`: The column 'chronname' in Table <institution_details> has column descriptions of \"Institution name\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \n【Evidence】\nnumber of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the chronname of institutions with number of students greater than the 90% of average number of students of all institutions?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: List the chroname of institutions with number of students greater than the 90% of average number of students of all institutions?\nTargets for `SELECT`: the chroname of institutions\nhints from 【Evidence】: number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the chronname of institutions refers to institution_details.`chronname`, number of students refers to institution_details.`student_count`\nConnection of tables: include only one table <institution_details>, no connection\nFinal SQL:\n```sql\nSELECT DISTINCT `chroname`\n  FROM institution_details\n  WHERE `student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details\n  ) \n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\n\n【Evidence】\nMagnet schools or offer a magnet program means that Magnet = 1\n【Question】\nAmong the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 80, "cur_total_response_tokens": 80}
{"idx": 6, "db_id": "california_schools", "query": "Among the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.", "evidence": "Magnet schools or offer a magnet program means that Magnet = 1", "difficulty": "simple", "ground_truth": "SELECT T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Magnet = 1 AND T1.NumTstTakr > 500", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nMagnet schools or offer a magnet program means that Magnet = 1\n【Query】\n-- Among the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 90, "cur_total_response_tokens": 90}
{"idx": 6, "db_id": "california_schools", "query": "Among the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.", "evidence": "Magnet schools or offer a magnet program means that Magnet = 1", "difficulty": "simple", "ground_truth": "SELECT T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Magnet = 1 AND T1.NumTstTakr > 500", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nMagnet schools or offer a magnet program means that Magnet = 1\n【Query】\n-- Among the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 100, "cur_total_response_tokens": 100}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Soft_Schema_Linker", "response": "\n你好\n", "input_prompt": "As an experienced and professional database administrator, your task is to analyze a user question and a database schema to provide relevant information. The database schema consists of table descriptions, each containing multiple column descriptions. Your goal is to extract the entities from question and identify the relevant tables and columns based on these entities and the evidence provided.\n\n[Instruction]:\n1. Extract the mentioned entities from the user question. Make sure all of the entities are extracted. \n2. For each entity, keep at least 3 related columns.\n4. Your output should include entity extraction, analysis and related database schema.\n5. The related database schema should be in JSON format.\n6. Each column's information in provided 【Schema】 is in this format: (column, description. Value examples<optional>)\n\n[Requirements]:\n1. Sort the related columns in each list corresponding to each entity in descending order of relevance.\n2. The chosen columns should be in this format: <table.column>.\n3. Make sure each chosen list is not empty. The value [] will be punished. \n4.【Matched values】 may contain redundant or useless information in addition to the correct matching values, so you need to select the useful information in conjunction with the specific column names and descriptions.\n5. An entity may not have a corresponding evidence, which requires you to find the relevant columns yourself through your understanding of the database schema.\n\nHere is a typical example:\n\n==========\n【DB_ID】 banking_system\n【Schema】\n# Table: account\n[\n  (account_id <INTEGER>, the id of the account. Value examples: [11382, 11362, 2, 1, 2367].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (frequency <TEXT>, frequency of the acount. Value examples: ['POPLATEK MESICNE', 'POPLATEK TYDNE', 'POPLATEK PO OBRATU'].),\n  (date <DATE>, the creation date of the account. Value examples: ['1997-12-29', '1997-12-28'].)\n]\n# Table: client\n[\n  (client_id <INTEGER>, the unique number. Value examples: [13998, 13971, 2, 1, 2839].),\n  (gender <TEXT>, gender. Value examples: ['M', 'F']. And F：female . M：male ),\n  (birth_date <DATE>, birth date. Value examples: ['1987-09-27', '1986-08-13'].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (first_name <TEXT>, first_name.),\n  (last_name <TEXT>, last_name.)\n]\n# Table: loan\n[\n  (loan_id <INTEGER>, the id number identifying the loan data. Value examples: [4959, 4960, 4961].),\n  (account_id <INTEGER>, the id number identifying the account. Value examples: [10, 80, 55, 43].),\n  (date <DATE>, the date when the loan is approved. Value examples: ['1998-07-12', '1998-04-19'].),\n  (amount <INTEGER>, the id number identifying the loan data. Value examples: [1567, 7877, 9988].),\n  (duration <INTEGER>, the id number identifying the loan data. Value examples: [60, 48, 24, 12, 36].),\n  (payments <INTEGER>, the id number identifying the loan data. Value examples: [3456, 8972, 9845].),\n  (status <TEXT>, the id number identifying the loan data. Value examples: ['C', 'A', 'D', 'B'].)\n]\n# Table: district\n[\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76].),\n  (A2 <REAL>, area in square kilometers. Value examples: [50.5, 48.9].),\n  (A4 <INTEGER>, number of inhabitants. Value examples: [95907, 95616].),\n  (A5 <INTEGER>, number of households. Value examples: [35678, 34892].),\n  (A6 <REAL>, literacy rate. Value examples: [95.6, 92.3, 89.7].),\n  (A7 <INTEGER>, number of entrepreneurs. Value examples: [1234, 1456].),\n  (A8 <INTEGERt>, number of cities. Value examples: [5, 4].),\n  (A9 <INTEGER>, number of schools. Value examples: [15, 12, 10].),\n  (A10 <INTEGER>, number of hospitals. Value examples: [8, 6, 4].),\n  (A11 <REAL>, average salary. Value examples: [12541.5, 11277].),\n  (A12 <REAL>, poverty rate. Value examples: [12.4, 9.8].),\n  (A13 <REAL>, unemployment rate. Value examples: [8.2, 7.9].),\n  (A15 <INTEGER>, number of crimes. Value examples: [256, 189].)\n]\n【Primary keys】\naccount.`account_id` | client.`client_id` | loan.`loan_id` | district.`district_id`\n【Foreign keys】\nclient.`district_id` = district.`district_id`\n【Question】\nWhat is the gender of the youngest client who opened account in the lowest average salary branch and when did this client open the account? Please list their full name.\n【Evidence】\nLater birthdate refers to younger age; A11 refers to average salary; Full name refers to first_name, last_name\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\nThe entities extracted from the 【Question】 are: \n1. gender; \n2. youngest client; \n3. account; \n4. lowest average salary branch; \n5. when did this client open the account; \n6. full name\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. gender --no related evidence **the columns about gender are related**\n2. youngest client  --Later birthdate refers to younger age; **the columns about birth date of client and the id of client are related**\n3. account --no related evidence **the columns about account or account ids are related**\n4. lowest average salary branch  --A11 refers to average salary **the columns about average salary and branch are related**\n5. when did this client open the account --no related evidence **the columns about time or date of the account are related**\n6. full name  --Full name refers to first_name, last_name **the columns about first_name, last_name of the client are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"gender\": [\"client.gender\",\"client.client_id\",\"loan.status\"],\n  \"youngest client\": [\"client.birth_date\",\"client.client_id\",\"account.date\",\"loan.date\"],\n  \"account\": [\"account.account_id\",\"loan.account_id\",\"account.date\"],\n  \"lowest average salary branch\": [\"district.A11\",\"district.district_id\",\"district.A13\"],\n  \"when did this client open the account\": [\"account.date\",\"loan.date\",\"client.birth_date\"],\n  \"full name\": [\"client.first_name\",\"client.last_name\",\"client.client_id\"]\n}\n```\nQuestion Solved.\n\n==========\n\nHere is a new example, please start answering:\n\n【DB_ID】 california_schools\n【Schema】\n# Table: frpm\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (Academic Year <TEXT>,  Academic Year. Value examples: ['2014-2015'].),\n  (County Code <TEXT>,  County Code. Value examples: ['19', '37', '30', '36', '33', '43'].),\n  (District Code <INTEGER>,  District Code.),\n  (School Code <TEXT>,  School Code. Value examples: ['0000000', '9010745', '6121081', '6121073', '6121016', '6120968'].),\n  (County Name <TEXT>,  County Name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].),\n  (District Name <TEXT>,  District Name.),\n  (School Name <TEXT>,  School Name.),\n  (District Type <TEXT>,  District Type. Value examples: ['Unified School District', 'Elementary School District', 'High School District', 'County Office of Education (COE)', 'State Board of Education', 'Statewide Benefit Charter'].),\n  (School Type <TEXT>,  School Type. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].),\n  (Educational Option Type <TEXT>,  Educational Option Type. Value examples: [None, 'Traditional', 'Continuation School', 'Alternative School of Choice', 'Community Day School', 'Special Education School', 'County Community School'].),\n  (NSLP Provision Status <TEXT>,  NSLP Provision Status. Value examples: [None, 'Provision 2', 'Breakfast Provision 2', 'CEP', 'Multiple Provision Types', 'Provision 1', 'Lunch Provision 2'].),\n  (Charter School (Y/N) <INTEGER>,  Charter School (Y/N). Value examples: [None, 0, 1].),\n  (Charter School Number <TEXT>,  Charter School Number. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1700', '1696'].),\n  (Charter Funding Type <TEXT>,  Charter Funding Type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (IRC <INTEGER>,  IRC. Value examples: [None, 0, 1].),\n  (Low Grade <TEXT>,  Low Grade. Value examples: ['K', '9', '6', '7', 'P', '5'].),\n  (High Grade <TEXT>,  High Grade. Value examples: ['12', '5', '8', '6', '3', '4'].),\n  (Enrollment (K-12) <REAL>,  Enrollment (K-12).),\n  (Free Meal Count (K-12) <REAL>,  Free Meal Count (K-12).),\n  (Percent (%) Eligible Free (K-12) <REAL>,  Percent (%) Eligible Free (K-12).),\n  (FRPM Count (K-12) <REAL>,  Free or Reduced Price Meal Count (K-12).),\n  (Percent (%) Eligible FRPM (K-12) <REAL>,  Percent (%) Eligible FRPM (K-12).),\n  (Enrollment (Ages 5-17) <REAL>,  Enrollment (Ages 5-17).),\n  (Free Meal Count (Ages 5-17) <REAL>,  Free Meal Count (Ages 5-17).),\n  (Percent (%) Eligible Free (Ages 5-17) <REAL>,  Percent (%) Eligible Free (Ages 5-17).),\n  (FRPM Count (Ages 5-17) <REAL>,  FRPM Count (Ages 5-17).),\n  (Percent (%) Eligible FRPM (Ages 5-17) <REAL>,  Percent (%) Eligible FRPM (Ages 5-17).),\n  (2013-14 CALPADS Fall 1 Certification Status <INTEGER>,  2013-14 CALPADS Fall 1 Certification Status. Value examples: [1].)\n]\n# Table: satscores\n[\n  (cds <TEXT>,  California Department Schools.),\n  (rtype <TEXT>,  rtype. Value examples: ['S', 'D'].),\n  (sname <TEXT>,  school name. Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].),\n  (dname <TEXT>,  district segment. Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].),\n  (cname <TEXT>,  county name. Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].),\n  (enroll12 <INTEGER>,  enrollment (1st-12nd grade).),\n  (NumTstTakr <INTEGER>,  Number of Test Takers in this school.),\n  (AvgScrRead <INTEGER>,  average scores in Reading.),\n  (AvgScrMath <INTEGER>,  average scores in Math.),\n  (AvgScrWrite <INTEGER>,  average scores in writing.),\n  (NumGE1500 <INTEGER>,  Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500.)\n]\n# Table: schools\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (NCESDist <TEXT>,  This field represents the 7-digit National Center for Educational Statistics (NCES) school district identification number. The first 2 digits identify the state and the last 5 digits identify the school district. Combined, they make a unique 7-digit ID for each school district.. Value examples: [None, '0622710', '0634320', '0628050', '0634410', '0614550', '0633840'].),\n  (NCESSchool <TEXT>,  This field represents the 5-digit NCES school identification number. The NCESSchool combined with the NCESDist form a unique 12-digit ID for each school.. Value examples: [None, '12271', '13785', '13747', '12909', '12311', '12003'].),\n  (StatusType <TEXT>,  This field identifies the status of the district.. Value examples: ['Active', 'Closed', 'Merged', 'Pending'].),\n  (County <TEXT>,  County name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].),\n  (District <TEXT>,  District.),\n  (School <TEXT>,  School.),\n  (Street <TEXT>,  Street.),\n  (StreetAbr <TEXT>,  The abbreviated street address of the school, district, or administrative authority’s physical location..),\n  (City <TEXT>,  City. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].),\n  (Zip <TEXT>,  Zip. Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].),\n  (State <TEXT>,  State. Value examples: [None, 'CA'].),\n  (MailStreet <TEXT>,  MailStreet.),\n  (MailStrAbr <TEXT>,  mailing street address.),\n  (MailCity <TEXT>,  mailing city. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].),\n  (MailZip <TEXT>,  mailing zip. Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].),\n  (MailState <TEXT>,  mailing state. Value examples: [None, 'CA'].),\n  (Phone <TEXT>,  Phone. Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].),\n  (Ext <TEXT>,  The phone number extension of the school, district, or administrative authority.. Value examples: [None, '200', '201', '111', '352', '221', '203'].),\n  (Website <TEXT>,  The website address of the school, district, or administrative authority..),\n  (OpenDate <DATE>,  The date the school opened.. Value examples: [None, '1980-07-01'].),\n  (ClosedDate <DATE>,  The date the school closed.. Value examples: [None, '1989-06-30'].),\n  (Charter <INTEGER>,  This field identifies a charter school.. Value examples: [None, 0, 1].),\n  (CharterNum <TEXT>,  The charter school number,. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1826', '1710'].),\n  (FundingType <TEXT>,  Indicates the charter school funding type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (DOC <TEXT>,  District Ownership Code. Value examples: ['54', '52', '00', '56', '98', '02'].),\n  (DOCType <TEXT>,  The District Ownership Code Type is the text description of the DOC category.. Value examples: ['Unified School District', 'Elementary School District', 'County Office of Education (COE)', 'High School District', 'Regional Occupation Center/Program (ROC/P)', 'State Board of Education'].),\n  (SOC <TEXT>,  The School Ownership Code is a numeric code used to identify the type of school.. Value examples: [None, '60', '66', '62', '68', '09', '69'].),\n  (SOCType <TEXT>,  The School Ownership Code Type is the text description of the type of school.. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Special Education Schools (Public)', 'District Community Day Schools'].),\n  (EdOpsCode <TEXT>,  The Education Option Code is a short text description of the type of education offered.. Value examples: [None, 'TRAD', 'CON', 'COMMDAY', 'ALTSOC', 'SPEC', 'COMM'].),\n  (EdOpsName <TEXT>,  Educational Option Name. Value examples: [None, 'Traditional', 'Continuation School', 'Community Day School', 'Alternative School of Choice', 'Special Education School', 'County Community School'].),\n  (EILCode <TEXT>,  The Educational Instruction Level Code is a short text description of the institution's type relative to the grade range served.. Value examples: [None, 'ELEM', 'HS', 'UG', 'INTMIDJR', 'ELEMHIGH', 'A'].),\n  (EILName <TEXT>,  The Educational Instruction Level Name is the long text description of the institution’s type relative to the grade range served.. Value examples: [None, 'Elementary', 'High School', 'Ungraded', 'Intermediate/Middle/Junior High', 'Elementary-High Combination', 'Adult'].),\n  (GSoffered <TEXT>,  The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.. Value examples: [None, 'K-5', '9-12', 'K-6', 'K-8', '6-8', 'K-12'].),\n  (GSserved <TEXT>,  It is the lowest grade and the highest grade of student enrollment as reported in the most recent certified CALPADS Fall 1 data collection. Only K–12 enrollment is reported through CALPADS. This field may differ from the grade span offered.. Value examples: [None, 'K-5', 'K-6', '9-12', 'K-8', '6-8', '7-8'].),\n  (Virtual <TEXT>,  This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.. Value examples: [None, 'N', 'P', 'F'].),\n  (Magnet <INTEGER>,  This field identifies whether a school is a magnet school and/or provides a magnet program.. Value examples: [None, 0, 1].),\n  (Latitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the equator measured north to south..),\n  (Longitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the prime meridian (Greenwich, England) measured from west to east..),\n  (AdmFName1 <TEXT>,  administrator's first name 1. Value examples: [None, 'David', 'Michael', 'John', 'Jennifer', 'Lisa', 'Robert'].),\n  (AdmLName1 <TEXT>,  administrator's last name 1.),\n  (AdmEmail1 <TEXT>,  administrator's email address 1.),\n  (AdmFName2 <TEXT>,  administrator's first name 2. Value examples: [None, 'Steve', 'Delphine', 'Tim', 'Michael', 'Lisa', 'Jeff'].),\n  (AdmLName2 <TEXT>,  administrator's last name 2. Value examples: [None, 'Sherman', 'Jones', 'Wilson', 'Petersen', 'Landry', 'Hambright'].),\n  (AdmEmail2 <TEXT>,  administrator's email address 2.),\n  (AdmFName3 <TEXT>,  administrator's first name 3. Value examples: [None, 'Mark', 'Eric', 'Vickie', 'Tracie', 'Shawn', 'Sarah'].),\n  (AdmLName3 <TEXT>,  administrator's last name 3. Value examples: [None, 'Zerpoli', 'Yount', 'Woodruff', 'Wood', 'Wolk', 'Spotts'].),\n  (AdmEmail3 <TEXT>,  administrator's email address 3.),\n  (LastUpdate <DATE>,  Last Update. Value examples: ['2015-06-18'].)\n]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Question】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 10, "cur_total_response_tokens": 10}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Decomposer", "response": "\n你好\n", "input_prompt": "[Instruction]\nGiven a 【query】, you need to understanding the intent of Query, and then deceompose it into Targets and Conditions. Then you need to combine Targets and Conditions into Subquerys step by step. \nFor the case where Conditions is NULL, consider Targets as the final Subquery directly. \nFor the case where Conditions are not NULL, combine Targets and the first Condition to get the first Subquery, then combine this Subquery and the next Condition into a new Subquery until all Conditions are used (which means the content of the last Subquery and the original Query is the same).\n\n[Requirements]\n-Try not to overlap Targets and Conditions.\n-Make sure the decomposed Target and Condition can cover all of the information in Query.\n-Don't change any information (specific value) in Query!\n-Mark each Subquery with ## in front of it.\n\nHere are some examples:\n==========\n\n【Query】\nShow the stadium name and the number of concerts in each stadium. Please also list the year the stadium was built. \n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the stadium name, the year the stadium built and the number of concerts in each stadium\nConditions: NULL\n\nSubqueries:\n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the stadium name, the year the stadium built and the number of concerts in each stadium\n==========\n\n【Query】\nWhat is the qualification rate for the H-11 products produced in 2023/11/2?\n【Evidence】\nqualification rate = `Numqualified(H-11)` / `production(H-11)`\n\n【Decomposition】\nTargets: List the qualification rate for the H-11 Products\nConditions:\n1. produced in 2023/11/2 --Condition_1\n\nSubqueries:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the qualification rate for the H-11 Products produced in 2023/11/2\n\n==========\n\n【Query】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n\n【Decomposition】\nTargets: List the race of institutions\nConditions: \n1. in Alabama --Condition_1\n2. number of students greater than the 90% of average number of students of all institutions --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the race of institution in Alabama\n2. Conbine the first Subquery and Conditon_2 to get the seconed Subquery.\n##Subquery: List the race of institutions in Alabama with number of number of students greater than the 90% of average number of students of all institutions\n\n==========\n\n【Query】\nWhich president got a higher approval rating, Joseph Biden or Donald Trump?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\nConditions: \nNULL\n\nSubqueries: \n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\n\n==========\n\n【Query】\nFor movie id 1269, how many users, who was a paying subscriber and was eligible for trial when he rated the movie, gave the movie a rating score of less than or equal to 2?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the number of users\nConditions:\n1. was a paying subscriber --Condition_1\n2. was eligible for trial --Condition_2\n3. for movie id 1269, gave the movie a rating score of less than or equal to 2 --Condition3\n\nSubquerys:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the number of users who was a paying subscriber\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial\n3. Combine the second Subquery and Condition_3 to get the third Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial and gave the movie whose id is 1269 a rating score of less than or equal to 2\n\n==========\n\nHere is a new query need to be decomposed:\n\n【Query】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n\n【Decomposition】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 20, "cur_total_response_tokens": 20}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Generator", "response": "\n你好\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】and a 【Question】, you need to use valid SQLite and understand the database and knowledge so that you can generate a good SQL for the 【Question】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# stadium: [Stadium_ID (INTEGER), Location (TEXT), Name (TEXT)]\n# concert: [concert_ID (INTEGER), concert_Name (TEXT), Stadium_ID (INTEGER)]\n【Primary keys】\nstadium.`Stadium_ID` | concert.`concert_ID`\n【Foreign keys】\nconcert.`Stadium_ID` = stadium.`Stadium_ID`\n【Detailed descriptions of tables and columns】\nstadium.`Stadium_ID`: The column 'Stadium_ID' in Table <stadium> has column descriptions of \"stadium id\". Value examples: [1, 2, 3, 4, 5, 6].\nstadium.`Name`:  The column 'Name' in Table <stadium> has column descriptions of \"name of stadium\". Value examples: [\"Stark's Park\", 'Somerset Park', 'Recreation Park', 'Hampden Park', 'Glebe Park', 'Gayfield Park'].\nstadium.`Location`: The column 'Location' in Table <stadium> has column descriptions of \"location of stadium\". Value examples: ['Stirling Albion', 'Raith Rovers', \"Queen's Park\", 'Peterhead', 'East Fife', 'Brechin City'].\nconcert.`concert_ID`: The column 'concert_ID' in Table <concert> has column descriptions of \"concert id\". Value examples: [1, 2, 3, 4, 5, 6].\nconcert.`concert_Name`: The column 'concert_Name' in Table <concert> has column descriptions of \"concert name\". Value examples: ['Week 1', 'Week 2', 'Super bootcamp', 'Home Visits', 'Auditions'].\nconcert.`Stadium_ID`: The column 'Stadium_ID' in Table <concert> has column descriptions of \"stadium id\". Value examples: [2, 9, 7, 10, 1].\n【Evidence】\nNULL\n【Question】\nShow the stadium name and the number of concerts in each stadium.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: Show the stadium name and the number of concerts in each stadium.\nTargets for `SELECT`: the stadium name and the number of concerts\nhints from 【Evidence】:NULL\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the stadium name refers to stadium.`Name`, the number of concerts refers to COUNT(concert.`concert_ID`), each stadium refers to stadium.`Stadium_ID`\nConnection of tables: include tables <stadium> and <concert>, get connected keys from 【Foreign keys】: concert.`Stadium_ID` = stadium.`Stadium_ID`\nFinal SQL:\n```sql\nSELECT T1.`Name`, COUNT(T2.concert_ID) AS num_concerts\n  FROM stadium AS T1\n  JOIN concert AS T2\n  ON T1.`Stadium_ID` = T2.`Stadium_ID`\n  GROUP BY T1.`Stadium_ID`\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); name of the car refers to car_name\n【Question】\nWhat is the fastest car made by Japan?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ncountry.`country` = 'Japan'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: What is the fastest car made by Japan?\nTargets for `SELECT`: the name of the fastest car\nhints from 【Evidence】: the fastest refers to max(horsepower); name of the car refers to car_name\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: car refers to data.`car_name`, the fastest refers to MAX(data.`horsepower`), Japan refers to country.`country`\nConnection of tables: includes tables <data> and <country>, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`car_name` \n  FROM data AS T1 \n  INNER JOIN production AS T2 \n  ON T1.`ID` = T2.`ID` \n  INNER JOIN country AS T3 \n  ON T3.`origin` = T2.`country` \n  WHERE T3.`country` = 'Japan' \n  ORDER BY T1.`horsepower` DESC LIMIT 1\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`chronname`: The column 'chronname' in Table <institution_details> has column descriptions of \"Institution name\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \n【Evidence】\nnumber of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the chronname of institutions with number of students greater than the 90% of average number of students of all institutions?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: List the chroname of institutions with number of students greater than the 90% of average number of students of all institutions?\nTargets for `SELECT`: the chroname of institutions\nhints from 【Evidence】: number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the chronname of institutions refers to institution_details.`chronname`, number of students refers to institution_details.`student_count`\nConnection of tables: include only one table <institution_details>, no connection\nFinal SQL:\n```sql\nSELECT DISTINCT `chroname`\n  FROM institution_details\n  WHERE `student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details\n  ) \n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Question】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 30, "cur_total_response_tokens": 30}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Query】\n-- How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 40, "cur_total_response_tokens": 40}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Query】\n-- How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 50, "cur_total_response_tokens": 50}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Soft_Schema_Linker", "response": "\n你好\n", "input_prompt": "As an experienced and professional database administrator, your task is to analyze a user question and a database schema to provide relevant information. The database schema consists of table descriptions, each containing multiple column descriptions. Your goal is to extract the entities from question and identify the relevant tables and columns based on these entities and the evidence provided.\n\n[Instruction]:\n1. Extract the mentioned entities from the user question. Make sure all of the entities are extracted. \n2. For each entity, keep at least 3 related columns.\n4. Your output should include entity extraction, analysis and related database schema.\n5. The related database schema should be in JSON format.\n6. Each column's information in provided 【Schema】 is in this format: (column, description. Value examples<optional>)\n\n[Requirements]:\n1. Sort the related columns in each list corresponding to each entity in descending order of relevance.\n2. The chosen columns should be in this format: <table.column>.\n3. Make sure each chosen list is not empty. The value [] will be punished. \n4.【Matched values】 may contain redundant or useless information in addition to the correct matching values, so you need to select the useful information in conjunction with the specific column names and descriptions.\n5. An entity may not have a corresponding evidence, which requires you to find the relevant columns yourself through your understanding of the database schema.\n\nHere is a typical example:\n\n==========\n【DB_ID】 banking_system\n【Schema】\n# Table: account\n[\n  (account_id <INTEGER>, the id of the account. Value examples: [11382, 11362, 2, 1, 2367].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (frequency <TEXT>, frequency of the acount. Value examples: ['POPLATEK MESICNE', 'POPLATEK TYDNE', 'POPLATEK PO OBRATU'].),\n  (date <DATE>, the creation date of the account. Value examples: ['1997-12-29', '1997-12-28'].)\n]\n# Table: client\n[\n  (client_id <INTEGER>, the unique number. Value examples: [13998, 13971, 2, 1, 2839].),\n  (gender <TEXT>, gender. Value examples: ['M', 'F']. And F：female . M：male ),\n  (birth_date <DATE>, birth date. Value examples: ['1987-09-27', '1986-08-13'].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (first_name <TEXT>, first_name.),\n  (last_name <TEXT>, last_name.)\n]\n# Table: loan\n[\n  (loan_id <INTEGER>, the id number identifying the loan data. Value examples: [4959, 4960, 4961].),\n  (account_id <INTEGER>, the id number identifying the account. Value examples: [10, 80, 55, 43].),\n  (date <DATE>, the date when the loan is approved. Value examples: ['1998-07-12', '1998-04-19'].),\n  (amount <INTEGER>, the id number identifying the loan data. Value examples: [1567, 7877, 9988].),\n  (duration <INTEGER>, the id number identifying the loan data. Value examples: [60, 48, 24, 12, 36].),\n  (payments <INTEGER>, the id number identifying the loan data. Value examples: [3456, 8972, 9845].),\n  (status <TEXT>, the id number identifying the loan data. Value examples: ['C', 'A', 'D', 'B'].)\n]\n# Table: district\n[\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76].),\n  (A2 <REAL>, area in square kilometers. Value examples: [50.5, 48.9].),\n  (A4 <INTEGER>, number of inhabitants. Value examples: [95907, 95616].),\n  (A5 <INTEGER>, number of households. Value examples: [35678, 34892].),\n  (A6 <REAL>, literacy rate. Value examples: [95.6, 92.3, 89.7].),\n  (A7 <INTEGER>, number of entrepreneurs. Value examples: [1234, 1456].),\n  (A8 <INTEGERt>, number of cities. Value examples: [5, 4].),\n  (A9 <INTEGER>, number of schools. Value examples: [15, 12, 10].),\n  (A10 <INTEGER>, number of hospitals. Value examples: [8, 6, 4].),\n  (A11 <REAL>, average salary. Value examples: [12541.5, 11277].),\n  (A12 <REAL>, poverty rate. Value examples: [12.4, 9.8].),\n  (A13 <REAL>, unemployment rate. Value examples: [8.2, 7.9].),\n  (A15 <INTEGER>, number of crimes. Value examples: [256, 189].)\n]\n【Primary keys】\naccount.`account_id` | client.`client_id` | loan.`loan_id` | district.`district_id`\n【Foreign keys】\nclient.`district_id` = district.`district_id`\n【Question】\nWhat is the gender of the youngest client who opened account in the lowest average salary branch and when did this client open the account? Please list their full name.\n【Evidence】\nLater birthdate refers to younger age; A11 refers to average salary; Full name refers to first_name, last_name\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\nThe entities extracted from the 【Question】 are: \n1. gender; \n2. youngest client; \n3. account; \n4. lowest average salary branch; \n5. when did this client open the account; \n6. full name\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. gender --no related evidence **the columns about gender are related**\n2. youngest client  --Later birthdate refers to younger age; **the columns about birth date of client and the id of client are related**\n3. account --no related evidence **the columns about account or account ids are related**\n4. lowest average salary branch  --A11 refers to average salary **the columns about average salary and branch are related**\n5. when did this client open the account --no related evidence **the columns about time or date of the account are related**\n6. full name  --Full name refers to first_name, last_name **the columns about first_name, last_name of the client are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"gender\": [\"client.gender\",\"client.client_id\",\"loan.status\"],\n  \"youngest client\": [\"client.birth_date\",\"client.client_id\",\"account.date\",\"loan.date\"],\n  \"account\": [\"account.account_id\",\"loan.account_id\",\"account.date\"],\n  \"lowest average salary branch\": [\"district.A11\",\"district.district_id\",\"district.A13\"],\n  \"when did this client open the account\": [\"account.date\",\"loan.date\",\"client.birth_date\"],\n  \"full name\": [\"client.first_name\",\"client.last_name\",\"client.client_id\"]\n}\n```\nQuestion Solved.\n\n==========\n\nHere is a new example, please start answering:\n\n【DB_ID】 california_schools\n【Schema】\n# Table: frpm\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (Academic Year <TEXT>,  Academic Year. Value examples: ['2014-2015'].),\n  (County Code <TEXT>,  County Code. Value examples: ['19', '37', '30', '36', '33', '43'].),\n  (District Code <INTEGER>,  District Code.),\n  (School Code <TEXT>,  School Code. Value examples: ['0000000', '9010745', '6121081', '6121073', '6121016', '6120968'].),\n  (County Name <TEXT>,  County Name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].),\n  (District Name <TEXT>,  District Name.),\n  (School Name <TEXT>,  School Name.),\n  (District Type <TEXT>,  District Type. Value examples: ['Unified School District', 'Elementary School District', 'High School District', 'County Office of Education (COE)', 'State Board of Education', 'Statewide Benefit Charter'].),\n  (School Type <TEXT>,  School Type. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].),\n  (Educational Option Type <TEXT>,  Educational Option Type. Value examples: [None, 'Traditional', 'Continuation School', 'Alternative School of Choice', 'Community Day School', 'Special Education School', 'County Community School'].),\n  (NSLP Provision Status <TEXT>,  NSLP Provision Status. Value examples: [None, 'Provision 2', 'Breakfast Provision 2', 'CEP', 'Multiple Provision Types', 'Provision 1', 'Lunch Provision 2'].),\n  (Charter School (Y/N) <INTEGER>,  Charter School (Y/N). Value examples: [None, 0, 1].),\n  (Charter School Number <TEXT>,  Charter School Number. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1700', '1696'].),\n  (Charter Funding Type <TEXT>,  Charter Funding Type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (IRC <INTEGER>,  IRC. Value examples: [None, 0, 1].),\n  (Low Grade <TEXT>,  Low Grade. Value examples: ['K', '9', '6', '7', 'P', '5'].),\n  (High Grade <TEXT>,  High Grade. Value examples: ['12', '5', '8', '6', '3', '4'].),\n  (Enrollment (K-12) <REAL>,  Enrollment (K-12).),\n  (Free Meal Count (K-12) <REAL>,  Free Meal Count (K-12).),\n  (Percent (%) Eligible Free (K-12) <REAL>,  Percent (%) Eligible Free (K-12).),\n  (FRPM Count (K-12) <REAL>,  Free or Reduced Price Meal Count (K-12).),\n  (Percent (%) Eligible FRPM (K-12) <REAL>,  Percent (%) Eligible FRPM (K-12).),\n  (Enrollment (Ages 5-17) <REAL>,  Enrollment (Ages 5-17).),\n  (Free Meal Count (Ages 5-17) <REAL>,  Free Meal Count (Ages 5-17).),\n  (Percent (%) Eligible Free (Ages 5-17) <REAL>,  Percent (%) Eligible Free (Ages 5-17).),\n  (FRPM Count (Ages 5-17) <REAL>,  FRPM Count (Ages 5-17).),\n  (Percent (%) Eligible FRPM (Ages 5-17) <REAL>,  Percent (%) Eligible FRPM (Ages 5-17).),\n  (2013-14 CALPADS Fall 1 Certification Status <INTEGER>,  2013-14 CALPADS Fall 1 Certification Status. Value examples: [1].)\n]\n# Table: satscores\n[\n  (cds <TEXT>,  California Department Schools.),\n  (rtype <TEXT>,  rtype. Value examples: ['S', 'D'].),\n  (sname <TEXT>,  school name. Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].),\n  (dname <TEXT>,  district segment. Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].),\n  (cname <TEXT>,  county name. Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].),\n  (enroll12 <INTEGER>,  enrollment (1st-12nd grade).),\n  (NumTstTakr <INTEGER>,  Number of Test Takers in this school.),\n  (AvgScrRead <INTEGER>,  average scores in Reading.),\n  (AvgScrMath <INTEGER>,  average scores in Math.),\n  (AvgScrWrite <INTEGER>,  average scores in writing.),\n  (NumGE1500 <INTEGER>,  Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500.)\n]\n# Table: schools\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (NCESDist <TEXT>,  This field represents the 7-digit National Center for Educational Statistics (NCES) school district identification number. The first 2 digits identify the state and the last 5 digits identify the school district. Combined, they make a unique 7-digit ID for each school district.. Value examples: [None, '0622710', '0634320', '0628050', '0634410', '0614550', '0633840'].),\n  (NCESSchool <TEXT>,  This field represents the 5-digit NCES school identification number. The NCESSchool combined with the NCESDist form a unique 12-digit ID for each school.. Value examples: [None, '12271', '13785', '13747', '12909', '12311', '12003'].),\n  (StatusType <TEXT>,  This field identifies the status of the district.. Value examples: ['Active', 'Closed', 'Merged', 'Pending'].),\n  (County <TEXT>,  County name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].),\n  (District <TEXT>,  District.),\n  (School <TEXT>,  School.),\n  (Street <TEXT>,  Street.),\n  (StreetAbr <TEXT>,  The abbreviated street address of the school, district, or administrative authority’s physical location..),\n  (City <TEXT>,  City. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].),\n  (Zip <TEXT>,  Zip. Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].),\n  (State <TEXT>,  State. Value examples: [None, 'CA'].),\n  (MailStreet <TEXT>,  MailStreet.),\n  (MailStrAbr <TEXT>,  mailing street address.),\n  (MailCity <TEXT>,  mailing city. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].),\n  (MailZip <TEXT>,  mailing zip. Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].),\n  (MailState <TEXT>,  mailing state. Value examples: [None, 'CA'].),\n  (Phone <TEXT>,  Phone. Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].),\n  (Ext <TEXT>,  The phone number extension of the school, district, or administrative authority.. Value examples: [None, '200', '201', '111', '352', '221', '203'].),\n  (Website <TEXT>,  The website address of the school, district, or administrative authority..),\n  (OpenDate <DATE>,  The date the school opened.. Value examples: [None, '1980-07-01'].),\n  (ClosedDate <DATE>,  The date the school closed.. Value examples: [None, '1989-06-30'].),\n  (Charter <INTEGER>,  This field identifies a charter school.. Value examples: [None, 0, 1].),\n  (CharterNum <TEXT>,  The charter school number,. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1826', '1710'].),\n  (FundingType <TEXT>,  Indicates the charter school funding type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (DOC <TEXT>,  District Ownership Code. Value examples: ['54', '52', '00', '56', '98', '02'].),\n  (DOCType <TEXT>,  The District Ownership Code Type is the text description of the DOC category.. Value examples: ['Unified School District', 'Elementary School District', 'County Office of Education (COE)', 'High School District', 'Regional Occupation Center/Program (ROC/P)', 'State Board of Education'].),\n  (SOC <TEXT>,  The School Ownership Code is a numeric code used to identify the type of school.. Value examples: [None, '60', '66', '62', '68', '09', '69'].),\n  (SOCType <TEXT>,  The School Ownership Code Type is the text description of the type of school.. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Special Education Schools (Public)', 'District Community Day Schools'].),\n  (EdOpsCode <TEXT>,  The Education Option Code is a short text description of the type of education offered.. Value examples: [None, 'TRAD', 'CON', 'COMMDAY', 'ALTSOC', 'SPEC', 'COMM'].),\n  (EdOpsName <TEXT>,  Educational Option Name. Value examples: [None, 'Traditional', 'Continuation School', 'Community Day School', 'Alternative School of Choice', 'Special Education School', 'County Community School'].),\n  (EILCode <TEXT>,  The Educational Instruction Level Code is a short text description of the institution's type relative to the grade range served.. Value examples: [None, 'ELEM', 'HS', 'UG', 'INTMIDJR', 'ELEMHIGH', 'A'].),\n  (EILName <TEXT>,  The Educational Instruction Level Name is the long text description of the institution’s type relative to the grade range served.. Value examples: [None, 'Elementary', 'High School', 'Ungraded', 'Intermediate/Middle/Junior High', 'Elementary-High Combination', 'Adult'].),\n  (GSoffered <TEXT>,  The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.. Value examples: [None, 'K-5', '9-12', 'K-6', 'K-8', '6-8', 'K-12'].),\n  (GSserved <TEXT>,  It is the lowest grade and the highest grade of student enrollment as reported in the most recent certified CALPADS Fall 1 data collection. Only K–12 enrollment is reported through CALPADS. This field may differ from the grade span offered.. Value examples: [None, 'K-5', 'K-6', '9-12', 'K-8', '6-8', '7-8'].),\n  (Virtual <TEXT>,  This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.. Value examples: [None, 'N', 'P', 'F'].),\n  (Magnet <INTEGER>,  This field identifies whether a school is a magnet school and/or provides a magnet program.. Value examples: [None, 0, 1].),\n  (Latitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the equator measured north to south..),\n  (Longitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the prime meridian (Greenwich, England) measured from west to east..),\n  (AdmFName1 <TEXT>,  administrator's first name 1. Value examples: [None, 'David', 'Michael', 'John', 'Jennifer', 'Lisa', 'Robert'].),\n  (AdmLName1 <TEXT>,  administrator's last name 1.),\n  (AdmEmail1 <TEXT>,  administrator's email address 1.),\n  (AdmFName2 <TEXT>,  administrator's first name 2. Value examples: [None, 'Steve', 'Delphine', 'Tim', 'Michael', 'Lisa', 'Jeff'].),\n  (AdmLName2 <TEXT>,  administrator's last name 2. Value examples: [None, 'Sherman', 'Jones', 'Wilson', 'Petersen', 'Landry', 'Hambright'].),\n  (AdmEmail2 <TEXT>,  administrator's email address 2.),\n  (AdmFName3 <TEXT>,  administrator's first name 3. Value examples: [None, 'Mark', 'Eric', 'Vickie', 'Tracie', 'Shawn', 'Sarah'].),\n  (AdmLName3 <TEXT>,  administrator's last name 3. Value examples: [None, 'Zerpoli', 'Yount', 'Woodruff', 'Wood', 'Wolk', 'Spotts'].),\n  (AdmEmail3 <TEXT>,  administrator's email address 3.),\n  (LastUpdate <DATE>,  Last Update. Value examples: ['2015-06-18'].)\n]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Question】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 10, "cur_total_response_tokens": 10}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Decomposer", "response": "\n你好\n", "input_prompt": "[Instruction]\nGiven a 【query】, you need to understanding the intent of Query, and then deceompose it into Targets and Conditions. Then you need to combine Targets and Conditions into Subquerys step by step. \nFor the case where Conditions is NULL, consider Targets as the final Subquery directly. \nFor the case where Conditions are not NULL, combine Targets and the first Condition to get the first Subquery, then combine this Subquery and the next Condition into a new Subquery until all Conditions are used (which means the content of the last Subquery and the original Query is the same).\n\n[Requirements]\n-Try not to overlap Targets and Conditions.\n-Make sure the decomposed Target and Condition can cover all of the information in Query.\n-Don't change any information (specific value) in Query!\n-Mark each Subquery with ## in front of it.\n\nHere are some examples:\n==========\n\n【Query】\nShow the stadium name and the number of concerts in each stadium. Please also list the year the stadium was built. \n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the stadium name, the year the stadium built and the number of concerts in each stadium\nConditions: NULL\n\nSubqueries:\n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the stadium name, the year the stadium built and the number of concerts in each stadium\n==========\n\n【Query】\nWhat is the qualification rate for the H-11 products produced in 2023/11/2?\n【Evidence】\nqualification rate = `Numqualified(H-11)` / `production(H-11)`\n\n【Decomposition】\nTargets: List the qualification rate for the H-11 Products\nConditions:\n1. produced in 2023/11/2 --Condition_1\n\nSubqueries:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the qualification rate for the H-11 Products produced in 2023/11/2\n\n==========\n\n【Query】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n\n【Decomposition】\nTargets: List the race of institutions\nConditions: \n1. in Alabama --Condition_1\n2. number of students greater than the 90% of average number of students of all institutions --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the race of institution in Alabama\n2. Conbine the first Subquery and Conditon_2 to get the seconed Subquery.\n##Subquery: List the race of institutions in Alabama with number of number of students greater than the 90% of average number of students of all institutions\n\n==========\n\n【Query】\nWhich president got a higher approval rating, Joseph Biden or Donald Trump?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\nConditions: \nNULL\n\nSubqueries: \n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\n\n==========\n\n【Query】\nFor movie id 1269, how many users, who was a paying subscriber and was eligible for trial when he rated the movie, gave the movie a rating score of less than or equal to 2?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the number of users\nConditions:\n1. was a paying subscriber --Condition_1\n2. was eligible for trial --Condition_2\n3. for movie id 1269, gave the movie a rating score of less than or equal to 2 --Condition3\n\nSubquerys:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the number of users who was a paying subscriber\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial\n3. Combine the second Subquery and Condition_3 to get the third Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial and gave the movie whose id is 1269 a rating score of less than or equal to 2\n\n==========\n\nHere is a new query need to be decomposed:\n\n【Query】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n\n【Decomposition】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 20, "cur_total_response_tokens": 20}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Generator", "response": "\n你好\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】and a 【Question】, you need to use valid SQLite and understand the database and knowledge so that you can generate a good SQL for the 【Question】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# stadium: [Stadium_ID (INTEGER), Location (TEXT), Name (TEXT)]\n# concert: [concert_ID (INTEGER), concert_Name (TEXT), Stadium_ID (INTEGER)]\n【Primary keys】\nstadium.`Stadium_ID` | concert.`concert_ID`\n【Foreign keys】\nconcert.`Stadium_ID` = stadium.`Stadium_ID`\n【Detailed descriptions of tables and columns】\nstadium.`Stadium_ID`: The column 'Stadium_ID' in Table <stadium> has column descriptions of \"stadium id\". Value examples: [1, 2, 3, 4, 5, 6].\nstadium.`Name`:  The column 'Name' in Table <stadium> has column descriptions of \"name of stadium\". Value examples: [\"Stark's Park\", 'Somerset Park', 'Recreation Park', 'Hampden Park', 'Glebe Park', 'Gayfield Park'].\nstadium.`Location`: The column 'Location' in Table <stadium> has column descriptions of \"location of stadium\". Value examples: ['Stirling Albion', 'Raith Rovers', \"Queen's Park\", 'Peterhead', 'East Fife', 'Brechin City'].\nconcert.`concert_ID`: The column 'concert_ID' in Table <concert> has column descriptions of \"concert id\". Value examples: [1, 2, 3, 4, 5, 6].\nconcert.`concert_Name`: The column 'concert_Name' in Table <concert> has column descriptions of \"concert name\". Value examples: ['Week 1', 'Week 2', 'Super bootcamp', 'Home Visits', 'Auditions'].\nconcert.`Stadium_ID`: The column 'Stadium_ID' in Table <concert> has column descriptions of \"stadium id\". Value examples: [2, 9, 7, 10, 1].\n【Evidence】\nNULL\n【Question】\nShow the stadium name and the number of concerts in each stadium.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: Show the stadium name and the number of concerts in each stadium.\nTargets for `SELECT`: the stadium name and the number of concerts\nhints from 【Evidence】:NULL\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the stadium name refers to stadium.`Name`, the number of concerts refers to COUNT(concert.`concert_ID`), each stadium refers to stadium.`Stadium_ID`\nConnection of tables: include tables <stadium> and <concert>, get connected keys from 【Foreign keys】: concert.`Stadium_ID` = stadium.`Stadium_ID`\nFinal SQL:\n```sql\nSELECT T1.`Name`, COUNT(T2.concert_ID) AS num_concerts\n  FROM stadium AS T1\n  JOIN concert AS T2\n  ON T1.`Stadium_ID` = T2.`Stadium_ID`\n  GROUP BY T1.`Stadium_ID`\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); name of the car refers to car_name\n【Question】\nWhat is the fastest car made by Japan?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ncountry.`country` = 'Japan'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: What is the fastest car made by Japan?\nTargets for `SELECT`: the name of the fastest car\nhints from 【Evidence】: the fastest refers to max(horsepower); name of the car refers to car_name\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: car refers to data.`car_name`, the fastest refers to MAX(data.`horsepower`), Japan refers to country.`country`\nConnection of tables: includes tables <data> and <country>, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`car_name` \n  FROM data AS T1 \n  INNER JOIN production AS T2 \n  ON T1.`ID` = T2.`ID` \n  INNER JOIN country AS T3 \n  ON T3.`origin` = T2.`country` \n  WHERE T3.`country` = 'Japan' \n  ORDER BY T1.`horsepower` DESC LIMIT 1\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`chronname`: The column 'chronname' in Table <institution_details> has column descriptions of \"Institution name\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \n【Evidence】\nnumber of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the chronname of institutions with number of students greater than the 90% of average number of students of all institutions?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: List the chroname of institutions with number of students greater than the 90% of average number of students of all institutions?\nTargets for `SELECT`: the chroname of institutions\nhints from 【Evidence】: number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the chronname of institutions refers to institution_details.`chronname`, number of students refers to institution_details.`student_count`\nConnection of tables: include only one table <institution_details>, no connection\nFinal SQL:\n```sql\nSELECT DISTINCT `chroname`\n  FROM institution_details\n  WHERE `student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details\n  ) \n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Question】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 30, "cur_total_response_tokens": 30}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Query】\n-- How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 40, "cur_total_response_tokens": 40}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Query】\n-- How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 50, "cur_total_response_tokens": 50}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Soft_Schema_Linker", "response": "\n你好\n", "input_prompt": "As an experienced and professional database administrator, your task is to analyze a user question and a database schema to provide relevant information. The database schema consists of table descriptions, each containing multiple column descriptions. Your goal is to extract the entities from question and identify the relevant tables and columns based on these entities and the evidence provided.\n\n[Instruction]:\n1. Extract the mentioned entities from the user question. Make sure all of the entities are extracted. \n2. For each entity, keep at least 3 related columns.\n4. Your output should include entity extraction, analysis and related database schema.\n5. The related database schema should be in JSON format.\n6. Each column's information in provided 【Schema】 is in this format: (column, description. Value examples<optional>)\n\n[Requirements]:\n1. Sort the related columns in each list corresponding to each entity in descending order of relevance.\n2. The chosen columns should be in this format: <table.column>.\n3. Make sure each chosen list is not empty. The value [] will be punished. \n4.【Matched values】 may contain redundant or useless information in addition to the correct matching values, so you need to select the useful information in conjunction with the specific column names and descriptions.\n5. An entity may not have a corresponding evidence, which requires you to find the relevant columns yourself through your understanding of the database schema.\n\nHere is a typical example:\n\n==========\n【DB_ID】 banking_system\n【Schema】\n# Table: account\n[\n  (account_id <INTEGER>, the id of the account. Value examples: [11382, 11362, 2, 1, 2367].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (frequency <TEXT>, frequency of the acount. Value examples: ['POPLATEK MESICNE', 'POPLATEK TYDNE', 'POPLATEK PO OBRATU'].),\n  (date <DATE>, the creation date of the account. Value examples: ['1997-12-29', '1997-12-28'].)\n]\n# Table: client\n[\n  (client_id <INTEGER>, the unique number. Value examples: [13998, 13971, 2, 1, 2839].),\n  (gender <TEXT>, gender. Value examples: ['M', 'F']. And F：female . M：male ),\n  (birth_date <DATE>, birth date. Value examples: ['1987-09-27', '1986-08-13'].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (first_name <TEXT>, first_name.),\n  (last_name <TEXT>, last_name.)\n]\n# Table: loan\n[\n  (loan_id <INTEGER>, the id number identifying the loan data. Value examples: [4959, 4960, 4961].),\n  (account_id <INTEGER>, the id number identifying the account. Value examples: [10, 80, 55, 43].),\n  (date <DATE>, the date when the loan is approved. Value examples: ['1998-07-12', '1998-04-19'].),\n  (amount <INTEGER>, the id number identifying the loan data. Value examples: [1567, 7877, 9988].),\n  (duration <INTEGER>, the id number identifying the loan data. Value examples: [60, 48, 24, 12, 36].),\n  (payments <INTEGER>, the id number identifying the loan data. Value examples: [3456, 8972, 9845].),\n  (status <TEXT>, the id number identifying the loan data. Value examples: ['C', 'A', 'D', 'B'].)\n]\n# Table: district\n[\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76].),\n  (A2 <REAL>, area in square kilometers. Value examples: [50.5, 48.9].),\n  (A4 <INTEGER>, number of inhabitants. Value examples: [95907, 95616].),\n  (A5 <INTEGER>, number of households. Value examples: [35678, 34892].),\n  (A6 <REAL>, literacy rate. Value examples: [95.6, 92.3, 89.7].),\n  (A7 <INTEGER>, number of entrepreneurs. Value examples: [1234, 1456].),\n  (A8 <INTEGERt>, number of cities. Value examples: [5, 4].),\n  (A9 <INTEGER>, number of schools. Value examples: [15, 12, 10].),\n  (A10 <INTEGER>, number of hospitals. Value examples: [8, 6, 4].),\n  (A11 <REAL>, average salary. Value examples: [12541.5, 11277].),\n  (A12 <REAL>, poverty rate. Value examples: [12.4, 9.8].),\n  (A13 <REAL>, unemployment rate. Value examples: [8.2, 7.9].),\n  (A15 <INTEGER>, number of crimes. Value examples: [256, 189].)\n]\n【Primary keys】\naccount.`account_id` | client.`client_id` | loan.`loan_id` | district.`district_id`\n【Foreign keys】\nclient.`district_id` = district.`district_id`\n【Question】\nWhat is the gender of the youngest client who opened account in the lowest average salary branch and when did this client open the account? Please list their full name.\n【Evidence】\nLater birthdate refers to younger age; A11 refers to average salary; Full name refers to first_name, last_name\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\nThe entities extracted from the 【Question】 are: \n1. gender; \n2. youngest client; \n3. account; \n4. lowest average salary branch; \n5. when did this client open the account; \n6. full name\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. gender --no related evidence **the columns about gender are related**\n2. youngest client  --Later birthdate refers to younger age; **the columns about birth date of client and the id of client are related**\n3. account --no related evidence **the columns about account or account ids are related**\n4. lowest average salary branch  --A11 refers to average salary **the columns about average salary and branch are related**\n5. when did this client open the account --no related evidence **the columns about time or date of the account are related**\n6. full name  --Full name refers to first_name, last_name **the columns about first_name, last_name of the client are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"gender\": [\"client.gender\",\"client.client_id\",\"loan.status\"],\n  \"youngest client\": [\"client.birth_date\",\"client.client_id\",\"account.date\",\"loan.date\"],\n  \"account\": [\"account.account_id\",\"loan.account_id\",\"account.date\"],\n  \"lowest average salary branch\": [\"district.A11\",\"district.district_id\",\"district.A13\"],\n  \"when did this client open the account\": [\"account.date\",\"loan.date\",\"client.birth_date\"],\n  \"full name\": [\"client.first_name\",\"client.last_name\",\"client.client_id\"]\n}\n```\nQuestion Solved.\n\n==========\n\nHere is a new example, please start answering:\n\n【DB_ID】 california_schools\n【Schema】\n# Table: frpm\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (Academic Year <TEXT>,  Academic Year. Value examples: ['2014-2015'].),\n  (County Code <TEXT>,  County Code. Value examples: ['19', '37', '30', '36', '33', '43'].),\n  (District Code <INTEGER>,  District Code.),\n  (School Code <TEXT>,  School Code. Value examples: ['0000000', '9010745', '6121081', '6121073', '6121016', '6120968'].),\n  (County Name <TEXT>,  County Name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].),\n  (District Name <TEXT>,  District Name.),\n  (School Name <TEXT>,  School Name.),\n  (District Type <TEXT>,  District Type. Value examples: ['Unified School District', 'Elementary School District', 'High School District', 'County Office of Education (COE)', 'State Board of Education', 'Statewide Benefit Charter'].),\n  (School Type <TEXT>,  School Type. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].),\n  (Educational Option Type <TEXT>,  Educational Option Type. Value examples: [None, 'Traditional', 'Continuation School', 'Alternative School of Choice', 'Community Day School', 'Special Education School', 'County Community School'].),\n  (NSLP Provision Status <TEXT>,  NSLP Provision Status. Value examples: [None, 'Provision 2', 'Breakfast Provision 2', 'CEP', 'Multiple Provision Types', 'Provision 1', 'Lunch Provision 2'].),\n  (Charter School (Y/N) <INTEGER>,  Charter School (Y/N). Value examples: [None, 0, 1].),\n  (Charter School Number <TEXT>,  Charter School Number. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1700', '1696'].),\n  (Charter Funding Type <TEXT>,  Charter Funding Type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (IRC <INTEGER>,  IRC. Value examples: [None, 0, 1].),\n  (Low Grade <TEXT>,  Low Grade. Value examples: ['K', '9', '6', '7', 'P', '5'].),\n  (High Grade <TEXT>,  High Grade. Value examples: ['12', '5', '8', '6', '3', '4'].),\n  (Enrollment (K-12) <REAL>,  Enrollment (K-12).),\n  (Free Meal Count (K-12) <REAL>,  Free Meal Count (K-12).),\n  (Percent (%) Eligible Free (K-12) <REAL>,  Percent (%) Eligible Free (K-12).),\n  (FRPM Count (K-12) <REAL>,  Free or Reduced Price Meal Count (K-12).),\n  (Percent (%) Eligible FRPM (K-12) <REAL>,  Percent (%) Eligible FRPM (K-12).),\n  (Enrollment (Ages 5-17) <REAL>,  Enrollment (Ages 5-17).),\n  (Free Meal Count (Ages 5-17) <REAL>,  Free Meal Count (Ages 5-17).),\n  (Percent (%) Eligible Free (Ages 5-17) <REAL>,  Percent (%) Eligible Free (Ages 5-17).),\n  (FRPM Count (Ages 5-17) <REAL>,  FRPM Count (Ages 5-17).),\n  (Percent (%) Eligible FRPM (Ages 5-17) <REAL>,  Percent (%) Eligible FRPM (Ages 5-17).),\n  (2013-14 CALPADS Fall 1 Certification Status <INTEGER>,  2013-14 CALPADS Fall 1 Certification Status. Value examples: [1].)\n]\n# Table: satscores\n[\n  (cds <TEXT>,  California Department Schools.),\n  (rtype <TEXT>,  rtype. Value examples: ['S', 'D'].),\n  (sname <TEXT>,  school name. Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].),\n  (dname <TEXT>,  district segment. Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].),\n  (cname <TEXT>,  county name. Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].),\n  (enroll12 <INTEGER>,  enrollment (1st-12nd grade).),\n  (NumTstTakr <INTEGER>,  Number of Test Takers in this school.),\n  (AvgScrRead <INTEGER>,  average scores in Reading.),\n  (AvgScrMath <INTEGER>,  average scores in Math.),\n  (AvgScrWrite <INTEGER>,  average scores in writing.),\n  (NumGE1500 <INTEGER>,  Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500.)\n]\n# Table: schools\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (NCESDist <TEXT>,  This field represents the 7-digit National Center for Educational Statistics (NCES) school district identification number. The first 2 digits identify the state and the last 5 digits identify the school district. Combined, they make a unique 7-digit ID for each school district.. Value examples: [None, '0622710', '0634320', '0628050', '0634410', '0614550', '0633840'].),\n  (NCESSchool <TEXT>,  This field represents the 5-digit NCES school identification number. The NCESSchool combined with the NCESDist form a unique 12-digit ID for each school.. Value examples: [None, '12271', '13785', '13747', '12909', '12311', '12003'].),\n  (StatusType <TEXT>,  This field identifies the status of the district.. Value examples: ['Active', 'Closed', 'Merged', 'Pending'].),\n  (County <TEXT>,  County name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].),\n  (District <TEXT>,  District.),\n  (School <TEXT>,  School.),\n  (Street <TEXT>,  Street.),\n  (StreetAbr <TEXT>,  The abbreviated street address of the school, district, or administrative authority’s physical location..),\n  (City <TEXT>,  City. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].),\n  (Zip <TEXT>,  Zip. Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].),\n  (State <TEXT>,  State. Value examples: [None, 'CA'].),\n  (MailStreet <TEXT>,  MailStreet.),\n  (MailStrAbr <TEXT>,  mailing street address.),\n  (MailCity <TEXT>,  mailing city. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].),\n  (MailZip <TEXT>,  mailing zip. Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].),\n  (MailState <TEXT>,  mailing state. Value examples: [None, 'CA'].),\n  (Phone <TEXT>,  Phone. Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].),\n  (Ext <TEXT>,  The phone number extension of the school, district, or administrative authority.. Value examples: [None, '200', '201', '111', '352', '221', '203'].),\n  (Website <TEXT>,  The website address of the school, district, or administrative authority..),\n  (OpenDate <DATE>,  The date the school opened.. Value examples: [None, '1980-07-01'].),\n  (ClosedDate <DATE>,  The date the school closed.. Value examples: [None, '1989-06-30'].),\n  (Charter <INTEGER>,  This field identifies a charter school.. Value examples: [None, 0, 1].),\n  (CharterNum <TEXT>,  The charter school number,. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1826', '1710'].),\n  (FundingType <TEXT>,  Indicates the charter school funding type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (DOC <TEXT>,  District Ownership Code. Value examples: ['54', '52', '00', '56', '98', '02'].),\n  (DOCType <TEXT>,  The District Ownership Code Type is the text description of the DOC category.. Value examples: ['Unified School District', 'Elementary School District', 'County Office of Education (COE)', 'High School District', 'Regional Occupation Center/Program (ROC/P)', 'State Board of Education'].),\n  (SOC <TEXT>,  The School Ownership Code is a numeric code used to identify the type of school.. Value examples: [None, '60', '66', '62', '68', '09', '69'].),\n  (SOCType <TEXT>,  The School Ownership Code Type is the text description of the type of school.. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Special Education Schools (Public)', 'District Community Day Schools'].),\n  (EdOpsCode <TEXT>,  The Education Option Code is a short text description of the type of education offered.. Value examples: [None, 'TRAD', 'CON', 'COMMDAY', 'ALTSOC', 'SPEC', 'COMM'].),\n  (EdOpsName <TEXT>,  Educational Option Name. Value examples: [None, 'Traditional', 'Continuation School', 'Community Day School', 'Alternative School of Choice', 'Special Education School', 'County Community School'].),\n  (EILCode <TEXT>,  The Educational Instruction Level Code is a short text description of the institution's type relative to the grade range served.. Value examples: [None, 'ELEM', 'HS', 'UG', 'INTMIDJR', 'ELEMHIGH', 'A'].),\n  (EILName <TEXT>,  The Educational Instruction Level Name is the long text description of the institution’s type relative to the grade range served.. Value examples: [None, 'Elementary', 'High School', 'Ungraded', 'Intermediate/Middle/Junior High', 'Elementary-High Combination', 'Adult'].),\n  (GSoffered <TEXT>,  The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.. Value examples: [None, 'K-5', '9-12', 'K-6', 'K-8', '6-8', 'K-12'].),\n  (GSserved <TEXT>,  It is the lowest grade and the highest grade of student enrollment as reported in the most recent certified CALPADS Fall 1 data collection. Only K–12 enrollment is reported through CALPADS. This field may differ from the grade span offered.. Value examples: [None, 'K-5', 'K-6', '9-12', 'K-8', '6-8', '7-8'].),\n  (Virtual <TEXT>,  This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.. Value examples: [None, 'N', 'P', 'F'].),\n  (Magnet <INTEGER>,  This field identifies whether a school is a magnet school and/or provides a magnet program.. Value examples: [None, 0, 1].),\n  (Latitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the equator measured north to south..),\n  (Longitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the prime meridian (Greenwich, England) measured from west to east..),\n  (AdmFName1 <TEXT>,  administrator's first name 1. Value examples: [None, 'David', 'Michael', 'John', 'Jennifer', 'Lisa', 'Robert'].),\n  (AdmLName1 <TEXT>,  administrator's last name 1.),\n  (AdmEmail1 <TEXT>,  administrator's email address 1.),\n  (AdmFName2 <TEXT>,  administrator's first name 2. Value examples: [None, 'Steve', 'Delphine', 'Tim', 'Michael', 'Lisa', 'Jeff'].),\n  (AdmLName2 <TEXT>,  administrator's last name 2. Value examples: [None, 'Sherman', 'Jones', 'Wilson', 'Petersen', 'Landry', 'Hambright'].),\n  (AdmEmail2 <TEXT>,  administrator's email address 2.),\n  (AdmFName3 <TEXT>,  administrator's first name 3. Value examples: [None, 'Mark', 'Eric', 'Vickie', 'Tracie', 'Shawn', 'Sarah'].),\n  (AdmLName3 <TEXT>,  administrator's last name 3. Value examples: [None, 'Zerpoli', 'Yount', 'Woodruff', 'Wood', 'Wolk', 'Spotts'].),\n  (AdmEmail3 <TEXT>,  administrator's email address 3.),\n  (LastUpdate <DATE>,  Last Update. Value examples: ['2015-06-18'].)\n]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Question】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 10, "cur_total_response_tokens": 10}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Decomposer", "response": "\n你好\n", "input_prompt": "[Instruction]\nGiven a 【query】, you need to understanding the intent of Query, and then deceompose it into Targets and Conditions. Then you need to combine Targets and Conditions into Subquerys step by step. \nFor the case where Conditions is NULL, consider Targets as the final Subquery directly. \nFor the case where Conditions are not NULL, combine Targets and the first Condition to get the first Subquery, then combine this Subquery and the next Condition into a new Subquery until all Conditions are used (which means the content of the last Subquery and the original Query is the same).\n\n[Requirements]\n-Try not to overlap Targets and Conditions.\n-Make sure the decomposed Target and Condition can cover all of the information in Query.\n-Don't change any information (specific value) in Query!\n-Mark each Subquery with ## in front of it.\n\nHere are some examples:\n==========\n\n【Query】\nShow the stadium name and the number of concerts in each stadium. Please also list the year the stadium was built. \n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the stadium name, the year the stadium built and the number of concerts in each stadium\nConditions: NULL\n\nSubqueries:\n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the stadium name, the year the stadium built and the number of concerts in each stadium\n==========\n\n【Query】\nWhat is the qualification rate for the H-11 products produced in 2023/11/2?\n【Evidence】\nqualification rate = `Numqualified(H-11)` / `production(H-11)`\n\n【Decomposition】\nTargets: List the qualification rate for the H-11 Products\nConditions:\n1. produced in 2023/11/2 --Condition_1\n\nSubqueries:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the qualification rate for the H-11 Products produced in 2023/11/2\n\n==========\n\n【Query】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n\n【Decomposition】\nTargets: List the race of institutions\nConditions: \n1. in Alabama --Condition_1\n2. number of students greater than the 90% of average number of students of all institutions --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the race of institution in Alabama\n2. Conbine the first Subquery and Conditon_2 to get the seconed Subquery.\n##Subquery: List the race of institutions in Alabama with number of number of students greater than the 90% of average number of students of all institutions\n\n==========\n\n【Query】\nWhich president got a higher approval rating, Joseph Biden or Donald Trump?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\nConditions: \nNULL\n\nSubqueries: \n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\n\n==========\n\n【Query】\nFor movie id 1269, how many users, who was a paying subscriber and was eligible for trial when he rated the movie, gave the movie a rating score of less than or equal to 2?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the number of users\nConditions:\n1. was a paying subscriber --Condition_1\n2. was eligible for trial --Condition_2\n3. for movie id 1269, gave the movie a rating score of less than or equal to 2 --Condition3\n\nSubquerys:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the number of users who was a paying subscriber\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial\n3. Combine the second Subquery and Condition_3 to get the third Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial and gave the movie whose id is 1269 a rating score of less than or equal to 2\n\n==========\n\nHere is a new query need to be decomposed:\n\n【Query】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n\n【Decomposition】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 20, "cur_total_response_tokens": 20}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Generator", "response": "\n你好\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】and a 【Question】, you need to use valid SQLite and understand the database and knowledge so that you can generate a good SQL for the 【Question】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# stadium: [Stadium_ID (INTEGER), Location (TEXT), Name (TEXT)]\n# concert: [concert_ID (INTEGER), concert_Name (TEXT), Stadium_ID (INTEGER)]\n【Primary keys】\nstadium.`Stadium_ID` | concert.`concert_ID`\n【Foreign keys】\nconcert.`Stadium_ID` = stadium.`Stadium_ID`\n【Detailed descriptions of tables and columns】\nstadium.`Stadium_ID`: The column 'Stadium_ID' in Table <stadium> has column descriptions of \"stadium id\". Value examples: [1, 2, 3, 4, 5, 6].\nstadium.`Name`:  The column 'Name' in Table <stadium> has column descriptions of \"name of stadium\". Value examples: [\"Stark's Park\", 'Somerset Park', 'Recreation Park', 'Hampden Park', 'Glebe Park', 'Gayfield Park'].\nstadium.`Location`: The column 'Location' in Table <stadium> has column descriptions of \"location of stadium\". Value examples: ['Stirling Albion', 'Raith Rovers', \"Queen's Park\", 'Peterhead', 'East Fife', 'Brechin City'].\nconcert.`concert_ID`: The column 'concert_ID' in Table <concert> has column descriptions of \"concert id\". Value examples: [1, 2, 3, 4, 5, 6].\nconcert.`concert_Name`: The column 'concert_Name' in Table <concert> has column descriptions of \"concert name\". Value examples: ['Week 1', 'Week 2', 'Super bootcamp', 'Home Visits', 'Auditions'].\nconcert.`Stadium_ID`: The column 'Stadium_ID' in Table <concert> has column descriptions of \"stadium id\". Value examples: [2, 9, 7, 10, 1].\n【Evidence】\nNULL\n【Question】\nShow the stadium name and the number of concerts in each stadium.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: Show the stadium name and the number of concerts in each stadium.\nTargets for `SELECT`: the stadium name and the number of concerts\nhints from 【Evidence】:NULL\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the stadium name refers to stadium.`Name`, the number of concerts refers to COUNT(concert.`concert_ID`), each stadium refers to stadium.`Stadium_ID`\nConnection of tables: include tables <stadium> and <concert>, get connected keys from 【Foreign keys】: concert.`Stadium_ID` = stadium.`Stadium_ID`\nFinal SQL:\n```sql\nSELECT T1.`Name`, COUNT(T2.concert_ID) AS num_concerts\n  FROM stadium AS T1\n  JOIN concert AS T2\n  ON T1.`Stadium_ID` = T2.`Stadium_ID`\n  GROUP BY T1.`Stadium_ID`\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); name of the car refers to car_name\n【Question】\nWhat is the fastest car made by Japan?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ncountry.`country` = 'Japan'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: What is the fastest car made by Japan?\nTargets for `SELECT`: the name of the fastest car\nhints from 【Evidence】: the fastest refers to max(horsepower); name of the car refers to car_name\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: car refers to data.`car_name`, the fastest refers to MAX(data.`horsepower`), Japan refers to country.`country`\nConnection of tables: includes tables <data> and <country>, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`car_name` \n  FROM data AS T1 \n  INNER JOIN production AS T2 \n  ON T1.`ID` = T2.`ID` \n  INNER JOIN country AS T3 \n  ON T3.`origin` = T2.`country` \n  WHERE T3.`country` = 'Japan' \n  ORDER BY T1.`horsepower` DESC LIMIT 1\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`chronname`: The column 'chronname' in Table <institution_details> has column descriptions of \"Institution name\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \n【Evidence】\nnumber of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the chronname of institutions with number of students greater than the 90% of average number of students of all institutions?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: List the chroname of institutions with number of students greater than the 90% of average number of students of all institutions?\nTargets for `SELECT`: the chroname of institutions\nhints from 【Evidence】: number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the chronname of institutions refers to institution_details.`chronname`, number of students refers to institution_details.`student_count`\nConnection of tables: include only one table <institution_details>, no connection\nFinal SQL:\n```sql\nSELECT DISTINCT `chroname`\n  FROM institution_details\n  WHERE `student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details\n  ) \n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Question】\nHow many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 30, "cur_total_response_tokens": 30}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Query】\n-- How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 40, "cur_total_response_tokens": 40}
{"idx": 5, "db_id": "california_schools", "query": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?", "evidence": "Exclusively virtual refers to Virtual = 'F'", "difficulty": "simple", "ground_truth": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nExclusively virtual refers to Virtual = 'F'\n【Query】\n-- How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 50, "cur_total_response_tokens": 50}
{"idx": 0, "db_id": "california_schools", "query": "What is the highest eligible free rate for K-12 students in the schools in Alameda County?", "evidence": "Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`", "difficulty": "simple", "ground_truth": "SELECT `Free Meal Count (K-12)` / `Enrollment (K-12)` FROM frpm WHERE `County Name` = 'Alameda' ORDER BY (CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)`) DESC LIMIT 1", "send_to": "Soft_Schema_Linker", "response": "\n你好\n", "input_prompt": "As an experienced and professional database administrator, your task is to analyze a user question and a database schema to provide relevant information. The database schema consists of table descriptions, each containing multiple column descriptions. Your goal is to extract the entities from question and identify the relevant tables and columns based on these entities and the evidence provided.\n\n[Instruction]:\n1. Extract the mentioned entities from the user question. Make sure all of the entities are extracted. \n2. For each entity, keep at least 3 related columns.\n4. Your output should include entity extraction, analysis and related database schema.\n5. The related database schema should be in JSON format.\n6. Each column's information in provided 【Schema】 is in this format: (column, description. Value examples<optional>)\n\n[Requirements]:\n1. Sort the related columns in each list corresponding to each entity in descending order of relevance.\n2. The chosen columns should be in this format: <table.column>.\n3. Make sure each chosen list is not empty. The value [] will be punished. \n4.【Matched values】 may contain redundant or useless information in addition to the correct matching values, so you need to select the useful information in conjunction with the specific column names and descriptions.\n5. An entity may not have a corresponding evidence, which requires you to find the relevant columns yourself through your understanding of the database schema.\n\nHere is a typical example:\n\n==========\n【DB_ID】 banking_system\n【Schema】\n# Table: account\n[\n  (account_id <INTEGER>, the id of the account. Value examples: [11382, 11362, 2, 1, 2367].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (frequency <TEXT>, frequency of the acount. Value examples: ['POPLATEK MESICNE', 'POPLATEK TYDNE', 'POPLATEK PO OBRATU'].),\n  (date <DATE>, the creation date of the account. Value examples: ['1997-12-29', '1997-12-28'].)\n]\n# Table: client\n[\n  (client_id <INTEGER>, the unique number. Value examples: [13998, 13971, 2, 1, 2839].),\n  (gender <TEXT>, gender. Value examples: ['M', 'F']. And F：female . M：male ),\n  (birth_date <DATE>, birth date. Value examples: ['1987-09-27', '1986-08-13'].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (first_name <TEXT>, first_name.),\n  (last_name <TEXT>, last_name.)\n]\n# Table: loan\n[\n  (loan_id <INTEGER>, the id number identifying the loan data. Value examples: [4959, 4960, 4961].),\n  (account_id <INTEGER>, the id number identifying the account. Value examples: [10, 80, 55, 43].),\n  (date <DATE>, the date when the loan is approved. Value examples: ['1998-07-12', '1998-04-19'].),\n  (amount <INTEGER>, the id number identifying the loan data. Value examples: [1567, 7877, 9988].),\n  (duration <INTEGER>, the id number identifying the loan data. Value examples: [60, 48, 24, 12, 36].),\n  (payments <INTEGER>, the id number identifying the loan data. Value examples: [3456, 8972, 9845].),\n  (status <TEXT>, the id number identifying the loan data. Value examples: ['C', 'A', 'D', 'B'].)\n]\n# Table: district\n[\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76].),\n  (A2 <REAL>, area in square kilometers. Value examples: [50.5, 48.9].),\n  (A4 <INTEGER>, number of inhabitants. Value examples: [95907, 95616].),\n  (A5 <INTEGER>, number of households. Value examples: [35678, 34892].),\n  (A6 <REAL>, literacy rate. Value examples: [95.6, 92.3, 89.7].),\n  (A7 <INTEGER>, number of entrepreneurs. Value examples: [1234, 1456].),\n  (A8 <INTEGERt>, number of cities. Value examples: [5, 4].),\n  (A9 <INTEGER>, number of schools. Value examples: [15, 12, 10].),\n  (A10 <INTEGER>, number of hospitals. Value examples: [8, 6, 4].),\n  (A11 <REAL>, average salary. Value examples: [12541.5, 11277].),\n  (A12 <REAL>, poverty rate. Value examples: [12.4, 9.8].),\n  (A13 <REAL>, unemployment rate. Value examples: [8.2, 7.9].),\n  (A15 <INTEGER>, number of crimes. Value examples: [256, 189].)\n]\n【Primary keys】\naccount.`account_id` | client.`client_id` | loan.`loan_id` | district.`district_id`\n【Foreign keys】\nclient.`district_id` = district.`district_id`\n【Question】\nWhat is the gender of the youngest client who opened account in the lowest average salary branch and when did this client open the account? Please list their full name.\n【Evidence】\nLater birthdate refers to younger age; A11 refers to average salary; Full name refers to first_name, last_name\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\nThe entities extracted from the 【Question】 are: \n1. gender; \n2. youngest client; \n3. account; \n4. lowest average salary branch; \n5. when did this client open the account; \n6. full name\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. gender --no related evidence **the columns about gender are related**\n2. youngest client  --Later birthdate refers to younger age; **the columns about birth date of client and the id of client are related**\n3. account --no related evidence **the columns about account or account ids are related**\n4. lowest average salary branch  --A11 refers to average salary **the columns about average salary and branch are related**\n5. when did this client open the account --no related evidence **the columns about time or date of the account are related**\n6. full name  --Full name refers to first_name, last_name **the columns about first_name, last_name of the client are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"gender\": [\"client.gender\",\"client.client_id\",\"loan.status\"],\n  \"youngest client\": [\"client.birth_date\",\"client.client_id\",\"account.date\",\"loan.date\"],\n  \"account\": [\"account.account_id\",\"loan.account_id\",\"account.date\"],\n  \"lowest average salary branch\": [\"district.A11\",\"district.district_id\",\"district.A13\"],\n  \"when did this client open the account\": [\"account.date\",\"loan.date\",\"client.birth_date\"],\n  \"full name\": [\"client.first_name\",\"client.last_name\",\"client.client_id\"]\n}\n```\nQuestion Solved.\n\n==========\n\nHere is a new example, please start answering:\n\n【DB_ID】 california_schools\n【Schema】\n# Table: frpm\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (Academic Year <TEXT>,  Academic Year. Value examples: ['2014-2015'].),\n  (County Code <TEXT>,  County Code. Value examples: ['19', '37', '30', '36', '33', '43'].),\n  (District Code <INTEGER>,  District Code.),\n  (School Code <TEXT>,  School Code. Value examples: ['0000000', '9010745', '6121081', '6121073', '6121016', '6120968'].),\n  (County Name <TEXT>,  County Name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].),\n  (District Name <TEXT>,  District Name.),\n  (School Name <TEXT>,  School Name.),\n  (District Type <TEXT>,  District Type. Value examples: ['Unified School District', 'Elementary School District', 'High School District', 'County Office of Education (COE)', 'State Board of Education', 'Statewide Benefit Charter'].),\n  (School Type <TEXT>,  School Type. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].),\n  (Educational Option Type <TEXT>,  Educational Option Type. Value examples: [None, 'Traditional', 'Continuation School', 'Alternative School of Choice', 'Community Day School', 'Special Education School', 'County Community School'].),\n  (NSLP Provision Status <TEXT>,  NSLP Provision Status. Value examples: [None, 'Provision 2', 'Breakfast Provision 2', 'CEP', 'Multiple Provision Types', 'Provision 1', 'Lunch Provision 2'].),\n  (Charter School (Y/N) <INTEGER>,  Charter School (Y/N). Value examples: [None, 0, 1].),\n  (Charter School Number <TEXT>,  Charter School Number. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1700', '1696'].),\n  (Charter Funding Type <TEXT>,  Charter Funding Type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (IRC <INTEGER>,  IRC. Value examples: [None, 0, 1].),\n  (Low Grade <TEXT>,  Low Grade. Value examples: ['K', '9', '6', '7', 'P', '5'].),\n  (High Grade <TEXT>,  High Grade. Value examples: ['12', '5', '8', '6', '3', '4'].),\n  (Enrollment (K-12) <REAL>,  Enrollment (K-12).),\n  (Free Meal Count (K-12) <REAL>,  Free Meal Count (K-12).),\n  (Percent (%) Eligible Free (K-12) <REAL>,  Percent (%) Eligible Free (K-12).),\n  (FRPM Count (K-12) <REAL>,  Free or Reduced Price Meal Count (K-12).),\n  (Percent (%) Eligible FRPM (K-12) <REAL>,  Percent (%) Eligible FRPM (K-12).),\n  (Enrollment (Ages 5-17) <REAL>,  Enrollment (Ages 5-17).),\n  (Free Meal Count (Ages 5-17) <REAL>,  Free Meal Count (Ages 5-17).),\n  (Percent (%) Eligible Free (Ages 5-17) <REAL>,  Percent (%) Eligible Free (Ages 5-17).),\n  (FRPM Count (Ages 5-17) <REAL>,  FRPM Count (Ages 5-17).),\n  (Percent (%) Eligible FRPM (Ages 5-17) <REAL>,  Percent (%) Eligible FRPM (Ages 5-17).),\n  (2013-14 CALPADS Fall 1 Certification Status <INTEGER>,  2013-14 CALPADS Fall 1 Certification Status. Value examples: [1].)\n]\n# Table: satscores\n[\n  (cds <TEXT>,  California Department Schools.),\n  (rtype <TEXT>,  rtype. Value examples: ['S', 'D'].),\n  (sname <TEXT>,  school name. Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].),\n  (dname <TEXT>,  district segment. Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].),\n  (cname <TEXT>,  county name. Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].),\n  (enroll12 <INTEGER>,  enrollment (1st-12nd grade).),\n  (NumTstTakr <INTEGER>,  Number of Test Takers in this school.),\n  (AvgScrRead <INTEGER>,  average scores in Reading.),\n  (AvgScrMath <INTEGER>,  average scores in Math.),\n  (AvgScrWrite <INTEGER>,  average scores in writing.),\n  (NumGE1500 <INTEGER>,  Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500.)\n]\n# Table: schools\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (NCESDist <TEXT>,  This field represents the 7-digit National Center for Educational Statistics (NCES) school district identification number. The first 2 digits identify the state and the last 5 digits identify the school district. Combined, they make a unique 7-digit ID for each school district.. Value examples: [None, '0622710', '0634320', '0628050', '0634410', '0614550', '0633840'].),\n  (NCESSchool <TEXT>,  This field represents the 5-digit NCES school identification number. The NCESSchool combined with the NCESDist form a unique 12-digit ID for each school.. Value examples: [None, '12271', '13785', '13747', '12909', '12311', '12003'].),\n  (StatusType <TEXT>,  This field identifies the status of the district.. Value examples: ['Active', 'Closed', 'Merged', 'Pending'].),\n  (County <TEXT>,  County name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].),\n  (District <TEXT>,  District.),\n  (School <TEXT>,  School.),\n  (Street <TEXT>,  Street.),\n  (StreetAbr <TEXT>,  The abbreviated street address of the school, district, or administrative authority’s physical location..),\n  (City <TEXT>,  City. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].),\n  (Zip <TEXT>,  Zip. Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].),\n  (State <TEXT>,  State. Value examples: [None, 'CA'].),\n  (MailStreet <TEXT>,  MailStreet.),\n  (MailStrAbr <TEXT>,  mailing street address.),\n  (MailCity <TEXT>,  mailing city. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].),\n  (MailZip <TEXT>,  mailing zip. Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].),\n  (MailState <TEXT>,  mailing state. Value examples: [None, 'CA'].),\n  (Phone <TEXT>,  Phone. Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].),\n  (Ext <TEXT>,  The phone number extension of the school, district, or administrative authority.. Value examples: [None, '200', '201', '111', '352', '221', '203'].),\n  (Website <TEXT>,  The website address of the school, district, or administrative authority..),\n  (OpenDate <DATE>,  The date the school opened.. Value examples: [None, '1980-07-01'].),\n  (ClosedDate <DATE>,  The date the school closed.. Value examples: [None, '1989-06-30'].),\n  (Charter <INTEGER>,  This field identifies a charter school.. Value examples: [None, 0, 1].),\n  (CharterNum <TEXT>,  The charter school number,. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1826', '1710'].),\n  (FundingType <TEXT>,  Indicates the charter school funding type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (DOC <TEXT>,  District Ownership Code. Value examples: ['54', '52', '00', '56', '98', '02'].),\n  (DOCType <TEXT>,  The District Ownership Code Type is the text description of the DOC category.. Value examples: ['Unified School District', 'Elementary School District', 'County Office of Education (COE)', 'High School District', 'Regional Occupation Center/Program (ROC/P)', 'State Board of Education'].),\n  (SOC <TEXT>,  The School Ownership Code is a numeric code used to identify the type of school.. Value examples: [None, '60', '66', '62', '68', '09', '69'].),\n  (SOCType <TEXT>,  The School Ownership Code Type is the text description of the type of school.. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Special Education Schools (Public)', 'District Community Day Schools'].),\n  (EdOpsCode <TEXT>,  The Education Option Code is a short text description of the type of education offered.. Value examples: [None, 'TRAD', 'CON', 'COMMDAY', 'ALTSOC', 'SPEC', 'COMM'].),\n  (EdOpsName <TEXT>,  Educational Option Name. Value examples: [None, 'Traditional', 'Continuation School', 'Community Day School', 'Alternative School of Choice', 'Special Education School', 'County Community School'].),\n  (EILCode <TEXT>,  The Educational Instruction Level Code is a short text description of the institution's type relative to the grade range served.. Value examples: [None, 'ELEM', 'HS', 'UG', 'INTMIDJR', 'ELEMHIGH', 'A'].),\n  (EILName <TEXT>,  The Educational Instruction Level Name is the long text description of the institution’s type relative to the grade range served.. Value examples: [None, 'Elementary', 'High School', 'Ungraded', 'Intermediate/Middle/Junior High', 'Elementary-High Combination', 'Adult'].),\n  (GSoffered <TEXT>,  The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.. Value examples: [None, 'K-5', '9-12', 'K-6', 'K-8', '6-8', 'K-12'].),\n  (GSserved <TEXT>,  It is the lowest grade and the highest grade of student enrollment as reported in the most recent certified CALPADS Fall 1 data collection. Only K–12 enrollment is reported through CALPADS. This field may differ from the grade span offered.. Value examples: [None, 'K-5', 'K-6', '9-12', 'K-8', '6-8', '7-8'].),\n  (Virtual <TEXT>,  This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.. Value examples: [None, 'N', 'P', 'F'].),\n  (Magnet <INTEGER>,  This field identifies whether a school is a magnet school and/or provides a magnet program.. Value examples: [None, 0, 1].),\n  (Latitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the equator measured north to south..),\n  (Longitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the prime meridian (Greenwich, England) measured from west to east..),\n  (AdmFName1 <TEXT>,  administrator's first name 1. Value examples: [None, 'David', 'Michael', 'John', 'Jennifer', 'Lisa', 'Robert'].),\n  (AdmLName1 <TEXT>,  administrator's last name 1.),\n  (AdmEmail1 <TEXT>,  administrator's email address 1.),\n  (AdmFName2 <TEXT>,  administrator's first name 2. Value examples: [None, 'Steve', 'Delphine', 'Tim', 'Michael', 'Lisa', 'Jeff'].),\n  (AdmLName2 <TEXT>,  administrator's last name 2. Value examples: [None, 'Sherman', 'Jones', 'Wilson', 'Petersen', 'Landry', 'Hambright'].),\n  (AdmEmail2 <TEXT>,  administrator's email address 2.),\n  (AdmFName3 <TEXT>,  administrator's first name 3. Value examples: [None, 'Mark', 'Eric', 'Vickie', 'Tracie', 'Shawn', 'Sarah'].),\n  (AdmLName3 <TEXT>,  administrator's last name 3. Value examples: [None, 'Zerpoli', 'Yount', 'Woodruff', 'Wood', 'Wolk', 'Spotts'].),\n  (AdmEmail3 <TEXT>,  administrator's email address 3.),\n  (LastUpdate <DATE>,  Last Update. Value examples: ['2015-06-18'].)\n]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Question】\nWhat is the highest eligible free rate for K-12 students in the schools in Alameda County?\n【Evidence】\nEligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nfrpm.`County Name` = 'Alameda'; schools.`MailCity` = 'Alameda'; satscores.`cname` = 'Alameda'; schools.`County` = 'Alameda'; schools.`GSoffered` = 'K-12'; schools.`GSserved` = 'K-12'; schools.`City` = 'Alameda'\n【Answer】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 10, "cur_total_response_tokens": 10}
{"idx": 0, "db_id": "california_schools", "query": "What is the highest eligible free rate for K-12 students in the schools in Alameda County?", "evidence": "Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`", "difficulty": "simple", "ground_truth": "SELECT `Free Meal Count (K-12)` / `Enrollment (K-12)` FROM frpm WHERE `County Name` = 'Alameda' ORDER BY (CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)`) DESC LIMIT 1", "send_to": "Decomposer", "response": "\n你好\n", "input_prompt": "[Instruction]\nGiven a 【query】, you need to understanding the intent of Query, and then deceompose it into Targets and Conditions. Then you need to combine Targets and Conditions into Subquerys step by step. \nFor the case where Conditions is NULL, consider Targets as the final Subquery directly. \nFor the case where Conditions are not NULL, combine Targets and the first Condition to get the first Subquery, then combine this Subquery and the next Condition into a new Subquery until all Conditions are used (which means the content of the last Subquery and the original Query is the same).\n\n[Requirements]\n-Try not to overlap Targets and Conditions.\n-Make sure the decomposed Target and Condition can cover all of the information in Query.\n-Don't change any information (specific value) in Query!\n-Mark each Subquery with ## in front of it.\n\nHere are some examples:\n==========\n\n【Query】\nShow the stadium name and the number of concerts in each stadium. Please also list the year the stadium was built. \n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the stadium name, the year the stadium built and the number of concerts in each stadium\nConditions: NULL\n\nSubqueries:\n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the stadium name, the year the stadium built and the number of concerts in each stadium\n==========\n\n【Query】\nWhat is the qualification rate for the H-11 products produced in 2023/11/2?\n【Evidence】\nqualification rate = `Numqualified(H-11)` / `production(H-11)`\n\n【Decomposition】\nTargets: List the qualification rate for the H-11 Products\nConditions:\n1. produced in 2023/11/2 --Condition_1\n\nSubqueries:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the qualification rate for the H-11 Products produced in 2023/11/2\n\n==========\n\n【Query】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n\n【Decomposition】\nTargets: List the race of institutions\nConditions: \n1. in Alabama --Condition_1\n2. number of students greater than the 90% of average number of students of all institutions --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the race of institution in Alabama\n2. Conbine the first Subquery and Conditon_2 to get the seconed Subquery.\n##Subquery: List the race of institutions in Alabama with number of number of students greater than the 90% of average number of students of all institutions\n\n==========\n\n【Query】\nWhich president got a higher approval rating, Joseph Biden or Donald Trump?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\nConditions: \nNULL\n\nSubqueries: \n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\n\n==========\n\n【Query】\nFor movie id 1269, how many users, who was a paying subscriber and was eligible for trial when he rated the movie, gave the movie a rating score of less than or equal to 2?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the number of users\nConditions:\n1. was a paying subscriber --Condition_1\n2. was eligible for trial --Condition_2\n3. for movie id 1269, gave the movie a rating score of less than or equal to 2 --Condition3\n\nSubquerys:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the number of users who was a paying subscriber\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial\n3. Combine the second Subquery and Condition_3 to get the third Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial and gave the movie whose id is 1269 a rating score of less than or equal to 2\n\n==========\n\nHere is a new query need to be decomposed:\n\n【Query】\nWhat is the highest eligible free rate for K-12 students in the schools in Alameda County?\n【Evidence】\nEligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n\n【Decomposition】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 20, "cur_total_response_tokens": 20}
{"idx": 0, "db_id": "california_schools", "query": "What is the highest eligible free rate for K-12 students in the schools in Alameda County?", "evidence": "Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`", "difficulty": "simple", "ground_truth": "SELECT `Free Meal Count (K-12)` / `Enrollment (K-12)` FROM frpm WHERE `County Name` = 'Alameda' ORDER BY (CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)`) DESC LIMIT 1", "send_to": "Generator", "response": "\n你好\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】and a 【Question】, you need to use valid SQLite and understand the database and knowledge so that you can generate a good SQL for the 【Question】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# stadium: [Stadium_ID (INTEGER), Location (TEXT), Name (TEXT)]\n# concert: [concert_ID (INTEGER), concert_Name (TEXT), Stadium_ID (INTEGER)]\n【Primary keys】\nstadium.`Stadium_ID` | concert.`concert_ID`\n【Foreign keys】\nconcert.`Stadium_ID` = stadium.`Stadium_ID`\n【Detailed descriptions of tables and columns】\nstadium.`Stadium_ID`: The column 'Stadium_ID' in Table <stadium> has column descriptions of \"stadium id\". Value examples: [1, 2, 3, 4, 5, 6].\nstadium.`Name`:  The column 'Name' in Table <stadium> has column descriptions of \"name of stadium\". Value examples: [\"Stark's Park\", 'Somerset Park', 'Recreation Park', 'Hampden Park', 'Glebe Park', 'Gayfield Park'].\nstadium.`Location`: The column 'Location' in Table <stadium> has column descriptions of \"location of stadium\". Value examples: ['Stirling Albion', 'Raith Rovers', \"Queen's Park\", 'Peterhead', 'East Fife', 'Brechin City'].\nconcert.`concert_ID`: The column 'concert_ID' in Table <concert> has column descriptions of \"concert id\". Value examples: [1, 2, 3, 4, 5, 6].\nconcert.`concert_Name`: The column 'concert_Name' in Table <concert> has column descriptions of \"concert name\". Value examples: ['Week 1', 'Week 2', 'Super bootcamp', 'Home Visits', 'Auditions'].\nconcert.`Stadium_ID`: The column 'Stadium_ID' in Table <concert> has column descriptions of \"stadium id\". Value examples: [2, 9, 7, 10, 1].\n【Evidence】\nNULL\n【Question】\nShow the stadium name and the number of concerts in each stadium.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: Show the stadium name and the number of concerts in each stadium.\nTargets for `SELECT`: the stadium name and the number of concerts\nhints from 【Evidence】:NULL\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the stadium name refers to stadium.`Name`, the number of concerts refers to COUNT(concert.`concert_ID`), each stadium refers to stadium.`Stadium_ID`\nConnection of tables: include tables <stadium> and <concert>, get connected keys from 【Foreign keys】: concert.`Stadium_ID` = stadium.`Stadium_ID`\nFinal SQL:\n```sql\nSELECT T1.`Name`, COUNT(T2.concert_ID) AS num_concerts\n  FROM stadium AS T1\n  JOIN concert AS T2\n  ON T1.`Stadium_ID` = T2.`Stadium_ID`\n  GROUP BY T1.`Stadium_ID`\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); name of the car refers to car_name\n【Question】\nWhat is the fastest car made by Japan?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ncountry.`country` = 'Japan'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: What is the fastest car made by Japan?\nTargets for `SELECT`: the name of the fastest car\nhints from 【Evidence】: the fastest refers to max(horsepower); name of the car refers to car_name\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: car refers to data.`car_name`, the fastest refers to MAX(data.`horsepower`), Japan refers to country.`country`\nConnection of tables: includes tables <data> and <country>, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`car_name` \n  FROM data AS T1 \n  INNER JOIN production AS T2 \n  ON T1.`ID` = T2.`ID` \n  INNER JOIN country AS T3 \n  ON T3.`origin` = T2.`country` \n  WHERE T3.`country` = 'Japan' \n  ORDER BY T1.`horsepower` DESC LIMIT 1\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`chronname`: The column 'chronname' in Table <institution_details> has column descriptions of \"Institution name\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \n【Evidence】\nnumber of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the chronname of institutions with number of students greater than the 90% of average number of students of all institutions?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: List the chroname of institutions with number of students greater than the 90% of average number of students of all institutions?\nTargets for `SELECT`: the chroname of institutions\nhints from 【Evidence】: number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the chronname of institutions refers to institution_details.`chronname`, number of students refers to institution_details.`student_count`\nConnection of tables: include only one table <institution_details>, no connection\nFinal SQL:\n```sql\nSELECT DISTINCT `chroname`\n  FROM institution_details\n  WHERE `student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details\n  ) \n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\n\n【Evidence】\nEligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n【Question】\nWhat is the highest eligible free rate for K-12 students in the schools in Alameda County?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nfrpm.`County Name` = 'Alameda'; schools.`MailCity` = 'Alameda'; satscores.`cname` = 'Alameda'; schools.`County` = 'Alameda'; schools.`GSoffered` = 'K-12'; schools.`GSserved` = 'K-12'; schools.`City` = 'Alameda'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 30, "cur_total_response_tokens": 30}
{"idx": 0, "db_id": "california_schools", "query": "What is the highest eligible free rate for K-12 students in the schools in Alameda County?", "evidence": "Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`", "difficulty": "simple", "ground_truth": "SELECT `Free Meal Count (K-12)` / `Enrollment (K-12)` FROM frpm WHERE `County Name` = 'Alameda' ORDER BY (CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)`) DESC LIMIT 1", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nEligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n【Query】\n-- What is the highest eligible free rate for K-12 students in the schools in Alameda County?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 40, "cur_total_response_tokens": 40}
{"idx": 0, "db_id": "california_schools", "query": "What is the highest eligible free rate for K-12 students in the schools in Alameda County?", "evidence": "Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`", "difficulty": "simple", "ground_truth": "SELECT `Free Meal Count (K-12)` / `Enrollment (K-12)` FROM frpm WHERE `County Name` = 'Alameda' ORDER BY (CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)`) DESC LIMIT 1", "send_to": "Refiner", "response": "\n你好\n", "input_prompt": "【Instruction】\nWhen executing SQL below, some errors occurred, please fix up SQL based on query and database info.\nSolve the task step by step if you need to. Using SQL format in the code block, and indicate script type in the code block.\nWhen you find an answer, verify the answer carefully. Include verifiable evidence in your response if possible.\n【Constraints】\n- The SQL should start with 'SELECT'\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use `JOIN <table>`, the connected columns should be in the Foreign keys of 【Database schema】\n【Response format】\nYour response should be in this format:\nAnalysis:\n**[Your analysis]**\nCorrect SQL:\n```sql\n[the fixed SQL]\n```\n【Attention】\nOnly SQL statements are allowed in [the fixed SQL], do not add any comments.\n\n【Evidence】\nEligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n【Query】\n-- What is the highest eligible free rate for K-12 students in the schools in Alameda County?\n【Database info】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns]】\n\n【old SQL】\n```sql\nSELECTNone\n```\n【SQLite error】 \n('argument 1 must be str, not None',)\n【Exception class】\nTypeError\n\nNow please fixup old SQL and generate new SQL again.\n【correct SQL】\n", "prompt_token": 10, "response_token": 10, "cur_total_prompt_tokens": 50, "cur_total_response_tokens": 50}
{"idx": 0, "db_id": "california_schools", "query": "What is the highest eligible free rate for K-12 students in the schools in Alameda County?", "evidence": "Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`", "difficulty": "simple", "ground_truth": "SELECT `Free Meal Count (K-12)` / `Enrollment (K-12)` FROM frpm WHERE `County Name` = 'Alameda' ORDER BY (CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)`) DESC LIMIT 1", "send_to": "Soft_Schema_Linker", "response": "\nThe entities extracted from the question are:\n\n1. highest eligible free rate\n2. K-12 students\n3. schools\n4. Alameda County\n\nExtract the related evidence in 【Evidence】 for entities:\n\n1. highest eligible free rate -- Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n2. K-12 students -- Enrollment (K-12) and Free Meal Count (K-12) are relevant\n3. schools -- Relevant columns include CDSCode and County Name\n4. Alameda County -- County Name or County column in the database\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"highest eligible free rate\": [\"frpm.Free Meal Count (K-12)\", \"frpm.Enrollment (K-12)\", \"satscores.enroll12\"],\n  \"K-12 students\": [\"frpm.Enrollment (K-12)\", \"frpm.Free Meal Count (K-12)\", \"satscores.enroll12\"],\n  \"schools\": [\"schools.CDSCode\", \"schools.County\", \"schools.City\"],\n  \"Alameda County\": [\"frpm.County Name\", \"schools.County\", \"satscores.cname\"]\n}\n```\n", "input_prompt": "As an experienced and professional database administrator, your task is to analyze a user question and a database schema to provide relevant information. The database schema consists of table descriptions, each containing multiple column descriptions. Your goal is to extract the entities from question and identify the relevant tables and columns based on these entities and the evidence provided.\n\n[Instruction]:\n1. Extract the mentioned entities from the user question. Make sure all of the entities are extracted. \n2. For each entity, keep at least 3 related columns.\n4. Your output should include entity extraction, analysis and related database schema.\n5. The related database schema should be in JSON format.\n6. Each column's information in provided 【Schema】 is in this format: (column, description. Value examples<optional>)\n\n[Requirements]:\n1. Sort the related columns in each list corresponding to each entity in descending order of relevance.\n2. The chosen columns should be in this format: <table.column>.\n3. Make sure each chosen list is not empty. The value [] will be punished. \n4.【Matched values】 may contain redundant or useless information in addition to the correct matching values, so you need to select the useful information in conjunction with the specific column names and descriptions.\n5. An entity may not have a corresponding evidence, which requires you to find the relevant columns yourself through your understanding of the database schema.\n\nHere is a typical example:\n\n==========\n【DB_ID】 banking_system\n【Schema】\n# Table: account\n[\n  (account_id <INTEGER>, the id of the account. Value examples: [11382, 11362, 2, 1, 2367].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (frequency <TEXT>, frequency of the acount. Value examples: ['POPLATEK MESICNE', 'POPLATEK TYDNE', 'POPLATEK PO OBRATU'].),\n  (date <DATE>, the creation date of the account. Value examples: ['1997-12-29', '1997-12-28'].)\n]\n# Table: client\n[\n  (client_id <INTEGER>, the unique number. Value examples: [13998, 13971, 2, 1, 2839].),\n  (gender <TEXT>, gender. Value examples: ['M', 'F']. And F：female . M：male ),\n  (birth_date <DATE>, birth date. Value examples: ['1987-09-27', '1986-08-13'].),\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76, 2, 1, 39].),\n  (first_name <TEXT>, first_name.),\n  (last_name <TEXT>, last_name.)\n]\n# Table: loan\n[\n  (loan_id <INTEGER>, the id number identifying the loan data. Value examples: [4959, 4960, 4961].),\n  (account_id <INTEGER>, the id number identifying the account. Value examples: [10, 80, 55, 43].),\n  (date <DATE>, the date when the loan is approved. Value examples: ['1998-07-12', '1998-04-19'].),\n  (amount <INTEGER>, the id number identifying the loan data. Value examples: [1567, 7877, 9988].),\n  (duration <INTEGER>, the id number identifying the loan data. Value examples: [60, 48, 24, 12, 36].),\n  (payments <INTEGER>, the id number identifying the loan data. Value examples: [3456, 8972, 9845].),\n  (status <TEXT>, the id number identifying the loan data. Value examples: ['C', 'A', 'D', 'B'].)\n]\n# Table: district\n[\n  (district_id <INTEGER>, location of branch. Value examples: [77, 76].),\n  (A2 <REAL>, area in square kilometers. Value examples: [50.5, 48.9].),\n  (A4 <INTEGER>, number of inhabitants. Value examples: [95907, 95616].),\n  (A5 <INTEGER>, number of households. Value examples: [35678, 34892].),\n  (A6 <REAL>, literacy rate. Value examples: [95.6, 92.3, 89.7].),\n  (A7 <INTEGER>, number of entrepreneurs. Value examples: [1234, 1456].),\n  (A8 <INTEGERt>, number of cities. Value examples: [5, 4].),\n  (A9 <INTEGER>, number of schools. Value examples: [15, 12, 10].),\n  (A10 <INTEGER>, number of hospitals. Value examples: [8, 6, 4].),\n  (A11 <REAL>, average salary. Value examples: [12541.5, 11277].),\n  (A12 <REAL>, poverty rate. Value examples: [12.4, 9.8].),\n  (A13 <REAL>, unemployment rate. Value examples: [8.2, 7.9].),\n  (A15 <INTEGER>, number of crimes. Value examples: [256, 189].)\n]\n【Primary keys】\naccount.`account_id` | client.`client_id` | loan.`loan_id` | district.`district_id`\n【Foreign keys】\nclient.`district_id` = district.`district_id`\n【Question】\nWhat is the gender of the youngest client who opened account in the lowest average salary branch and when did this client open the account? Please list their full name.\n【Evidence】\nLater birthdate refers to younger age; A11 refers to average salary; Full name refers to first_name, last_name\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nNo matched values.\n【Answer】\nThe entities extracted from the 【Question】 are: \n1. gender; \n2. youngest client; \n3. account; \n4. lowest average salary branch; \n5. when did this client open the account; \n6. full name\n\nExtract the related evidence in 【Evidence】 for entities if 【Evidence】 is not None: \n1. gender --no related evidence **the columns about gender are related**\n2. youngest client  --Later birthdate refers to younger age; **the columns about birth date of client and the id of client are related**\n3. account --no related evidence **the columns about account or account ids are related**\n4. lowest average salary branch  --A11 refers to average salary **the columns about average salary and branch are related**\n5. when did this client open the account --no related evidence **the columns about time or date of the account are related**\n6. full name  --Full name refers to first_name, last_name **the columns about first_name, last_name of the client are related**\n\nTherefore, we can select the related database schema based on these entities with 【Evidence】:\n```json\n{\n  \"gender\": [\"client.gender\",\"client.client_id\",\"loan.status\"],\n  \"youngest client\": [\"client.birth_date\",\"client.client_id\",\"account.date\",\"loan.date\"],\n  \"account\": [\"account.account_id\",\"loan.account_id\",\"account.date\"],\n  \"lowest average salary branch\": [\"district.A11\",\"district.district_id\",\"district.A13\"],\n  \"when did this client open the account\": [\"account.date\",\"loan.date\",\"client.birth_date\"],\n  \"full name\": [\"client.first_name\",\"client.last_name\",\"client.client_id\"]\n}\n```\nQuestion Solved.\n\n==========\n\nHere is a new example, please start answering:\n\n【DB_ID】 california_schools\n【Schema】\n# Table: frpm\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (Academic Year <TEXT>,  Academic Year. Value examples: ['2014-2015'].),\n  (County Code <TEXT>,  County Code. Value examples: ['19', '37', '30', '36', '33', '43'].),\n  (District Code <INTEGER>,  District Code.),\n  (School Code <TEXT>,  School Code. Value examples: ['0000000', '9010745', '6121081', '6121073', '6121016', '6120968'].),\n  (County Name <TEXT>,  County Name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].),\n  (District Name <TEXT>,  District Name.),\n  (School Name <TEXT>,  School Name.),\n  (District Type <TEXT>,  District Type. Value examples: ['Unified School District', 'Elementary School District', 'High School District', 'County Office of Education (COE)', 'State Board of Education', 'Statewide Benefit Charter'].),\n  (School Type <TEXT>,  School Type. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Alternative Schools of Choice', 'K-12 Schools (Public)'].),\n  (Educational Option Type <TEXT>,  Educational Option Type. Value examples: [None, 'Traditional', 'Continuation School', 'Alternative School of Choice', 'Community Day School', 'Special Education School', 'County Community School'].),\n  (NSLP Provision Status <TEXT>,  NSLP Provision Status. Value examples: [None, 'Provision 2', 'Breakfast Provision 2', 'CEP', 'Multiple Provision Types', 'Provision 1', 'Lunch Provision 2'].),\n  (Charter School (Y/N) <INTEGER>,  Charter School (Y/N). Value examples: [None, 0, 1].),\n  (Charter School Number <TEXT>,  Charter School Number. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1700', '1696'].),\n  (Charter Funding Type <TEXT>,  Charter Funding Type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (IRC <INTEGER>,  IRC. Value examples: [None, 0, 1].),\n  (Low Grade <TEXT>,  Low Grade. Value examples: ['K', '9', '6', '7', 'P', '5'].),\n  (High Grade <TEXT>,  High Grade. Value examples: ['12', '5', '8', '6', '3', '4'].),\n  (Enrollment (K-12) <REAL>,  Enrollment (K-12).),\n  (Free Meal Count (K-12) <REAL>,  Free Meal Count (K-12).),\n  (Percent (%) Eligible Free (K-12) <REAL>,  Percent (%) Eligible Free (K-12).),\n  (FRPM Count (K-12) <REAL>,  Free or Reduced Price Meal Count (K-12).),\n  (Percent (%) Eligible FRPM (K-12) <REAL>,  Percent (%) Eligible FRPM (K-12).),\n  (Enrollment (Ages 5-17) <REAL>,  Enrollment (Ages 5-17).),\n  (Free Meal Count (Ages 5-17) <REAL>,  Free Meal Count (Ages 5-17).),\n  (Percent (%) Eligible Free (Ages 5-17) <REAL>,  Percent (%) Eligible Free (Ages 5-17).),\n  (FRPM Count (Ages 5-17) <REAL>,  FRPM Count (Ages 5-17).),\n  (Percent (%) Eligible FRPM (Ages 5-17) <REAL>,  Percent (%) Eligible FRPM (Ages 5-17).),\n  (2013-14 CALPADS Fall 1 Certification Status <INTEGER>,  2013-14 CALPADS Fall 1 Certification Status. Value examples: [1].)\n]\n# Table: satscores\n[\n  (cds <TEXT>,  California Department Schools.),\n  (rtype <TEXT>,  rtype. Value examples: ['S', 'D'].),\n  (sname <TEXT>,  school name. Value examples: [None, 'Middle College High', 'John F. Kennedy High', 'Independence High', 'Foothill High', 'Washington High', 'Redwood High'].),\n  (dname <TEXT>,  district segment. Value examples: ['Los Angeles Unified', 'San Diego Unified', 'Oakland Unified', 'San Francisco Unified', 'Kern High', 'East Side Union High'].),\n  (cname <TEXT>,  county name. Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].),\n  (enroll12 <INTEGER>,  enrollment (1st-12nd grade).),\n  (NumTstTakr <INTEGER>,  Number of Test Takers in this school.),\n  (AvgScrRead <INTEGER>,  average scores in Reading.),\n  (AvgScrMath <INTEGER>,  average scores in Math.),\n  (AvgScrWrite <INTEGER>,  average scores in writing.),\n  (NumGE1500 <INTEGER>,  Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500.)\n]\n# Table: schools\n[\n  (CDSCode <TEXT>,  CDSCode.),\n  (NCESDist <TEXT>,  This field represents the 7-digit National Center for Educational Statistics (NCES) school district identification number. The first 2 digits identify the state and the last 5 digits identify the school district. Combined, they make a unique 7-digit ID for each school district.. Value examples: [None, '0622710', '0634320', '0628050', '0634410', '0614550', '0633840'].),\n  (NCESSchool <TEXT>,  This field represents the 5-digit NCES school identification number. The NCESSchool combined with the NCESDist form a unique 12-digit ID for each school.. Value examples: [None, '12271', '13785', '13747', '12909', '12311', '12003'].),\n  (StatusType <TEXT>,  This field identifies the status of the district.. Value examples: ['Active', 'Closed', 'Merged', 'Pending'].),\n  (County <TEXT>,  County name. Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].),\n  (District <TEXT>,  District.),\n  (School <TEXT>,  School.),\n  (Street <TEXT>,  Street.),\n  (StreetAbr <TEXT>,  The abbreviated street address of the school, district, or administrative authority’s physical location..),\n  (City <TEXT>,  City. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].),\n  (Zip <TEXT>,  Zip. Value examples: [None, '91723', '95959', '94558', '92345', '90278', '90266'].),\n  (State <TEXT>,  State. Value examples: [None, 'CA'].),\n  (MailStreet <TEXT>,  MailStreet.),\n  (MailStrAbr <TEXT>,  mailing street address.),\n  (MailCity <TEXT>,  mailing city. Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Oakland', 'Fresno'].),\n  (MailZip <TEXT>,  mailing zip. Value examples: [None, '94606', '91710-4130', '92626-4300', '90266', '95336-0032', '92084'].),\n  (MailState <TEXT>,  mailing state. Value examples: [None, 'CA'].),\n  (Phone <TEXT>,  Phone. Value examples: [None, '(805) 581-0202', '(619) 243-5014', '(562) 698-8121', '(559) 683-4667', '(650) 329-2800', '(530) 625-5600'].),\n  (Ext <TEXT>,  The phone number extension of the school, district, or administrative authority.. Value examples: [None, '200', '201', '111', '352', '221', '203'].),\n  (Website <TEXT>,  The website address of the school, district, or administrative authority..),\n  (OpenDate <DATE>,  The date the school opened.. Value examples: [None, '1980-07-01'].),\n  (ClosedDate <DATE>,  The date the school closed.. Value examples: [None, '1989-06-30'].),\n  (Charter <INTEGER>,  This field identifies a charter school.. Value examples: [None, 0, 1].),\n  (CharterNum <TEXT>,  The charter school number,. Value examples: [None, '00D2', '0756', '00D4', '00D1', '1826', '1710'].),\n  (FundingType <TEXT>,  Indicates the charter school funding type. Value examples: [None, 'Directly funded', 'Locally funded', 'Not in CS funding model'].),\n  (DOC <TEXT>,  District Ownership Code. Value examples: ['54', '52', '00', '56', '98', '02'].),\n  (DOCType <TEXT>,  The District Ownership Code Type is the text description of the DOC category.. Value examples: ['Unified School District', 'Elementary School District', 'County Office of Education (COE)', 'High School District', 'Regional Occupation Center/Program (ROC/P)', 'State Board of Education'].),\n  (SOC <TEXT>,  The School Ownership Code is a numeric code used to identify the type of school.. Value examples: [None, '60', '66', '62', '68', '09', '69'].),\n  (SOCType <TEXT>,  The School Ownership Code Type is the text description of the type of school.. Value examples: [None, 'Elementary Schools (Public)', 'High Schools (Public)', 'Intermediate/Middle Schools (Public)', 'Continuation High Schools', 'Special Education Schools (Public)', 'District Community Day Schools'].),\n  (EdOpsCode <TEXT>,  The Education Option Code is a short text description of the type of education offered.. Value examples: [None, 'TRAD', 'CON', 'COMMDAY', 'ALTSOC', 'SPEC', 'COMM'].),\n  (EdOpsName <TEXT>,  Educational Option Name. Value examples: [None, 'Traditional', 'Continuation School', 'Community Day School', 'Alternative School of Choice', 'Special Education School', 'County Community School'].),\n  (EILCode <TEXT>,  The Educational Instruction Level Code is a short text description of the institution's type relative to the grade range served.. Value examples: [None, 'ELEM', 'HS', 'UG', 'INTMIDJR', 'ELEMHIGH', 'A'].),\n  (EILName <TEXT>,  The Educational Instruction Level Name is the long text description of the institution’s type relative to the grade range served.. Value examples: [None, 'Elementary', 'High School', 'Ungraded', 'Intermediate/Middle/Junior High', 'Elementary-High Combination', 'Adult'].),\n  (GSoffered <TEXT>,  The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.. Value examples: [None, 'K-5', '9-12', 'K-6', 'K-8', '6-8', 'K-12'].),\n  (GSserved <TEXT>,  It is the lowest grade and the highest grade of student enrollment as reported in the most recent certified CALPADS Fall 1 data collection. Only K–12 enrollment is reported through CALPADS. This field may differ from the grade span offered.. Value examples: [None, 'K-5', 'K-6', '9-12', 'K-8', '6-8', '7-8'].),\n  (Virtual <TEXT>,  This field identifies the type of virtual instruction offered by the school. Virtual instruction is instruction in which students and teachers are separated by time and/or location, and interaction occurs via computers and/or telecommunications technologies.. Value examples: [None, 'N', 'P', 'F'].),\n  (Magnet <INTEGER>,  This field identifies whether a school is a magnet school and/or provides a magnet program.. Value examples: [None, 0, 1].),\n  (Latitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the equator measured north to south..),\n  (Longitude <REAL>,  The angular distance (expressed in degrees) between the location of the school, district, or administrative authority and the prime meridian (Greenwich, England) measured from west to east..),\n  (AdmFName1 <TEXT>,  administrator's first name 1. Value examples: [None, 'David', 'Michael', 'John', 'Jennifer', 'Lisa', 'Robert'].),\n  (AdmLName1 <TEXT>,  administrator's last name 1.),\n  (AdmEmail1 <TEXT>,  administrator's email address 1.),\n  (AdmFName2 <TEXT>,  administrator's first name 2. Value examples: [None, 'Steve', 'Delphine', 'Tim', 'Michael', 'Lisa', 'Jeff'].),\n  (AdmLName2 <TEXT>,  administrator's last name 2. Value examples: [None, 'Sherman', 'Jones', 'Wilson', 'Petersen', 'Landry', 'Hambright'].),\n  (AdmEmail2 <TEXT>,  administrator's email address 2.),\n  (AdmFName3 <TEXT>,  administrator's first name 3. Value examples: [None, 'Mark', 'Eric', 'Vickie', 'Tracie', 'Shawn', 'Sarah'].),\n  (AdmLName3 <TEXT>,  administrator's last name 3. Value examples: [None, 'Zerpoli', 'Yount', 'Woodruff', 'Wood', 'Wolk', 'Spotts'].),\n  (AdmEmail3 <TEXT>,  administrator's email address 3.),\n  (LastUpdate <DATE>,  Last Update. Value examples: ['2015-06-18'].)\n]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Question】\nWhat is the highest eligible free rate for K-12 students in the schools in Alameda County?\n【Evidence】\nEligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you in selecting columns (You need to ignore matches that are not relevant to the question):\nfrpm.`County Name` = 'Alameda'; schools.`MailCity` = 'Alameda'; satscores.`cname` = 'Alameda'; schools.`County` = 'Alameda'; schools.`GSoffered` = 'K-12'; schools.`GSserved` = 'K-12'; schools.`City` = 'Alameda'\n【Answer】\n", "prompt_token": 5138, "response_token": 271, "cur_total_prompt_tokens": 5138, "cur_total_response_tokens": 271}
{"idx": 0, "db_id": "california_schools", "query": "What is the highest eligible free rate for K-12 students in the schools in Alameda County?", "evidence": "Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`", "difficulty": "simple", "ground_truth": "SELECT `Free Meal Count (K-12)` / `Enrollment (K-12)` FROM frpm WHERE `County Name` = 'Alameda' ORDER BY (CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)`) DESC LIMIT 1", "send_to": "Decomposer", "response": "\nTargets: List the highest eligible free rate for K-12 students in the schools\nConditions:\n1. in Alameda County --Condition_1\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the highest eligible free rate for K-12 students in the schools in Alameda County\n", "input_prompt": "[Instruction]\nGiven a 【query】, you need to understanding the intent of Query, and then deceompose it into Targets and Conditions. Then you need to combine Targets and Conditions into Subquerys step by step. \nFor the case where Conditions is NULL, consider Targets as the final Subquery directly. \nFor the case where Conditions are not NULL, combine Targets and the first Condition to get the first Subquery, then combine this Subquery and the next Condition into a new Subquery until all Conditions are used (which means the content of the last Subquery and the original Query is the same).\n\n[Requirements]\n-Try not to overlap Targets and Conditions.\n-Make sure the decomposed Target and Condition can cover all of the information in Query.\n-Don't change any information (specific value) in Query!\n-Mark each Subquery with ## in front of it.\n\nHere are some examples:\n==========\n\n【Query】\nShow the stadium name and the number of concerts in each stadium. Please also list the year the stadium was built. \n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the stadium name, the year the stadium built and the number of concerts in each stadium\nConditions: NULL\n\nSubqueries:\n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the stadium name, the year the stadium built and the number of concerts in each stadium\n==========\n\n【Query】\nWhat is the qualification rate for the H-11 products produced in 2023/11/2?\n【Evidence】\nqualification rate = `Numqualified(H-11)` / `production(H-11)`\n\n【Decomposition】\nTargets: List the qualification rate for the H-11 Products\nConditions:\n1. produced in 2023/11/2 --Condition_1\n\nSubqueries:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the qualification rate for the H-11 Products produced in 2023/11/2\n\n==========\n\n【Query】\nList the race of institutions in Alabama with number of students greater than the 90% of average number of students of all institutions?\n【Evidence】\nAlabama refers to state = 'Alabama'; number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n\n【Decomposition】\nTargets: List the race of institutions\nConditions: \n1. in Alabama --Condition_1\n2. number of students greater than the 90% of average number of students of all institutions --Condition_2\n\nSubqueries:\n1. Combine Targets and Condition_1 to get the first Subquery.\n##Subquery: List the race of institution in Alabama\n2. Conbine the first Subquery and Conditon_2 to get the seconed Subquery.\n##Subquery: List the race of institutions in Alabama with number of number of students greater than the 90% of average number of students of all institutions\n\n==========\n\n【Query】\nWhich president got a higher approval rating, Joseph Biden or Donald Trump?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\nConditions: \nNULL\n\nSubqueries: \n1. Since Conditions is NULL, the final Subquery is the Targets.\n##Subquery: List the name of the president who got a higher approval rating between Joseph Biden or Donald Trump\n\n==========\n\n【Query】\nFor movie id 1269, how many users, who was a paying subscriber and was eligible for trial when he rated the movie, gave the movie a rating score of less than or equal to 2?\n【Evidence】\nNULL\n\n【Decomposition】\nTargets: List the number of users\nConditions:\n1. was a paying subscriber --Condition_1\n2. was eligible for trial --Condition_2\n3. for movie id 1269, gave the movie a rating score of less than or equal to 2 --Condition3\n\nSubquerys:\n1. Combine Targets and Conditon_1 to get the first Subquery.\n##Subquery: List the number of users who was a paying subscriber\n2. Combine the first Subquery and Condition_2 to get the second Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial\n3. Combine the second Subquery and Condition_3 to get the third Subquery.\n##Subquery: List the number of users who was a paying subscriber and was eligible for trial and gave the movie whose id is 1269 a rating score of less than or equal to 2\n\n==========\n\nHere is a new query need to be decomposed:\n\n【Query】\nWhat is the highest eligible free rate for K-12 students in the schools in Alameda County?\n【Evidence】\nEligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n\n【Decomposition】\n", "prompt_token": 1061, "response_token": 70, "cur_total_prompt_tokens": 6199, "cur_total_response_tokens": 341}
{"idx": 0, "db_id": "california_schools", "query": "What is the highest eligible free rate for K-12 students in the schools in Alameda County?", "evidence": "Eligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`", "difficulty": "simple", "ground_truth": "SELECT `Free Meal Count (K-12)` / `Enrollment (K-12)` FROM frpm WHERE `County Name` = 'Alameda' ORDER BY (CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)`) DESC LIMIT 1", "send_to": "Generator", "response": "\nTo answer the question \"What is the highest eligible free rate for K-12 students in the schools in Alameda County?\", we need to follow these steps:\n\n1. **Identify the relevant columns**: \n   - The eligible free rate for K-12 is calculated using the formula: `Free Meal Count (K-12) / Enrollment (K-12)`.\n   - We need to select the maximum of this calculated value.\n   - We also need to filter the results to only include schools in Alameda County.\n\n2. **Identify the tables involved**: \n   - We will use the `frpm` table to filter by county and to access the `Free Meal Count (K-12)` and `Enrollment (K-12)` columns.\n   - We will also need to join with the `schools` table to ensure we are only considering schools in Alameda County.\n\n3. **Establish the connection between tables**: \n   - The `frpm` table is connected to the `schools` table through the `CDSCode` column.\n\n4. **Construct the SQL query**:\n   - We will calculate the eligible free rate and then find the maximum value for schools in Alameda County.\n\nHere is the SQL query that accomplishes this:\n\n```sql\nSELECT MAX(FRM.`Free Meal Count (K-12)` / FRM.`Enrollment (K-12)`) AS highest_eligible_free_rate\nFROM frpm AS FRM\nJOIN schools AS SCH ON FRM.`CDSCode` = SCH.`CDSCode`\nWHERE FRM.`County Name` = 'Alameda'\n```\n\n### Explanation of the SQL:\n- We are selecting the maximum eligible free rate calculated from the `Free Meal Count (K-12)` divided by `Enrollment (K-12)`.\n- We join the `frpm` table with the `schools` table on the `CDSCode` to ensure we are looking at the correct schools.\n- We filter the results to only include those from Alameda County.\n\nThis SQL query will return the highest eligible free rate for K-12 students in schools located in Alameda County.\n", "input_prompt": "Given a 【Database schema】 description, a knowledge 【Evidence】and a 【Question】, you need to use valid SQLite and understand the database and knowledge so that you can generate a good SQL for the 【Question】.\nWhen generating SQL, we should always consider constraints:\n【Constraints】\n- In `SELECT <column>`, just select needed columns in the 【Question】 without any unnecessary column or value\n- In `FROM <table>` or `JOIN <table>`, do not include unnecessary table\n- If use max or min func, `JOIN <table>` FIRST, THEN use `SELECT MAX(<column>)` or `SELECT MIN(<column>)`\n- If [Value examples] of <column> has 'None' or None, use `JOIN <table>` or `WHERE <column> is NOT NULL` is better\n- If use `ORDER BY <column> ASC|DESC`, add `GROUP BY <column>` before to select distinct values\n- If include more than one table, use `JOIN <table>`\n- If use `JOIN <table>`, the connected columns should be in the 【Foreign keys】\n- If evidence gives a formula for calculating a value, try to use that formula\n- If use `ORDER BY <column> ASC LIMIT <n>`, please use `ORDER BY <column> ASC NULLS LAST LIMIT <n>` to make sure the null values will not be selected\n\n==========\n\n【Database schema】\n# stadium: [Stadium_ID (INTEGER), Location (TEXT), Name (TEXT)]\n# concert: [concert_ID (INTEGER), concert_Name (TEXT), Stadium_ID (INTEGER)]\n【Primary keys】\nstadium.`Stadium_ID` | concert.`concert_ID`\n【Foreign keys】\nconcert.`Stadium_ID` = stadium.`Stadium_ID`\n【Detailed descriptions of tables and columns】\nstadium.`Stadium_ID`: The column 'Stadium_ID' in Table <stadium> has column descriptions of \"stadium id\". Value examples: [1, 2, 3, 4, 5, 6].\nstadium.`Name`:  The column 'Name' in Table <stadium> has column descriptions of \"name of stadium\". Value examples: [\"Stark's Park\", 'Somerset Park', 'Recreation Park', 'Hampden Park', 'Glebe Park', 'Gayfield Park'].\nstadium.`Location`: The column 'Location' in Table <stadium> has column descriptions of \"location of stadium\". Value examples: ['Stirling Albion', 'Raith Rovers', \"Queen's Park\", 'Peterhead', 'East Fife', 'Brechin City'].\nconcert.`concert_ID`: The column 'concert_ID' in Table <concert> has column descriptions of \"concert id\". Value examples: [1, 2, 3, 4, 5, 6].\nconcert.`concert_Name`: The column 'concert_Name' in Table <concert> has column descriptions of \"concert name\". Value examples: ['Week 1', 'Week 2', 'Super bootcamp', 'Home Visits', 'Auditions'].\nconcert.`Stadium_ID`: The column 'Stadium_ID' in Table <concert> has column descriptions of \"stadium id\". Value examples: [2, 9, 7, 10, 1].\n【Evidence】\nNULL\n【Question】\nShow the stadium name and the number of concerts in each stadium.\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: Show the stadium name and the number of concerts in each stadium.\nTargets for `SELECT`: the stadium name and the number of concerts\nhints from 【Evidence】:NULL\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the stadium name refers to stadium.`Name`, the number of concerts refers to COUNT(concert.`concert_ID`), each stadium refers to stadium.`Stadium_ID`\nConnection of tables: include tables <stadium> and <concert>, get connected keys from 【Foreign keys】: concert.`Stadium_ID` = stadium.`Stadium_ID`\nFinal SQL:\n```sql\nSELECT T1.`Name`, COUNT(T2.concert_ID) AS num_concerts\n  FROM stadium AS T1\n  JOIN concert AS T2\n  ON T1.`Stadium_ID` = T2.`Stadium_ID`\n  GROUP BY T1.`Stadium_ID`\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# country: [origin (INTEGER), country(TEXT)]\n# price: [ID (INTEGER), price (REAL)]\n# data: [ID (INTEGER), mpg (REAL), cylinders (INTEGER), displacement (TEXT), horsepower (REAL), weight (REAL), acceleration (REAL), model (TEXT), car_name (TEXT)]\n# production: [ID (INTEGER), model_year (INTEGER), country (INTEGER)]\n【Primary keys】\ncountry.`origin` | price.`ID` | data.`ID` | production.`ID`\n【Foreign keys】\ndata.`ID` = price.`ID`\nproduction.`ID` = price.`ID`\nproduction.`ID` = data.`ID`\nproduction.`country` = country.`origin`\n【Detailed descriptions of tables and columns】\ncountry.`origin`: The column 'origin' in Table <country> has column descriptions of \"the unique identifier for the origin country\". Value examples: [1, 2, 3].\ncountry.`country`: The column 'country' in Table <country> has column descriptions of \"the origin country of the car\". Value examples: ['USA', 'Japan', 'Europe'].\ndata.`horsepower`:  The column 'horsepower' in Table <data> has column descriptions of \"horse power associated with the car\".\ndata.`acceleration`:  The column 'acceleration' in Table <data> has column descriptions of \"acceleration of the car in miles per squared hour\".\nproduction.`country`: The column 'country' in Table <production> has column descriptions of \"country id to which the car belongs\".  Value examples: [1, 2, 3].\n【Evidence】\nthe fastest refers to max(horsepower); name of the car refers to car_name\n【Question】\nWhat is the fastest car made by Japan?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\ncountry.`country` = 'Japan'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: What is the fastest car made by Japan?\nTargets for `SELECT`: the name of the fastest car\nhints from 【Evidence】: the fastest refers to max(horsepower); name of the car refers to car_name\nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: car refers to data.`car_name`, the fastest refers to MAX(data.`horsepower`), Japan refers to country.`country`\nConnection of tables: includes tables <data> and <country>, since <data> and <country> are not connected directly, use <production> as a bridge, get connected keys from 【Foreign keys】: production.`ID` = data.`ID`, production.`country` = country.`origin`\nFinal SQL:\n```sql\nSELECT T1.`car_name` \n  FROM data AS T1 \n  INNER JOIN production AS T2 \n  ON T1.`ID` = T2.`ID` \n  INNER JOIN country AS T3 \n  ON T3.`origin` = T2.`country` \n  WHERE T3.`country` = 'Japan' \n  ORDER BY T1.`horsepower` DESC LIMIT 1\n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# institution_details: [unitid (INTEGER), chronname (TEXT), city (TEXT), state (TEXT), site (TEXT), student_count(TEXT)]\n# institution_grads: [unitid (INTEGER), gender (TEXT), race (TEXT), cohhort (TEXT)]\n【Primary keys】\ninstitution_details.`unitid` | institution_grads.`unitid`\n【Foreign keys】\ninstitution_grads.`unitid` = institution_details.`unitid`\n【Detailed descriptions of tables and columns】\ninstitution_details.`unitid`: The column 'unitid' in Table <institution_details> has column descriptions of \"Education Unit ID number\". \ninstitution_details.`chronname`: The column 'chronname' in Table <institution_details> has column descriptions of \"Institution name\". \ninstitution_details.`student_count`: The column 'student_count' in Table <institution_details> has column descriptions of \"Total number of undergraduates in 2010\". \n【Evidence】\nnumber of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\n【Question】\nList the chronname of institutions with number of students greater than the 90% of average number of students of all institutions?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nNo matched values.\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n【Question】: List the chroname of institutions with number of students greater than the 90% of average number of students of all institutions?\nTargets for `SELECT`: the chroname of institutions\nhints from 【Evidence】: number of students greater than the 90% of average = MULTIPLY(AVG(student_count), 90%) < student_count\nThere is a formula in 【Evidence】, so we can turn it into SQL format: institution_details.`student_count` > ( SELECT AVG(`student_count`) * 0.9 FROM institution_details ) \nFor the entities in the 【Question】, get corresponding columns from 【Database schema】 with hints: the chronname of institutions refers to institution_details.`chronname`, number of students refers to institution_details.`student_count`\nConnection of tables: include only one table <institution_details>, no connection\nFinal SQL:\n```sql\nSELECT DISTINCT `chroname`\n  FROM institution_details\n  WHERE `student_count` > ( \n    SELECT AVG(`student_count`) * 0.9 FROM institution_details\n  ) \n```\n\nQuestion Solved.\n\n==========\n\n【Database schema】\n# frpm: [CDSCode (TEXT), , Academic Year (TEXT), , County Code (TEXT), , District Code (INTEGER), , School Code (TEXT), , County Name (TEXT), , District Name (TEXT), , School Name (TEXT), , District Type (TEXT), , School Type (TEXT), , Educational Option Type (TEXT), , NSLP Provision Status (TEXT), , Charter School (Y/N) (INTEGER), , Charter School Number (TEXT), , Charter Funding Type (TEXT), , IRC (INTEGER), , Low Grade (TEXT), , High Grade (TEXT), , Enrollment (K-12) (REAL), , Free Meal Count (K-12) (REAL), , Percent (%) Eligible Free (K-12) (REAL), , FRPM Count (K-12) (REAL), , Percent (%) Eligible FRPM (K-12) (REAL), , Enrollment (Ages 5-17) (REAL), , Free Meal Count (Ages 5-17) (REAL), , Percent (%) Eligible Free (Ages 5-17) (REAL), , FRPM Count (Ages 5-17) (REAL), , Percent (%) Eligible FRPM (Ages 5-17) (REAL), , 2013-14 CALPADS Fall 1 Certification Status (INTEGER), ]\n# satscores: [cds (TEXT), , rtype (TEXT), , sname (TEXT), , dname (TEXT), , cname (TEXT), , enroll12 (INTEGER), , NumTstTakr (INTEGER), , AvgScrRead (INTEGER), , AvgScrMath (INTEGER), , AvgScrWrite (INTEGER), , NumGE1500 (INTEGER), ]\n# schools: [CDSCode (TEXT), , NCESDist (TEXT), , NCESSchool (TEXT), , StatusType (TEXT), , County (TEXT), , District (TEXT), , School (TEXT), , Street (TEXT), , StreetAbr (TEXT), , City (TEXT), , Zip (TEXT), , State (TEXT), , MailStreet (TEXT), , MailStrAbr (TEXT), , MailCity (TEXT), , MailZip (TEXT), , MailState (TEXT), , Phone (TEXT), , Ext (TEXT), , Website (TEXT), , OpenDate (DATE), , ClosedDate (DATE), , Charter (INTEGER), , CharterNum (TEXT), , FundingType (TEXT), , DOC (TEXT), , DOCType (TEXT), , SOC (TEXT), , SOCType (TEXT), , EdOpsCode (TEXT), , EdOpsName (TEXT), , EILCode (TEXT), , EILName (TEXT), , GSoffered (TEXT), , GSserved (TEXT), , Virtual (TEXT), , Magnet (INTEGER), , Latitude (REAL), , Longitude (REAL), , AdmFName1 (TEXT), , AdmLName1 (TEXT), , AdmEmail1 (TEXT), , AdmFName2 (TEXT), , AdmLName2 (TEXT), , AdmEmail2 (TEXT), , AdmFName3 (TEXT), , AdmLName3 (TEXT), , AdmEmail3 (TEXT), , LastUpdate (DATE), ]\n【Primary keys】\nfrpm.`CDSCode` | satscores.`cds` | schools.`CDSCode`\n【Foreign keys】\nfrpm.`CDSCode` = schools.`CDSCode`\nsatscores.`cds` = schools.`CDSCode`\n【Detailed descriptions of tables and columns】\nfrpm.`County Name`: The column 'County Name' in Table <frpm> has column descriptions of \"County Name\".  Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Riverside', 'Santa Clara'].\nfrpm.`Enrollment (K-12)`: The column 'Enrollment (K-12)' in Table <frpm> has column descriptions of \"Enrollment (K-12)\". \nfrpm.`Free Meal Count (K-12)`: The column 'Free Meal Count (K-12)' in Table <frpm> has column descriptions of \"Free Meal Count (K-12)\". \nsatscores.`cname`: The column 'cname' in Table <satscores> has column descriptions of \"county name\".  Value examples: ['Los Angeles', 'San Diego', 'San Bernardino', 'Riverside', 'Orange', 'Alameda'].\nsatscores.`enroll12`: The column 'enroll12' in Table <satscores> has column descriptions of \"enrollment (1st-12nd grade)\". \nschools.`CDSCode`: The column 'CDSCode' in Table <schools> has column descriptions of \"CDSCode\". \nschools.`County`: The column 'County' in Table <schools> has column descriptions of \"County name\".  Value examples: ['Los Angeles', 'San Diego', 'Orange', 'San Bernardino', 'Santa Clara', 'Alameda'].\nschools.`City`: The column 'City' in Table <schools> has column descriptions of \"City\".  Value examples: [None, 'Los Angeles', 'San Diego', 'San Jose', 'Sacramento', 'Fresno', 'Oakland'].\n\n【Evidence】\nEligible free rate for K-12 = `Free Meal Count (K-12)` / `Enrollment (K-12)`\n【Question】\nWhat is the highest eligible free rate for K-12 students in the schools in Alameda County?\n【Matched values】\nSince some of the specific values in Question and evidence match the data in the database, here are some matches retrieved from the database that may help you to generate SQL (Matched values may contain useless information and you should ignore matches that are not relevant to the question):\nfrpm.`County Name` = 'Alameda'; schools.`MailCity` = 'Alameda'; satscores.`cname` = 'Alameda'; schools.`County` = 'Alameda'; schools.`GSoffered` = 'K-12'; schools.`GSserved` = 'K-12'; schools.`City` = 'Alameda'\n\nConsider 【Constraints】, extract hints from 【Evidence】 if 【Evidence】 is related to the 【Question】, select columns from 【Database schema】 and then generate SQL for 【Question】, you need to think step by step:\n", "prompt_token": 3707, "response_token": 440, "cur_total_prompt_tokens": 9906, "cur_total_response_tokens": 781}
